/** 
 * jibo-sdk - Jibo's Robot plugin.
 * @version v1.2.6
 * Copyright (c) 2016, Jibo, Inc. All rights reserved.
 * All use of the Jibo SDK is subject to the Jibo SDK End User License Agreement (EULA) 
 * distributed herewith.  If you did not receive a copy of the EULA, you may view a
 * copy at https://developers.jibo.com/license.
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.jiboSdk=e()}}(function(){return function e(t,i,a){function o(r,s){if(!i[r]){if(!t[r]){var l="function"==typeof require&&require;if(!s&&l)return l(r,!0);if(n)return n(r,!0);var d=new Error("Cannot find module '"+r+"'");throw d.code="MODULE_NOT_FOUND",d}var u=i[r]={exports:{}};t[r][0].call(u.exports,function(e){var i=t[r][1][e];return o(i?i:e)},u,u.exports,e,t,i,a)}return i[r].exports}for(var n="function"==typeof require&&require,r=0;r<a.length;r++)o(a[r]);return o}({1:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function k(e,t,i){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,t);if(void 0===a){var o=Object.getPrototypeOf(e);return null===o?void 0:k(o,t,i)}if("value"in a)return a.value;var n=a.get;if(void 0!==n)return n.call(i)},l=e("path"),d=i(l),u=e("../atom-react/core/react-editor"),c=i(u),h=e("./views/editor"),f=i(h),p=e("./models/animation-model"),m=i(p),v=e("../common/tree-view-helper"),y=i(v),g=e("./audio/multi-audio-playback"),b=i(g),AnimationEditor=function(t){function AnimationEditor(e){a(this,AnimationEditor);var t=o(this,Object.getPrototypeOf(AnimationEditor).call(this,"AnimationEditor",e,!1)),i=t.getUiState();t.layout=i?i:[];var n=c["default"].getProjectRoot(e);return t.animationModel=new m["default"](t,n),t.animationModel.audio=new b["default"](t.animationModel,n),t}return n(AnimationEditor,t),r(AnimationEditor,[{key:"serialize",value:function(){return this.saveUiState(this.layout),s(Object.getPrototypeOf(AnimationEditor.prototype),"serialize",this).call(this)}},{key:"dispose",value:function(){this.saveUiState(this.layout),s(Object.getPrototypeOf(AnimationEditor.prototype),"dispose",this).call(this),this.animationModel.dispose(),this.animationModel.audio.dispose()}},{key:"onPaneActivated",value:function(){var e=this;setTimeout(function(){e.container.childNodes[0]&&e.container.childNodes[0].focus()},1)}},{key:"focus",value:function(){this.container.childNodes[0]&&this.container.childNodes[0].focus()}},{key:"onPaneDeactivated",value:function(){}},{key:"getReactClass",value:function(){return f["default"]}},{key:"saveFile",value:function(e){return AnimationEditor.isValidDirectory(e)?(this.animationModel.saveFile(e),this.animationModel.backup(),!0):(alert('You must save animations under the "animations" folder.'),!1)}},{key:"reload",value:function(){this.animationModel.reloadFile(this.uri)}},{key:"getSaveDialogOptions",value:function(){return{title:"Animation Save As",filters:AnimationEditor.getDialogFilter()}}}],[{key:"createNewFile",value:function(){var t=y["default"].getFolderPathWithDirectory(y["default"].getFolderPathOfSelection(),"animations");if(!t)return void alert("You must have a valid project loaded in order to create a new animation.");var i=atom.getCurrentWindow(),a=e("remote"),o=a.require("dialog");o.showSaveDialog(i,{title:"New Animation",defaultPath:t,filters:AnimationEditor.getDialogFilter()},function(e){e&&(AnimationEditor.isValidDirectory(e)?(m["default"].createNewFile(e),atom.workspace.open(e)):alert('You must save animations under the "animations" folder.'))})}},{key:"isValidDirectory",value:function(e){var t=d["default"].normalize("/animations/");return!!e.includes(t)}},{key:"getDialogFilter",value:function(){return[{name:"Animation",extensions:["keys"]}]}}]),AnimationEditor}(c["default"]);atom.deserializers.add({deserialize:c["default"].deserialize.bind(AnimationEditor),name:"AnimationEditor"}),exports["default"]=AnimationEditor},{"../atom-react/core/react-editor":53,"../common/tree-view-helper":103,"./audio/multi-audio-playback":4,"./models/animation-model":12,"./views/editor":14,path:void 0,remote:void 0}],2:[function(e,t,exports){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e){for(var t=2*s+e.length,i=r.createBuffer(e.numberOfChannels,t,e.sampleRate),a=0;a<e.numberOfChannels;a++){for(var o=e.getChannelData(a),n=new Float32Array(2*s+o.length),l=0,d=0;s>d;d++)n[l]=0,l++;for(var u=0;u<o.length;u++)n[l]=o[u],l++;for(var c=0;s>c;c++)n[l]=0,l++;i.copyToChannel(n,a)}return i}function o(e){for(var t=new Float32Array(e.length),i=r.createBuffer(1,e.length,e.sampleRate),a=-s,o=0;o<e.length;o++)t[o]=a,a++;return i.getChannelData(0).set(t),i}Object.defineProperty(exports,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),r=new AudioContext,s=44100,l=function(){function e(t){var a=arguments.length<=1||void 0===arguments[1]?!1:arguments[1];i(this,e),this.url=t,this.reverse=a,this.scriptNode=r.createScriptProcessor(256,1,1),this.scriptNode.onaudioprocess=this.processAudio.bind(this),this._currentTime=0,this.started=!1,this.callbacks=[]}return n(e,[{key:"getSamples",value:function(e){this.originalBufferArray?e(this.originalBufferArray,this.sampleRate):this.callbacks.push(e)}},{key:"processAudio",value:function(e){var t=e.inputBuffer.getChannelData(0),i=t[t.length-1]||0;this._currentTime=this.duration*i/this.numSamples,this.onCurrentTime&&this.onCurrentTime(this._currentTime)}},{key:"play",value:function(){this.started=!0,this.sourceNode.start(),this.counterNode.start()}},{key:"stop",value:function(){this.started&&(this.sourceNode.stop(),this.counterNode.stop()),this.started=!1}},{key:"createNodes",value:function(){this.sourceNode&&this.counterNode&&(this.sourceNode.disconnect(),this.counterNode.disconnect()),this.sourceNode=r.createBufferSource(),this.sourceNode.buffer=this.buffer,this.sourceNode.connect(r.destination),this.counterNode=r.createBufferSource(),this.counterNode.buffer=this.counterBuffer,this.counterNode.connect(this.scriptNode),this.scriptNode.connect(r.destination)}},{key:"dispose",value:function(){this.stop(),this.scriptNode.onaudioprocess=null,this.sourceNode&&this.counterNode&&(this.sourceNode.disconnect(),this.counterNode.disconnect()),this.scriptNode.disconnect(),this.scriptNode=null,this.sourceNode=null,this.counterNode=null,this.disposed=!0}},{key:"onLoad",value:function(e,t){var i=this;r.decodeAudioData(e.response,function(e){if(i.duration=e.length/e.sampleRate,i.sampleRate=e.sampleRate,i.numSamples=e.length,i.buffer=a(e),i.counterBuffer=o(i.buffer),i.originalBufferArray=e.getChannelData(0),i.reverse){i._currentTime=i.duration;for(var n=0;n<i.buffer.numberOfChannels;n++)Array.prototype.reverse.call(i.buffer.getChannelData(n))}i.disposed||(i.createNodes(),t())})}},{key:"load",value:function(e){var t=new XMLHttpRequest;t.open("GET",this.url,!0),t.responseType="arraybuffer",t.onload=this.onLoad.bind(this,t,e),t.send()}},{key:"bufferTime",get:function(){return s/this.buffer.sampleRate}},{key:"currentTime",get:function(){return this._currentTime},set:function(e){this.stop(),this.createNodes(),this.sourceNode.start(0,e+this.bufferTime),this.counterNode.start(0,e+this.bufferTime),this.started=!0,this._currentTime=e,this.playbackRate=1}},{key:"playbackRate",set:function(e){this.sourceNode.playbackRate.value=e,this.counterNode.playbackRate.value=e},get:function(){return this.sourceNode.playbackRate.value}}]),e}();exports["default"]=l},{}],3:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=e("./pid-audio-controller.js"),r=i(n),s=e("path"),l=i(s),d=function(){function e(t,i,o){a(this,e),this.model=t,this.handleDown=!1,this.wasInRange=!1,this.startTime=o.time/this.model.state.keyframes.framerate;var n=l["default"].resolve(i,"audio",o.value.AudioEvent.file);this.audio=new r["default"](n),this.audio.load(this.onLoaded.bind(this))}return o(e,[{key:"startUpdateLoop",value:function(){this.doUpdate=!0,this.lastUpdate=(new Date).getTime(),this.update()}},{key:"stopUpdateLoop",value:function(){this.doUpdate=!1}},{key:"onLoaded",value:function(){this.loaded=!0,this.startUpdateLoop()}},{key:"onToggleTimeScrub",value:function(e){this.handleDown=e,this.loaded&&(e&&this.isInRange?(this.wasInRange=!0,this.audio.playAtTime(this.target),this.audio.reset()):(this.wasInRange=!1,this.audio.stop()))}},{key:"onTogglePlay",value:function(e){this.isPlaying=e,this.loaded&&(this.lastTarget=this.target,e&&this.isInRange?(this.wasInRange=!0,this.audio.playAtTime(this.target)):e||(this.wasInRange=!1,this.audio.stop(this.target)))}},{key:"onTimeScrub",value:function(){if(this.loaded&&this.handleDown){var e=this.isInRange;e&&!this.wasInRange?(this.audio.playAtTime(this.target),this.audio.reset()):!e&&this.wasInRange&&this.audio.stop(),this.wasInRange=e}}},{key:"onDataChanged",value:function(){if(this.loaded&&this.isPlaying){var e=this.isInRange;e&&!this.wasInRange?this.audio.playAtTime(this.target):!e&&this.wasInRange?this.audio.stop():e&&this.lastTarget>this.target&&this.audio.playAtTime(this.target),this.lastTarget=this.target,this.wasInRange=e}}},{key:"update",value:function(){if(this.doUpdate){requestAnimationFrame(this.update.bind(this));var e=(new Date).getTime();if(e-this.lastUpdate<100)return;this.lastUpdate=e,this.handleDown&&this.isInRange&&this.wasInRange?this.audio.target=this.target:this.audio&&this.audio.reset()}}},{key:"dispose",value:function(){this.stopUpdateLoop(),this.audio.dispose(),this.audio=null,this.model=null}},{key:"target",get:function(){var e=this.model.uiState.currentKeyframe/this.model.state.keyframes.framerate;return e-this.startTime}},{key:"isInRange",get:function(){return this.target>-.5&&this.target<this.audio.duration+.5}}]),e}();exports["default"]=d},{"./pid-audio-controller.js":5,path:void 0}],4:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=e("./audio-playback"),r=i(n),s=function(){function e(t,i){a(this,e),this.model=t,this.root=i,this.playbacks=[],this.rebuild(),this.onPropsChangedBind=this.onPropsChanged.bind(this),this.onDataChangedBind=this.onDataChanged.bind(this),this.onTogglePlayBind=this.onTogglePlay.bind(this),this.onToggleTimeScrubBind=this.onToggleTimeScrub.bind(this),this.onTimeScrubBind=this.onTimeScrub.bind(this),this.model.on("onpropertieschanged",this.onPropsChangedBind),this.model.on("ondatachanged",this.onDataChangedBind),this.model.on("toggle-play",this.onTogglePlayBind),this.model.on("toggle-time-scrub",this.onToggleTimeScrubBind),this.model.on("drag-keyframe",this.onTimeScrubBind)}return o(e,[{key:"onToggleTimeScrub",value:function(e){this.playbacks.forEach(function(t){t.onToggleTimeScrub(e)})}},{key:"onTogglePlay",value:function(e){this.playbacks.forEach(function(t){t.onTogglePlay(e)})}},{key:"onTimeScrub",value:function(){this.playbacks.forEach(function(e){e.onTimeScrub()})}},{key:"onDataChanged",value:function(){this.playbacks.forEach(function(e){e.onDataChanged()})}},{key:"rebuild",value:function(){var e=this;this.playbacks.forEach(function(e){e.dispose()}),this.playbacks=[],this.map={};var t=this.model.getLayersOfType("Audio Event");t.forEach(function(t){t.visible&&!t.locked&&(e.map[t.id]=[],t.keyframes.forEach(function(i){if(i.value.AudioEvent.file&&i.value.AudioEvent.file.length>0){var a=new r["default"](e.model,e.root,i);e.playbacks.push(a),e.map[t.id][i.time]=a}}))})}},{key:"onPropsChanged",value:function(){this.rebuild()}},{key:"dispose",value:function(){this.playbacks.forEach(function(e){e.dispose()}),this.model.removeListener("ondatachanged",this.onDataChangedBind),this.model.removeListener("toggle-play",this.onTogglePlayBind),this.model.removeListener("toggle-time-scrub",this.onToggleTimeScrubBind),this.model.removeListener("time-scrub",this.onTimeScrubBind),this.playbacks=[]}}]),e}();exports["default"]=s},{"./audio-playback":3}],5:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=e("node-pid-controller"),r=i(n),s=e("./two-way-controller"),l=i(s),d=function(){function e(t){a(this,e),this.pid=new r["default"](5,1,.02,!1),this._target=0,this.pid.setTarget(this._target),this.audio=new l["default"](t),this.isPlaying=!1}return o(e,[{key:"load",value:function(e){var t=this;this.audio.load(function(){t.isPlaying=!0,e()})}},{key:"playAtTime",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?1:arguments[1];this.audio.playAtTime(e,t)}},{key:"stop",value:function(){this.isPlaying=!1,this.audio.stop()}},{key:"zeroPid",value:function(){this.pid.update(0)}},{key:"getSamples",value:function(e){return this.audio.getSamples(e)}},{key:"reset",value:function(){this.pid.reset()}},{key:"dispose",value:function(){this.audio.dispose(),this.audio=null,this.pid=null}},{key:"target",set:function(e){var t=this.audio.currentTime-e,i=this.pid.update(t);this.audio.playbackRate=i}},{key:"currentTime",set:function(e){this.audio.currentTime=e},get:function(){return this.audio.currentTime}},{key:"duration",get:function(){return this.audio.duration}}]),e}();exports["default"]=d},{"./two-way-controller":6,"node-pid-controller":void 0}],6:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=e("./audio-controller"),r=i(n),s=e("async"),l=i(s),d={FORWARD:0,REVERSE:1},u=function(){function e(t){a(this,e),this.forward=new r["default"](t),this.reverse=new r["default"](t,!0),this.direction=d.FORWARD,this.forward.onCurrentTime=this.onCurrentTime.bind(this),this._currentTime=0}return o(e,[{key:"load",value:function(e){var t=this;l["default"].parallel([function(e){t.forward.load(e)},function(e){t.reverse.load(e)}],e)}},{key:"stop",value:function(){var e=arguments.length<=0||void 0===arguments[0]?0:arguments[0];this.currentTime=e,this.forward.stop(),this.reverse.stop()}},{key:"onCurrentTime",value:function(e){this.direction===d.REVERSE?this._currentTime=this.forward.duration-e:this._currentTime=e}},{key:"playAtTime",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?1:arguments[1];this._currentTime=e||0,this._playbackRate=t,this.direction===d.REVERSE&&(this.direction=d.FORWARD,this.forward.onCurrentTime=this.onCurrentTime.bind(this),this.reverse.onCurrentTime=null,this.reverse.stop()),this.forward.currentTime=this._currentTime,this.forward.playbackRate=this._playbackRate}},{key:"dispose",value:function(){this.forward.onCurrentTime=null,this.forward.dispose(),this.reverse.onCurrentTime=null,this.reverse.dispose(),this.forward=null,this.reverse=null}},{key:"duration",get:function(){return this.forward.duration}},{key:"currentTime",get:function(){return this._currentTime},set:function(e){this._currentTime=e,this.reverse.currentTime=this.forward.duration-e,this.forward.currentTime=e,this.direction===d.REVERSE?this.forward.stop():this.reverse.stop()}},{key:"playbackRate",set:function(e){this._playbackRate=e,e>=0&&this.direction===d.REVERSE?(this.direction=d.FORWARD,this.forward.currentTime=this._currentTime,this.forward.onCurrentTime=this.onCurrentTime.bind(this),this.reverse.onCurrentTime=null,this.reverse.stop()):0>e&&this.direction===d.FORWARD&&(this.direction=d.REVERSE,this.reverse.currentTime=this.forward.duration-this._currentTime,this.reverse.onCurrentTime=this.onCurrentTime.bind(this),this.forward.onCurrentTime=null,this.forward.stop()),this.direction===d.FORWARD?this.forward.playbackRate=e:this.direction===d.REVERSE&&(this.reverse.playbackRate=-e)},get:function(){return this._playbackRate}}]),e}();exports["default"]=u},{"./audio-controller":2,async:void 0}],7:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=e("animation-utilities"),r=e("atom"),s=e("./dof-controller"),l=i(s),d=e("../views/three-debug.js"),u=i(d),c=new n.JiboConfig,h=function(){function e(t){a(this,e),this.animationModel=t,this.disposable=new r.CompositeDisposable}return o(e,[{key:"dispose",value:function(){this.disposable.dispose()}},{key:"onMouseDown",value:function(e){this.container.focus(),this.onMouseChange(e)}},{key:"onMouseChange",value:function(){this.renderer&&(this.animationModel.keyframeSelection.isMultiSelect()||!this.animationModel.isLayerOfTypeSelected("Body")?(this.container.childNodes[1].pointerEvents="none",this.container.childNodes[1].style.cursor="not-allowed"):(this.container.childNodes[1].pointerEvents="",this.container.childNodes[1].style.cursor="pointer"))}},{key:"_getThreeColorFromConfig",value:function(e){var t=atom.config.get("jibo-sdk."+e);return new n.THREE.Color(t.red/255,t.green/255,t.blue/255)}},{key:"_updateBackgroundColor",value:function(){var e=this._getThreeColorFromConfig("AnimationEditorBackgroundColor");this.renderer.setBackgroundColor(e.r,e.g,e.b,1)}},{key:"_updateGridColor",value:function(){this.renderer.setGrid(.05,6,this._getThreeColorFromConfig("AnimationEditorGridColor"))}},{key:"getPaddedValueString",value:function(e){var t=10>e?"0":"";return t+e}},{key:"setCamera",value:function(e){var t=this,i=.35,a=.5,o=new n.THREE.Vector3(0,0,.15);this.renderer.scene._controls.reset();var r={front:function(){t.renderer.setCamera(new n.THREE.Vector3(a,0,i),o,45)},back:function(){t.renderer.setCamera(new n.THREE.Vector3(-a,0,i),o,45)},left:function(){t.renderer.setCamera(new n.THREE.Vector3(0,a,i),o,45)},right:function(){t.renderer.setCamera(new n.THREE.Vector3(0,-a,i),o,45)}};r[e]()}},{key:"initialize",value:function(e,t){var i=this;this.container=e,e.addEventListener("mousemove",this.onMouseChange.bind(this),!0),e.addEventListener("mousedown",this.onMouseDown.bind(this),!0),e.addEventListener("mouseup",this.onMouseChange.bind(this),!0),n.RobotInfo.createInfo(c,function(a){n.visualize.createRobotRenderer(a,e,n.visualize.DisplayType.BODY,function(o){if(o){i.renderer=o,i.robotInfo=a,i.dofValues=a.getDefaultDOFValues(),i.debug=new u["default"](i.renderer.scene.getScene()),o.setCamera(new n.THREE.Vector3(.5,0,.35),new n.THREE.Vector3(0,0,.15),45),i.dofController=l["default"].createWithRenderer(i.renderer,e,l["default"].ControllerType.BODY,a),i.dofController.setDOFValues(i.dofValues),i.listenForChanges();var r=o.scene.getScene(),s=new n.THREE.AxisHelper(1);s.position.z+=.01,r.add(s),i._updateBackgroundColor(),i.disposable.add(atom.config.observe("jibo-sdk.AnimationEditorBackgroundColor",function(){i._updateBackgroundColor()})),i._updateGridColor(),i.disposable.add(atom.config.observe("jibo-sdk.AnimationEditorGridColor",function(){i._updateGridColor()})),t(null)}})})}},{key:"listenForChanges",value:function(){var e=this,t=this;this.dofController.on(l["default"].EventType.DOF_VALUES_CHANGED,function(i,a){var o=e.animationModel.getLayersOfType("Body");0!==o.length&&"Body"===e.animationModel.getSelectedLayer().type&&(a.topSection_r&&t.animationModel.updateSelectedLayerPropertiesRelative({Head:a.topSection_r/Math.PI*180}),a.middleSection_r&&t.animationModel.updateSelectedLayerPropertiesRelative({Torso:a.middleSection_r/Math.PI*180}),a.bottomSection_r&&t.animationModel.updateSelectedLayerPropertiesRelative({Pelvis:a.bottomSection_r/Math.PI*180}))}),this.dofController.on(l["default"].EventType.DOF_SELECTION_CHANGED,function(e,t){1!==t.length}),this.dofController.on(l["default"].EventType.DOF_MANIPULATION_ENDED,function(){t.animationModel.addRedoUndoEntry()})}},{key:"updateDofValues",value:function(e){this.dofValues=e,this.dofController&&this.dofController.setDOFValues(this.dofValues)}},{key:"update",value:function(){this.renderer&&this.renderer.display(this.dofValues)}}]),e}();exports["default"]=h},{"../views/three-debug.js":39,"./dof-controller":8,"animation-utilities":void 0,atom:void 0}],8:[function(e,t,exports){"use strict";var i=e("animation-utilities"),a={DOF_VALUES_CHANGED:"DOF_VALUES_CHANGED",DOF_SELECTION_CHANGED:"DOF_SELECTION_CHANGED",DOF_MANIPULATION_ENDED:"DOF_MANIPULATION_ENDED"},o={BODY:"BODY"},n=function(e,t,i,a){if(i!==o.BODY)throw new Error("DOFController: unsupported controller type: "+i);return new d(e,t,i,a)},r="topSection_r",s="middleSection_r",l="bottomSection_r",d=function(e,t,o,n){this.renderer=e,this.scene=e.scene,this.controllerType=o,this.robotInfo=n,this.renderer.setGrid(.1,4,new i.THREE.Color(.2,.2,.2)),this.dofValues={};for(var d=n.getDOFNames(),u=0;u<d.length;u++)this.dofValues[d[u]]=0;this.selectedDOFs=[],this.eventListeners={},this.eventListeners[a.DOF_VALUES_CHANGED]=[],this.eventListeners[a.DOF_SELECTION_CHANGED]=[],this.eventListeners[a.DOF_MANIPULATION_ENDED]=[],this.lockingMode=!1;var c=this,f=!1,p=null,m=!1,v=!1,y=!1,g=function(t){if(3===t.which)return!1;var i=!t.altKey&&!t.metaKey&&!t.ctrlKey;return i?e.scene._controls.enabled=!1:e.scene._controls.enabled=!0,i},b=function(e,t){e.preventDefault(),e.stopPropagation();var i;if(t){if(null!==c.getSelectedDOFs()&&c.getSelectedDOFs().length>0){i=c.getSelectedDOFs()[0],v=!0;var o=.5*e.movementX*Math.PI/180,n=c.dofValues[i]+o,d={};d[i]=n,e.shiftKey&&(i===s&&(d[r]=c.dofValues[r]-o),i===l&&(d[s]=c.dofValues[s]-o)),c.setDOFValues(d),c._fireEvent(a.DOF_VALUES_CHANGED,d)}}else i=h(e,p,c.scene.getScene(),c.scene.getCamera()),i&&(c.setSelectedDOFs([i]),c._fireEvent(a.DOF_SELECTION_CHANGED,c.getSelectedDOFs()))},k=function(e){return y?void(m&&g(e)&&b(e,!0)):(e.preventDefault(),void e.stopPropagation())},M=function(){y&&(y=!1,m&&(v&&(v=!1,c._fireEvent(a.DOF_MANIPULATION_ENDED)),null!==c.getSelectedDOFs()&&c.getSelectedDOFs().length>0&&(c.setSelectedDOFs([]),c._fireEvent(a.DOF_SELECTION_CHANGED,c.getSelectedDOFs()))))},E=function(e){y=!0,m&&g(e)&&b(e,!1)};this.detachFromContainer=function(e){(void 0===e||e===!0)&&c.renderer.detachFromContainer(),null!==p&&(p.removeEventListener("mousemove",k,f),p.removeEventListener("mouseup",M,f),p.removeEventListener("mouseleave",M,f),p.removeEventListener("mousedown",E,f),v&&(v=!1,c._fireEvent(a.DOF_MANIPULATION_ENDED)),null!==c.getSelectedDOFs()&&c.getSelectedDOFs().length>0&&(c.setSelectedDOFs([]),c._fireEvent(a.DOF_SELECTION_CHANGED,c.getSelectedDOFs())),m=!1,p=null)},this.attachToContainer=function(e,t){c.detachFromContainer(t),p=void 0!==e?e:null,null!==p&&((void 0===t||t===!0)&&c.renderer.attachToContainer(p),p.addEventListener("mousemove",k,f),p.addEventListener("mouseup",M,f),p.addEventListener("mouseleave",M,f),p.addEventListener("mousedown",E,f),m=!0)},this.dispose=function(e){c.detachFromContainer(!1),null!==c.renderer&&((void 0===e||e===!0)&&c.renderer.dispose(),c.renderer=null),c.scene=null,c.robotInfo=null,c.eventListeners=null},this.attachToContainer(t,!1)};d.prototype.getDOFValues=function(){return this.dofValues},d.prototype.setDOFValues=function(e){for(var t=Object.keys(e),i=0;i<t.length;i++)this.dofValues[t[i]]=e[t[i]];this.renderer.display(this.dofValues)},d.prototype.getSelectedDOFs=function(){return this.selectedDOFs},d.prototype.setSelectedDOFs=function(e){this.selectedDOFs=e},d.prototype.on=function(e,t){var i=this.eventListeners[e];if(void 0===i)throw new Error("DOFController: unsupported event type: "+e);i.push(t)},d.prototype.setLockingMode=function(e){this.lockingMode=e},d.prototype._fireEvent=function(e){var t=this.eventListeners[e];if(void 0===t)throw new Error("DOFController: unsupported event type: "+e);for(var i=[this],a=1;a<arguments.length;a++)i.push(arguments[a]);for(var o=0;o<t.length;o++)t[o].apply(null,i)};var u={};u[r]=["headMeshMesh","maskMeshMesh","screenMeshBillboardMesh"],u[s]=["torsoMeshMesh"],u[l]=["pelvisMeshMesh","lightringMeshMesh"];var c={};!function(){for(var e=Object.keys(u),t=0;t<e.length;t++)for(var i=u[e[t]],a=0;a<i.length;a++)c[i[a]]=e[t]}();var h=function(e,t,a,o){var n=i.MouseCoordinateWrangler.getLocalCoordinatesNDCCentered(e,t),r=new i.THREE.Raycaster;r.linePrecision=.01,r.setFromCamera(n,o);var s=r.intersectObject(a,!0);if(s.length>0){var l=c[s[0].object.name];return l||null}return null};t.exports.EventType=a,t.exports.ControllerType=o,t.exports.createWithRenderer=n},{"animation-utilities":void 0}],9:[function(e,t,exports){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),o=e("animation-utilities"),n=function(){function e(t,a,o,n,r){i(this,e),this.renderer=t,this.element=a,this.animationModel=n,this.spheres=[],this.scene=t.scene.getScene();var s=r?"overlay_textureSubRootBn":"eyeSubRootBn";this.rootBone=this.scene.getObjectByName(s),this.onMouseDownBind=this.onMouseDown.bind(this),this.onMouseUpBind=this.onMouseUp.bind(this),this.onRotateBind=this.onRotate.bind(this),this.element.addEventListener("mousedown",this.onMouseDownBind),this.element.addEventListener("mouseup",this.onMouseUpBind)}return a(e,[{key:"setProps",value:function(e){this.lastAngle=e.Rotate}},{key:"getIntersectionAtHeight",value:function(e,t,i){var a=new o.THREE.Vector3;a.set(e/this.element.clientWidth*2-1,2*-(t/this.element.clientHeight)+1,.5);var n=this.renderer.scene.getCamera();return a.unproject(n),a.z=i,a}},{key:"onRotate",value:function(){this.startedManipulation=!0;var e=this.getMouseAngle(),t=e-this.tempInitialAngle,i=(this.tempInitialRotation+t)/Math.PI*180-this.lastAngle;i>120||-120>i?(this.lastAngle=(this.tempInitialRotation+t)/Math.PI*180-i,this.tempInitialRotation=this.lastAngle*Math.PI/180,this.tempInitialAngle=this.getMouseAngle()):this.lastAngle=(this.tempInitialRotation+t)/Math.PI*180,this.animationModel.updateSelectedLayerPropertiesRelative({Rotate:this.lastAngle})}},{key:"onMouseUp",value:function(){this.element.removeEventListener("mousemove",this.onMouseMoveBind),this.element.removeEventListener("mousemove",this.onRotateBind),this.sphere=void 0,this.startedManipulation&&(this.startedManipulation=!1,this.animationModel.addRedoUndoEntry())}},{key:"getMouseAngle",value:function(){var e=this.getIntersectionAtHeight(event.offsetX,event.offsetY,0),t=new o.THREE.Vector2(1,0),i=new o.THREE.Vector2(this.rootBone.position.x,this.rootBone.position.y),a=new o.THREE.Vector2(e.x,e.y),n=a.sub(i).normalize();return n.y<0?2*Math.PI-Math.acos(t.dot(n)):Math.acos(t.dot(n))}},{key:"onMouseDown",value:function(){this.initialMouseAngle=this.getMouseAngle(),this.initialRotation=this.rootBone.rotation.z,this.tempInitialAngle=this.initialMouseAngle,this.tempInitialRotation=this.initialRotation,this.element.addEventListener("mousemove",this.onRotateBind)}},{key:"dispose",value:function(){this.element.removeEventListener("mousedown",this.onMouseDownBind),this.element.removeEventListener("mouseup",this.onMouseUpBind),this.disposed=!0}},{key:"scaleSpheres",value:function(){}}]),e}();exports["default"]=n},{"animation-utilities":void 0}],10:[function(e,t,exports){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),o=e("animation-utilities"),n=e("jibo-keyframes"),r={LEFT:0,RIGHT:1,TOP:2,BOTTOM:3},s=function(){function e(t,a,n,r,s){var l=this;i(this,e),this.animationModel=r,this.renderer=t,this.element=a,this.robotInfo=n,this.spheres=[],this.scene=t.scene.getScene();var d=s?"overlay_textureSubRootBn":"eyeSubRootBn";this.rootBone=this.scene.getObjectByName(d),this.prefix=s?"overlay_vertexJoint":"vertexJoint",this.defaultVertexPositions=o.EyeKinematicsHelper.verticesForDOFValues(n.getDefaultDOFValues(),n),Object.keys(this.defaultVertexPositions).forEach(function(e){if(0===e.indexOf(l.prefix)&&e!==l.prefix+"5"){var t=l.defaultVertexPositions[e];l.createSphere(t,e)}}),this.scaleSpheres(),this.centerPosition=this.rootBone.position.clone(),this.defaultDistance=this.defaultVertexPositions[this.prefix+"6"].x-this.defaultVertexPositions[this.prefix+"5"].x,this.onMouseDownBind=this.onMouseDown.bind(this),this.onMouseUpBind=this.onMouseUp.bind(this),this.onScaleBind=this.onScale.bind(this),this.onTranslateBind=this.onTranslate.bind(this),this.element.addEventListener("mousedown",this.onMouseDownBind),this.element.addEventListener("mouseup",this.onMouseUpBind),this.startedManipulation=!1,this.indexToPosition={1:this.topLeft.bind(this),2:this.top.bind(this),3:this.topRight.bind(this),4:this.left.bind(this),6:this.right.bind(this),7:this.bottomLeft.bind(this),8:this.bottom.bind(this),9:this.bottomRight.bind(this)}}return a(e,[{key:"setIntersectedObject",value:function(e){var t=this.renderer.scene.getScene(),i=this.renderer.scene.getCamera(),a=o.MouseCoordinateWrangler.getLocalCoordinatesNDCCentered(e,this.element),n=new o.THREE.Raycaster;n.setFromCamera(a,i);for(var r=n.intersectObject(t,!0),s=0;s<r.length;s++){if(this.defaultVertexPositions[r[s].object.name])return this.sphere=r[s].object,void(this.mesh=void 0);this.mesh=r[s].object}}},{key:"getIntersectionAtHeight",value:function(e,t,i){
var a=new o.THREE.Vector3;a.set(e/this.element.clientWidth*2-1,2*-(t/this.element.clientHeight)+1,.5);var n=this.renderer.scene.getCamera();return a.unproject(n),a.z=i,a}},{key:"scaleSpheres",value:function(){var e=this;this.spheres.forEach(function(t){t.scale.x=1/e.rootBone.scale.x,t.scale.y=1/e.rootBone.scale.y})}},{key:"_getDelta",value:function(e,t){var i=this.rootBone.worldToLocal(e.clone());t===r.TOP||t===r.BOTTOM?i.x=0:i.y=0,e=this.rootBone.localToWorld(i);var a=t===r.TOP||t===r.RIGHT,o=a?e.sub(this.centerPosition).length():this.centerPosition.clone().sub(e).length();return o}},{key:"right",value:function(e){var t=this._getDelta(e,r.RIGHT);this.animationModel.updateSelectedLayerPropertiesRelative({Scale:{x:t/this.defaultDistance,y:this.rootBone.scale.y}})}},{key:"left",value:function(e){var t=this._getDelta(e,r.LEFT);this.animationModel.updateSelectedLayerPropertiesRelative({Scale:{x:t/this.defaultDistance,y:this.rootBone.scale.y}})}},{key:"top",value:function(e){var t=this._getDelta(e,r.TOP);this.animationModel.updateSelectedLayerPropertiesRelative({Scale:{x:this.rootBone.scale.x,y:t/this.defaultDistance}})}},{key:"bottom",value:function(e){var t=this._getDelta(e,r.BOTTOM);this.animationModel.updateSelectedLayerPropertiesRelative({Scale:{x:this.rootBone.scale.x,y:t/this.defaultDistance}})}},{key:"_uniformScale",value:function(e,t){var i=e/this.defaultDistance,a=t/this.defaultDistance;e>t?a=i/this.rootBone.scale.x*this.rootBone.scale.y:i=a/this.rootBone.scale.y*this.rootBone.scale.x,this.animationModel.updateSelectedLayerPropertiesRelative({Scale:{x:i,y:a}})}},{key:"topLeft",value:function(e,t){if(t){var i=this._getDelta(e,r.LEFT),a=this._getDelta(e,r.TOP);this._uniformScale(i,a)}else this.top(e),this.left(e)}},{key:"topRight",value:function(e,t){if(t){var i=this._getDelta(e,r.RIGHT),a=this._getDelta(e,r.TOP);this._uniformScale(i,a)}else this.top(e),this.right(e)}},{key:"bottomLeft",value:function(e,t){if(t){var i=this._getDelta(e,r.LEFT),a=this._getDelta(e,r.BOTTOM);this._uniformScale(i,a)}else this.bottom(e),this.left(e)}},{key:"bottomRight",value:function(e,t){if(t){var i=this._getDelta(e,r.RIGHT),a=this._getDelta(e,r.BOTTOM);this._uniformScale(i,a)}else this.bottom(e),this.right(e)}},{key:"onTranslate",value:function(){var e=this.getIntersectionAtHeight(event.offsetX,event.offsetY,0),t=e.sub(this.initMousePosition);this.startedManipulation=!0,this.animationModel.updateSelectedLayerPropertiesRelative({Translate:{x:n.conversion.toPixelsX(this.initRootBonePosition.x+t.x),y:n.conversion.toPixelsY(this.initRootBonePosition.y+t.y)}})}},{key:"onScale",value:function(e){var t=this.getIntersectionAtHeight(e.offsetX,e.offsetY,0),i=this.sphere.name[this.sphere.name.length-1],a=this.indexToPosition[i];this.sphere&&a&&(this.startedManipulation=!0,a(t,e.shiftKey),this.scaleSpheres())}},{key:"onMouseUp",value:function(){this.element.removeEventListener("mousemove",this.onScaleBind),this.element.removeEventListener("mousemove",this.onTranslateBind),this.sphere=void 0,this.mesh=void 0,this.startedManipulation&&(this.startedManipulation=!1,this.animationModel.addRedoUndoEntry())}},{key:"setProps",value:function(){this.centerPosition.x=this.rootBone.position.x,this.centerPosition.y=this.rootBone.position.y,this.scaleSpheres()}},{key:"onMouseDown",value:function(e){this.setIntersectedObject(e),this.sphere?(this.initSpherePosition=this.sphere.position.clone(),this.initMousePosition=this.getIntersectionAtHeight(e.offsetX,e.offsetY,0),this.element.addEventListener("mousemove",this.onScaleBind)):this.mesh&&(this.initMousePosition=this.getIntersectionAtHeight(e.offsetX,e.offsetY,0),this.initRootBonePosition=this.rootBone.position.clone(),this.element.addEventListener("mousemove",this.onTranslateBind))}},{key:"createSphere",value:function(e,t){var i=new o.THREE.SphereGeometry(.0018,32,32),a=new o.THREE.MeshLambertMaterial({color:0,emissive:3355545}),n=new o.THREE.Mesh(i,a);n.position.x=e.x,n.position.y=e.y,n.position.z=e.z,n.name=t,this.rootBone.add(n),this.spheres.push(n)}},{key:"dispose",value:function(){this.element.removeEventListener("mousedown",this.onMouseDownBind),this.element.removeEventListener("mouseup",this.onMouseUpBind),this.element.removeEventListener("mousemove",this.onScaleBind),this.element.removeEventListener("mousemove",this.onTranslateBind),this.spheres.forEach(function(e){e.parent&&e.parent.remove(e)}),this.disposed=!0}}]),e}();exports["default"]=s},{"animation-utilities":void 0,"jibo-keyframes":void 0}],11:[function(e,t,exports){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),o=e("animation-utilities"),n=e("jibo-keyframes"),r=function(){function e(t,a,o,n,r){i(this,e),this.renderer=t,this.element=a,this.robotInfo=o,this.animationModel=n,this.prefix=r?"overlay_vertexJoint":"vertexJoint",this.vertices={},this.vertexToPropMap={},this.spheres={};var s=t.scene.getScene(),l=r?"overlay_textureSubRootBn":"eyeSubRootBn";this.rootBone=s.getObjectByName(l);for(var d=1;10>d;d++){var u=""+this.prefix+d,c=s.getObjectByName(u);this.vertices[u]=c,this.createSphere(c),this.vertexToPropMap[u]="Vertex "+d}this.onMouseDownBind=this.onMouseDown.bind(this),this.onMouseUpBind=this.onMouseUp.bind(this),this.onMouseMoveBind=this.onMouseMove.bind(this),this.element.addEventListener("mousedown",this.onMouseDownBind),this.element.addEventListener("mouseup",this.onMouseUpBind)}return a(e,[{key:"scaleSpheres",value:function(){var e=this;Object.keys(this.spheres).forEach(function(t){var i=e.spheres[t];i.scale.x=1/e.rootBone.scale.x,i.scale.y=1/e.rootBone.scale.y})}},{key:"createSphere",value:function(e){var t=new o.THREE.SphereGeometry(.0018,32,32),i=new o.THREE.MeshLambertMaterial({color:0,emissive:3355545}),a=new o.THREE.Mesh(t,i);a.position.x=e.position.x,a.position.y=e.position.y,a.position.z=e.position.z,this.scaleSpheres(),a.name=e.name,this.vertices[e.name]&&(this.spheres[e.name]=a,this.vertices[e.name]=e,e.parent.add(a))}},{key:"setIntersectedObject",value:function(e){var t=this.renderer.scene.getScene(),i=this.renderer.scene.getCamera(),a=o.MouseCoordinateWrangler.getLocalCoordinatesNDCCentered(e,this.element),n=new o.THREE.Raycaster;n.setFromCamera(a,i);for(var r=n.intersectObject(t,!0),s=0;s<r.length;s++)if(this.vertices[r[s].object.name])return this.sphere=r[s].object,void(this.vertex=this.vertices[r[s].object.name])}},{key:"getIntersectionAtHeight",value:function(e,t,i){var a=new o.THREE.Vector3;a.set(e/this.element.clientWidth*2-1,2*-(t/this.element.clientHeight)+1,.5);var n=this.renderer.scene.getCamera();return a.unproject(n),a.z=i,a}},{key:"onMouseMove",value:function(e){this.startedManipulation=!0;var t=this.getIntersectionAtHeight(e.offsetX,e.offsetY,0);t=this.rootBone.worldToLocal(t.clone());var i=t.sub(this.initMousePosition),a=this.vertexToPropMap[this.vertex.name],o={};o[a]={x:n.conversion.toPixelsX(this.initSpherePosition.x+i.x),y:n.conversion.toPixelsY(this.initSpherePosition.y+i.y)},this.animationModel.updateSelectedLayerPropertiesRelative(o)}},{key:"setProps",value:function(e){for(var t=1;10>t;t++){var i=e["Vertex "+t],a=""+this.prefix+t,o=this.spheres[a];o.position.x=n.conversion.toMetersX(i.x),o.position.y=n.conversion.toMetersY(i.y)}this.scaleSpheres()}},{key:"onMouseUp",value:function(){this.sphere=void 0,this.vertex=void 0,this.element.removeEventListener("mousemove",this.onMouseMoveBind),this.startedManipulation&&(this.startedManipulation=!1,this.animationModel.addRedoUndoEntry())}},{key:"onMouseDown",value:function(e){this.setIntersectedObject(e),this.vertex&&this.sphere&&(this.initSpherePosition=this.sphere.position.clone(),this.initMousePosition=this.rootBone.worldToLocal(this.getIntersectionAtHeight(e.offsetX,e.offsetY,0)),this.element.addEventListener("mousemove",this.onMouseMoveBind))}},{key:"dispose",value:function(){var e=this;this.element.removeEventListener("mousedown",this.onMouseDownBind),this.element.removeEventListener("mouseup",this.onMouseUpBind),Object.keys(this.spheres).forEach(function(t){var i=e.spheres[t];i.parent&&i.parent.remove(i)}),this.disposed=!0}}]),e}();exports["default"]=r},{"animation-utilities":void 0,"jibo-keyframes":void 0}],12:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e,t){var i=[t,0];return T.apply(i,L.call(arguments,2)),R.apply(e,i),e}Object.defineProperty(exports,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),l=e("events"),d=e("jibo-keyframes"),u=i(d),c=e("jibo-keyframes/lib/jibo-keyframe-info"),h=i(c),f=e("lodash"),p=i(f),m=e("../../common/undo-redo"),v=i(m),y=e("../../common/clipboard"),g=i(y),b=e("animation-utilities"),k=e("./keyframe-selection"),M=i(k),E=e("fs"),w=i(E),S=e("path"),D=i(S),C=e("crypto"),N=i(C),_="win32"===process.platform?process.env.HOMEPATH:process.env.HOME,O=D["default"].resolve(_,".jibo");w["default"].existsSync(O)||w["default"].mkdirSync(O);var x=D["default"].resolve(O,"temp");w["default"].existsSync(x)||w["default"].mkdirSync(x);var P=function(e){function t(e,i){a(this,t);var n=o(this,Object.getPrototypeOf(t).call(this));n.setMaxListeners(100),n.limits={},n.editor=e,n.projectRoot=i,n.state={selection:{layers:[null]}},n.keyframeSelection=new M["default"](n),n.uiState={currentTime:0,currentKeyframe:0,isPlaying:!1},n.getDofLimits(),n._reloadFile(e.uri);var r=N["default"].createHash("md5");r.update(e.uri);var s=r.digest("hex"),l=D["default"].basename(s),d=x+"/"+l+".backup";return w["default"].existsSync(d)||n.backup(),n.undoRedo=new v["default"](n),n}return n(t,e),s(t,null,[{key:"createNewFile",value:function(e){var t=u["default"].runtime.create(h["default"]);u["default"].runtime.save(e,t)}}]),s(t,[{key:"dispose",value:function(){delete this.state,delete this.uiState,this.requestAnimationID&&window.cancelAnimationFrame(this.requestAnimationID)}},{key:"getDofLimits",value:function(){var e=this,t=new b.JiboConfig;b.RobotInfo.createInfo(t,function(t){t.getBodyDOFNames().forEach(function(i){var a=u["default"].channels.dofNameToDisplayName(i);e.limits[a]={};var o=t.getDOFInfo(i),n=o.getLimit("velocity"),r=o.getLimit("acceleration");e.limits[a].velocityLimit=n,e.limits[a].accelerationLimit=r}),e.robotInfo=t,e.emit("onpropertieschanged")})}},{key:"setLimit",value:function(e,t){this.limits.exceedsVelLimit=e,this.limits.exceedsAccelLimit=t}},{key:"getKeyframeInfo",value:function(){return h["default"]}},{key:"getLayer",value:function(e){for(var t=0;t<this.state.keyframes.layers.length;t++)if(this.state.keyframes.layers[t].id===e)return this.state.keyframes.layers[t];return null}},{key:"getLayersOfType",value:function(e){e=Array.isArray(e)?e:[e];var t=p["default"].filter(this.state.keyframes.layers,function(t){return p["default"].includes(e,t.type)});return t}},{key:"isLayerOfTypeSelected",value:function(e){return e=Array.isArray(e)?e:[e],p["default"].includes(e,this.keyframeSelection.getSelectionLayerType())}},{key:"deleteLayerById",value:function(e){for(var t=this.getSelectedLayer().id,i=0;i<this.state.keyframes.layers.length;i++)if(this.state.keyframes.layers[i].id===e)return this.state.keyframes.layers.splice(i,1),0===this.state.keyframes.layers.length?this.state.selection.layers[0]=null:t===e&&this.setSelection(this.state.keyframes.layers[0].id),this.syncOverrides(),this.emit("ondatachanged"),void this.emit("onpropertieschanged")}},{key:"setLayerName",value:function(e,t){var i=this.getLayer(e);i.name=t,this.emit("ondatachanged"),this.emit("onpropertieschanged")}},{key:"generateID",value:function(){return Math.floor(0x12ab3babf5f80c00*Math.random()).toString(16)}},{key:"_findNameForLayer",value:function(e){if(null===this.getLayerByName(e))return e;for(var t=1;1e5>t;t++){var i=e+" #"+t;if(null===this.getLayerByName(i))return i}}},{key:"addLayer",value:function(e){this.state.keyframes.layers.push({id:u["default"].generateId(),name:this._findNameForLayer(e),type:e,visible:!0,locked:!1,keyframes:[]}),1===this.state.keyframes.layers.length&&this.setSelection(this.state.keyframes.layers[0].id),this.syncOverrides(),this.emit("ondatachanged"),this.emit("onpropertieschanged")}},{key:"_addLayerFromData",value:function(e){var t={id:u["default"].generateId(),name:e.name,type:e.type,visible:e.visible,locked:e.locked,keyframes:p["default"].cloneDeep(e.keyframes)};return this.state.keyframes.layers.push(t),t.id}},{key:"undo",value:function(){this.undoRedo.undo(),this.emit("onpropertieschanged")}},{key:"redo",value:function(){this.undoRedo.redo(),this.emit("onpropertieschanged")}},{key:"cut",value:function(){this.copy(),this.keyframeSelection.deleteKeyframes()}},{key:"cutKeyByTime",value:function(e,t){this.copyKeyByTime(e,t),this.deleteKeyByTime(e,t)}},{key:"cutLayer",value:function(e){this.copyLayer(e),this.deleteLayerById(e),this.emit("onpropertieschanged"),this.emit("ondatachanged")}},{key:"copy",value:function(){var e=this,t=this.getSelectedLayer();if(null!==t){var i=p["default"].findIndex(t.keyframes,function(t){return t.time===e.uiState.currentKeyframe});this._copyKey(t,i)}}},{key:"copyKeyByTime",value:function(e,t){var i=this.getLayer(e),a=p["default"].findIndex(i.keyframes,function(e){return e.time===t});this._copyKey(i,a)}},{key:"_copyKey",value:function(e,t){if(null!==e&&-1!==t){var i={type:"keyframe",layerType:e.type,value:p["default"].cloneDeep(e.keyframes[t].value)};g["default"].animationData=JSON.stringify(i)}}},{key:"copyLayer",value:function(e){var t=this.getLayer(e),i={type:"layer",object:p["default"].cloneDeep(t)};g["default"].animationData=JSON.stringify(i)}},{key:"canPasteLayer",value:function(){if(void 0!==g["default"].animationData){var e=JSON.parse(g["default"].animationData),t="layer"===e.type,i="Video";if(t&&e.object.type==i){var a=this.getLayersOfType(i);t=0===a.length}return t}return!1}},{key:"paste",value:function(){this._pasteKey(this.getSelectedLayer(),this.uiState.currentKeyframe)}},{key:"_pasteKey",value:function(e,t){if(this.canPasteKeyframe(e.id)){var i=JSON.parse(g["default"].animationData);this.upsertKeyframe(e,t,i.value),this.syncOverrides(),this.emit("ondatachanged"),this.emit("onpropertieschanged"),this.addRedoUndoEntry()}}},{key:"pasteKeyByTime",value:function(e,t){var i=this.getLayer(e);this._pasteKey(i,t)}},{key:"pasteLayer",value:function(e){if(this.canPasteLayer()){var t=JSON.parse(g["default"].animationData),i=this._addLayerFromData(t.object);this.reorderToAfterLayer(i,e),this.syncOverrides(),this.emit("ondatachanged"),this.emit("onpropertieschanged"),this.addRedoUndoEntry()}}},{key:"getData",value:function(){return this.state}},{key:"getMutationFunctionNames",value:function(){return["reloadFile","addRedoUndoEntry","upsertKeyframes","resetKeyframes","setLayerName","addLayer","insertBlankFrame","deleteFrame","deleteLayerById","deleteKeysByLayerId","deleteKeyByTime","addKeyByTime"]}},{key:"reload",value:function(e){var t=this.state.selection.layers[0];this.state=e;var i=this.getSelectedLayer();i||(0!==this.state.keyframes.layers.length?this.state.selection.layers[0]=this.state.keyframes.layers[0].id:this.state.selection.layers[0]=null),this.uiState.currentKeyframe>=this.state.keyframes.duration&&this.setKeyframe(this.state.keyframes.duration-1),this.isPlaying()&&this.togglePlay(),t!==this.state.selection.layers[0]&&this.emit("layerselected")}},{key:"reloadFile",value:function(){this._reloadFile(this.editor.uri)}},{key:"_reloadFile",value:function(e){var t=this;return this.state?(this.state.keyframes=u["default"].runtime.load(e,h["default"]),this.state.overrides={},this.state.keyframes.layers.forEach(function(e){t.state.overrides[e.id]={}}),this.syncOverrides(),this.reload(this.state),this.emit("ondatachanged"),void this.emit("onpropertieschanged")):(console.warn("attempting to reload destroyed AM for ",this),"")}},{key:"getDuration",value:function(){return this.state.keyframes.duration}},{key:"setDuration",value:function(e,t,i){return this.state.keyframes.duration=this.multiplier&&!t?Math.ceil(e*this.multiplier):e,i&&(this.state.keyframes.layers.forEach(function(t){var i=p["default"].findIndex(t.keyframes,function(t){return t.time>=e});-1!==i&&(t.keyframes=t.keyframes.slice(0,i))}),this.uiState.currentKeyframe>=this.state.keyframes.duration&&this.setKeyframe(this.state.keyframes.duration-1),this.keyframeSelection.validateSelection()),this.emit("ondatachanged"),this.emit("onpropertieschanged"),this.state.keyframes.duration}},{key:"setKeyframes",value:function(){var e=this;this.multiplier&&(this.state.keyframes.layers.forEach(function(t){t.keyframes.forEach(function(t){t.time=Math.floor(t.time*e.multiplier)})}),this.syncOverrides(),this.emit("ondatachanged"),this.emit("onpropertieschanged"))}},{key:"setScale",value:function(e){e!==this.state.keyframes.scale&&(this.state.keyframes.scale&&(this.multiplier=e/this.state.keyframes.scale),this.state.keyframes.scale=e)}},{key:"insertBlankFrame",value:function(e){var t=this,i=[];this.keyframeSelection.forEachLayerSelected(!0,function(e){i.push(t.getLayer(e))});var a=this.keyframeSelection.getLengthSelected();this.setDuration(this.state.keyframes.duration+a,!0,!0),i.forEach(function(t){t.keyframes.forEach(function(t){t.time>=e&&(t.time+=a)})}),this.emit("ondatachanged"),this.emit("onpropertieschanged")}},{key:"deleteFrame",value:function(e){var t=this,i=[];this.keyframeSelection.forEachLayerSelected(!0,function(e){i.push(t.getLayer(e))});var a=this.keyframeSelection.getLengthSelected();i.forEach(function(i){for(var o=0;o<i.keyframes.length;o++){var n=i.keyframes[o];n.time>e+a?n.time-=a:n.time>=e&&n.time<e+a&&(t._deleteKeyframe(i,n),o-=1)}}),this.emit("ondatachanged"),this.emit("onpropertieschanged")}},{key:"setSelection",value:function(e){this.state.selection.layers[0]=e,this.keyframeSelection.validateSelection(),this.emit("ondatachanged"),this.emit("layerselected")}},{key:"getSelectedLayer",value:function(){for(var e=this.state.selection.layers[0],t=0;t<this.state.keyframes.layers.length;t++)if(this.state.keyframes.layers[t].id===e)return this.state.keyframes.layers[t];return null}},{key:"getSelectedLayerProperties",value:function(){var e=this.getSelectedLayer();return this.state.overrides[e.id]}},{key:"reorderToBeforeLayer",value:function(e,t){var i=this.getLayer(e),a=p["default"].indexOf(this.state.keyframes.layers,i);this.state.keyframes.layers.splice(a,1);var o=this.getLayer(t),n=p["default"].indexOf(this.state.keyframes.layers,o);this.state.keyframes.layers.splice(n,0,i),this.emit("ondatachanged")}},{key:"reorderToAfterLayer",value:function(e,t){var i=this.getLayer(e),a=p["default"].indexOf(this.state.keyframes.layers,i);this.state.keyframes.layers.splice(a,1);var o=this.getLayer(t),n=p["default"].indexOf(this.state.keyframes.layers,o);this.state.keyframes.layers.splice(n+1,0,i),this.emit("ondatachanged")}},{key:"getLayerIndex",value:function(e){return p["default"].indexOf(this.state.keyframes.layers,this.getLayer(e))}},{key:"getLayerCount",value:function(){return this.state.keyframes.layers.length}},{key:"getLayerByIndex",value:function(e){return this.state.keyframes.layers[e]}},{key:"getLayerByName",value:function(e){var t=p["default"].findIndex(this.state.keyframes.layers,function(t){return t.name===e});return-1!==t?this.state.keyframes.layers[t]:null}},{key:"isPreviousLayer",value:function(e,t){var i=this.getLayerIndex(e),a=this.getLayerIndex(t);return i===a-1}},{key:"isNextLayer",value:function(e,t){var i=this.getLayerIndex(e),a=this.getLayerIndex(t);return i===a+1}},{key:"updateSelectedLayerProperties",value:function(e){var t=this.getSelectedLayer().id;this.state.overrides[t]=p["default"].merge({},p["default"].cloneDeep(this.state.overrides[t]),p["default"].cloneDeep(e)),this.emit("ondatachanged")}},{key:"updateSelectedLayerPropertiesRelative",value:function(e){e=u["default"].runtime.computeRelativePropValues(this.getSelectedLayer(),this.state.keyframes,h["default"],this.uiState.currentTime,e,this.state.overrides),this.updateSelectedLayerProperties(e)}},{key:"addRedoUndoEntry",value:function(){}},{key:"backup",value:function(){var e=N["default"].createHash("md5");e.update(this.editor.uri);var t=e.digest("hex"),i=D["default"].basename(t),a=x+"/"+i+".backup";this.saveFile(a)}},{key:"toggleLayerVisibility",value:function(e){var t=this.getLayer(e);t.visible=!t.visible,this.emit("ondatachanged"),this.emit("onpropertieschanged"),this.addRedoUndoEntry()}},{key:"toggleLayerLocked",value:function(e){var t=this.getLayer(e);t.locked=!t.locked,this.emit("ondatachanged"),this.emit("onpropertieschanged"),this.addRedoUndoEntry()}},{key:"deleteKeyByTime",value:function(e,t){var i=this.getLayer(e),a=p["default"].find(i.keyframes,function(e){return e.time===t});this._deleteKeyframe(i,a)&&(this.syncOverrides(),this.emit("ondatachanged"),this.emit("onpropertieschanged"))}},{key:"_deleteKeyByTime",value:function(e,t){var i=this,a=this.getLayer(e);p["default"].remove(a.keyframes,function(e){return i.syncOverrides(),i.emit("ondatachanged"),i.emit("onpropertieschanged"),e.time===t})}},{key:"_deleteKeyframe",value:function(e,t){return t?(p["default"].remove(e.keyframes,function(e){return e===t}),!0):!1}},{key:"deleteKeysByLayerId",value:function(e){var t=this.getLayer(e),i=0!==t.keyframes.length;t.keyframes=[],i&&(this.syncOverrides(),this.emit("ondatachanged"),this.emit("onpropertieschanged"))}},{key:"upsertKeyframes",value:function(e){var t=this,i=e?this.state.keyframes.layers:[this.getLayer(this.state.selection.layers[0])],a=[];i.forEach(function(e){var i=e.id,o=t,n=p["default"].find(e.keyframes,function(e){return e.time===o.uiState.currentKeyframe});n?(n.value=p["default"].cloneDeep(t.state.overrides[i]),a.push(e)):t._addKeyframe(e,o.uiState.currentKeyframe)}),0!==a.length&&this.emit("onkeyframeupsert",{keyframeTime:this.uiState.currentKeyframe,layers:a}),this.emit("ondatachanged"),this.emit("onpropertieschanged")}},{key:"addKeyByTime",value:function(e,t){var i=this.getLayer(e);this._addKeyframe(i,t),this.emit("ondatachanged"),this.emit("onpropertieschanged")}},{key:"_addKeyframe",value:function(e,t){for(var i=e.id,a=!1,o=0;o<e.keyframes.length;o++)if(e.keyframes[o].time>t){e.keyframes=r(e.keyframes,o,{value:p["default"].cloneDeep(this.state.overrides[i]),time:t}),a=!0;break}a||e.keyframes.push({value:p["default"].cloneDeep(this.state.overrides[i]),time:t}),this.addRedoUndoEntry()}},{key:"keyframeExists",value:function(e,t){var i=this.getLayer(e);return i?-1!==p["default"].findIndex(i.keyframes,function(e){return t===e.time}):!1}},{key:"getKeyframe",value:function(e,t){var i=this.getLayer(e);if(i){var a=p["default"].findIndex(i.keyframes,function(e){return t===e.time});if(-1!==t)return i.keyframes[a]}return null}},{key:"moveKeyframe",value:function(e,t,i,a,o,n){var r=this.getLayer(e),s=this.getLayer(i),l=p["default"].findIndex(r.keyframes,function(e){return e.time===t}),d=r.keyframes[l];n||r.keyframes.splice(l,1),this.upsertKeyframe(s,a,d.value),this.syncOverrides(),o!==!1&&(this.emit("ondatachanged"),this.emit("onpropertieschanged"))}},{key:"upsertKeyframe",value:function(e,t,i){var a=p["default"].findIndex(e.keyframes,function(e){return e.time===t}),o={value:p["default"].cloneDeep(i),time:t};if(-1!==a)e.keyframes[a]=o;else if(0===e.keyframes.length||e.keyframes[e.keyframes.length-1].time<t)e.keyframes.push(o);else{var n=p["default"].findIndex(e.keyframes,function(e){return e.time>t});e.keyframes=r(e.keyframes,n,o)}}},{key:"resetKeyframes",value:function(){for(var e in this.state.overrides)this.state.overrides[e]=this.getDefaultPropsForLayerType(this.getLayer(e).type)}},{key:"syncOverrides",value:function(){var e=this;this.state.overrides={},this.state.keyframes.layers.forEach(function(t){var i=u["default"].runtime.evaluateLayer(t,e.state.keyframes,h["default"],e.uiState.currentTime);e.state.overrides[t.id]=i})}},{key:"evaluateAllDOFLayers",value:function(){var e=u["default"].runtime.evaluateAllDOFLayers(this.state.keyframes,h["default"],this.uiState.currentTime,this.state.overrides);return e}},{key:"evaluateAllLayersFiltered",value:function(e){var t=u["default"].runtime.evaluateAllLayersFiltered(this.state.keyframes,h["default"],this.uiState.currentTime,e,!0,this.state.overrides);return t}},{key:"getDefaultPropsForLayerType",value:function(e){var t=h["default"].layerTypes[e].getInfo(),i={};for(var a in t.properties)i[a]=p["default"].cloneDeep(t.properties[a].defaultValue);return i}},{key:"saveFile",value:function(e){this.state?(u["default"].runtime.save(e,this.state.keyframes),this.emit("save")):console.error("Attempting to save destroyed AM for uri ",this.editor.uri)}},{key:"isLayerSelected",value:function(e){for(var t=0;t<this.state.selection.layers.length;t++)if(this.state.selection.layers[t]===e)return!0;return!1}},{key:"isPlaying",value:function(){return this.uiState.isPlaying}},{key:"playLoop",value:function(){var e=(new Date).getTime(),t=(e-this.lastLoopTime)/1e3;for(this.lastLoopTime=e,this.uiState.currentTime+=t;this.uiState.currentTime>this.state.keyframes.duration/this.state.keyframes.framerate;)this.uiState.currentTime-=this.state.keyframes.duration/this.state.keyframes.framerate;var i=Math.floor(this.uiState.currentTime*this.state.keyframes.framerate);this.uiState.currentKeyframe!==i&&this.setKeyframe(i,!0),this.requestAnimationID=window.requestAnimationFrame(this.playLoop.bind(this))}},{key:"togglePlay",value:function(){this.isPlaying()?(window.cancelAnimationFrame(this.requestAnimationID),this.requestAnimationID=void 0):(this.lastLoopTime=(new Date).getTime(),this.requestAnimationID=window.requestAnimationFrame(this.playLoop.bind(this))),this.uiState.isPlaying=!this.uiState.isPlaying,this.emit("ondatachanged"),this.emit("toggle-play",this.uiState.isPlaying)}},{key:"getCurrentTime",value:function(){return this.uiState.currentTime}},{key:"stepTimeForward",value:function(){this.isPlaying()&&this.togglePlay(),this.setKeyframe((this.uiState.currentKeyframe+1)%this.state.keyframes.duration)}},{key:"stepTimeBackward",value:function(){this.isPlaying()&&this.togglePlay(),0===this.uiState.currentKeyframe?this.setKeyframe(this.state.keyframes.duration-1):this.setKeyframe(this.uiState.currentKeyframe-1)}},{key:"nextLayer",value:function(){if(!(this.state.keyframes.layers.length<2))for(var e=0;e<this.state.keyframes.layers.length;e++)if(this.state.keyframes.layers[e]===this.getSelectedLayer())return this.keyframeSelection._clearSelection(),this.setSelection(this.state.keyframes.layers[(e+1)%this.state.keyframes.layers.length].id),void this.addRedoUndoEntry()}},{key:"previousLayer",value:function(){if(!(this.state.keyframes.layers.length<2))for(var e=0;e<this.state.keyframes.layers.length;e++)if(this.state.keyframes.layers[e]===this.getSelectedLayer()){this.keyframeSelection._clearSelection();var t=e>0?e-1:this.state.keyframes.layers.length-1;return this.setSelection(this.state.keyframes.layers[t].id),void this.addRedoUndoEntry()}}},{key:"canMoveUp",value:function(e){if(this.state.keyframes.layers.length<2)return!1;var t=this.getLayerIndex(e),i=t>0?t-1:t;return t!==i}},{key:"canMoveDown",value:function(e){if(this.state.keyframes.layers.length<2)return!1;var t=this.getLayerIndex(e),i=t<this.state.keyframes.layers.length-1?t+1:t;return t!==i}},{key:"moveUp",value:function(e){if(this.canMoveUp(e)){var t=this.getLayerIndex(e)-1;this.reorderToBeforeLayer(e,this.getLayerByIndex(t).id),this.addRedoUndoEntry()}}},{key:"moveDown",value:function(e){if(this.canMoveDown(e)){var t=this.getLayerIndex(e)+1;this.reorderToAfterLayer(e,this.getLayerByIndex(t).id),this.addRedoUndoEntry()}}},{key:"goToNextKeyframe",value:function(){var e=Number.MAX_SAFE_INTEGER,t=this,i=this.state.selection.layers[0],a=this.getLayer(i);0!==a.keyframes.length&&(a.keyframes.forEach(function(i){i.time<=t.uiState.currentKeyframe||i.time>e||(e=i.time)}),e===Number.MAX_SAFE_INTEGER?this.setKeyframe(0):this.setKeyframe(e))}},{key:"goToPrevKeyframe",value:function(){var e=-1,t=this,i=this.state.selection.layers[0],a=this.getLayer(i);0!==a.keyframes.length&&(a.keyframes.forEach(function(i){i.time>=t.uiState.currentKeyframe||i.time<e||(e=i.time)}),-1===e?(this.uiState.currentKeyframe=this.state.keyframes.duration,this.goToPrevKeyframe()):this.setKeyframe(e))}},{key:"setKeyframe",value:function(e,t){e!==this.uiState.currentKeyframe&&(this.uiState.currentKeyframe=e,t||(this.uiState.currentTime=e/this.state.keyframes.framerate),this.syncOverrides(),this.emit("ondatachanged"))}}]),t}(l.EventEmitter),j=Array.prototype,T=j.push,L=j.slice,R=j.splice;exports["default"]=P},{"../../common/clipboard":92,"../../common/undo-redo":104,"./keyframe-selection":13,"animation-utilities":void 0,crypto:void 0,events:void 0,fs:void 0,"jibo-keyframes":void 0,"jibo-keyframes/lib/jibo-keyframe-info":void 0,lodash:void 0,path:void 0}],13:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},n=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),r=e("lodash"),s=i(r),l=e("../../common/clipboard"),d=i(l),u={NORMAL:"NORMAL",TOGGLE:"TOGGLE"},c=function(){function e(t){a(this,e),this.animationModel=t,this.reset()}return n(e,[{key:"reset",value:function(){this.animationModel.state.selection.keyframes={selected:{}},this.anchor={layerIndex:null,keyframeIndex:null}}},{key:"validateSelection",value:function(){var e=this;for(var t in this.getState().selected){if(null===this.animationModel.getLayer(t))return void delete this.getState().selected[t];this.getState().selected[t]=s["default"].filter(this.getState().selected[t],function(t){return t.time<e.animationModel.getDuration()})}}},{key:"canDeleteKeyframes",value:function(){var e=this,t=!1;return this.forEachSelected(!0,!0,function(i,a){e.animationModel.keyframeExists(i,a)===!0&&(t=!0)}),t}},{key:"canPasteKeyframes",value:function(e){var t=this;if("undefined"==typeof d["default"].animationData)return!1;var i=JSON.parse(d["default"].animationData);if("keyframes"!==i.type)return!1;var a=this.animationModel.getLayerIndex(e),o=i.value,n=!1;return o.forEach(function(e){var i=e.layerIndex+a;0>i||i>=t.animationModel.getLayerCount()-1||e.layerType!==t.animationModel.getLayerByIndex(i).type&&(n=!0)}),n===!1}},{key:"forEachLayerSelected",value:function(e,t){var i=this,a=[];for(var o in this.getState().selected)a.push(o);a=s["default"].sortBy(a,function(t){return e?i.animationModel.getLayerIndex(t):-i.animationModel.getLayerIndex(t)}),a.forEach(function(e){t(e)})}},{key:"forEachSelected",value:function(e,t,i){var a=this;this.forEachLayerSelected(e,function(e){
t?s["default"].forEach(a.getState().selected[e],function(t,a){i(e,t,a)}):s["default"].forEachRight(a.getState().selected[e],function(t,a){i(e,t,a)})})}},{key:"getState",value:function(){return this.animationModel.state.selection.keyframes}},{key:"includesKeyframes",value:function(){var e=this,t=function(t){for(var i=e.animationModel.getLayer(t),a=e.getState().selected[t],n=function(e){return-1!==s["default"].findIndex(i.keyframes,function(t){return t.time===a[e]})?{v:{v:!0}}:void 0},r=0;r<a.length;r++){var l=n(r);if("object"===("undefined"==typeof l?"undefined":o(l)))return l.v}};for(var i in this.getState().selected){var a=t(i);if("object"===("undefined"==typeof a?"undefined":o(a)))return a.v}return!1}},{key:"getSelectionLayerType",value:function(){if(this.isMultiSelect())throw new Error("Don't call KeyframeSelection.getSelectionLayerType() when KeyframeSelection.isMultiSelect() is true");var e=this.getCurrentKeyframe().layerId;return e?this.animationModel.getLayer(e).type:void 0}},{key:"getCurrentKeyframe",value:function(){if(!this.isMultiSelect()){for(var e in this.getState().selected)if(this.getState().selected[e].length)return{keyframeIndex:this.getState().selected[e][0],layerId:e};var t=this.animationModel.getSelectedLayer();return{keyframeIndex:this.animationModel.uiState.currentTime,layerId:t?t.id:void 0}}throw new Error("KeyframeSelection.getCurrentKeyframe() should only be called when there aren't multiple keyframes selected")}},{key:"getLengthSelected",value:function(){if(!this.isMultiSelect())return 1;var e=0,t=1e3;return this.forEachSelected(!1,!1,function(i,a){a>e?e=a:t>a&&(t=a)}),e-t+1}},{key:"isSingleSelect",value:function(){return!this.isMultiSelect()}},{key:"isMultiSelect",value:function(){var e=0;for(var t in this.getState().selected)if(e+=this.getState().selected[t].length,e>=2)return!0;return!1}},{key:"isAnchor",value:function(e,t){return this.animationModel.getLayerIndex(e)===this.getState().anchor.layerIndex&&t===this.getState().anchor.keyframeIndex}},{key:"isSelected",value:function(e,t){return"undefined"==typeof this.getState().selected[e]?!1:-1!==s["default"].findIndex(this.getState().selected[e],function(e){return e===t})}},{key:"onClick",value:function(e,t,i){this.onMouseDown(e,t,i)}},{key:"onMouseDown",value:function(e,t,i,a){1!==e.nativeEvent.which&&(e.preventDefault(),e.stopPropagation());var o=u.NORMAL;if("win32"===process.platform?e.nativeEvent.ctrlKey&&(o=u.TOGGLE):e.nativeEvent.metaKey&&(o=u.TOGGLE),"click"!==e.type||!this.isSingleSelect()&&o!==u.TOGGLE){var n=this.isSelected(t,i);if("click"===e.type||o!==u.NORMAL||e.nativeEvent.shiftKey!==!1||!n){o===u.NORMAL&&("click"===e.type||e.nativeEvent.shiftKey===!0||n===!1&&"click"!==e.type&&e.nativeEvent.shiftKey!==!0)&&(this.animationModel.setKeyframe(i),this.animationModel.setSelection(t),this._clearSelection(),a=!0);var r=this.animationModel.getLayerIndex(t);if(e.nativeEvent.shiftKey===!1)this._addKeyframe(t,i,o)&&(a=!0);else for(var s=Math.min(this.anchor.layerIndex,r),l=Math.max(this.anchor.layerIndex,r),d=s;l>=d;d++)for(var c=Math.min(this.anchor.keyframeIndex,i),h=Math.max(this.anchor.keyframeIndex,i),f=c;h>=f;f++)this._addKeyframe(this.animationModel.getLayerByIndex(d).id,f,o)&&(a=!0);e.nativeEvent.shiftKey===!1&&(this.anchor.layerIndex=r,this.anchor.keyframeIndex=i);var p=this.animationModel.getLayerByIndex(r);p!==this.animationModel.getSelectedLayer()&&(this.animationModel.setSelection(t),a=!0),a&&(this.animationModel.addRedoUndoEntry(),this.animationModel.emit("ondatachanged"))}}}},{key:"clearSelection",value:function(){this._clearSelection()&&(this.animationModel.addRedoUndoEntry(),this.animationModel.emit("ondatachanged"))}},{key:"selectAll",value:function(){this._clearSelection();for(var e=0;e<this.animationModel.state.keyframes.layers.length;e++){var t=this.animationModel.state.keyframes.layers[e];this.getState().selected[t.id]=[];for(var i=0;i<this.animationModel.state.keyframes.duration;i++)this.getState().selected[t.id][i]=i}this.animationModel.emit("ondatachanged"),this.animationModel.addRedoUndoEntry()}},{key:"deleteKeyframes",value:function(){var e=this._deleteKeyframes();this._clearSelection()&&(e=!0),e&&(this.animationModel.syncOverrides(),this.animationModel.addRedoUndoEntry(),this.animationModel.emit("ondatachanged"),this.animationModel.emit("onpropertieschanged"))}},{key:"moveSelection",value:function(e,t,i){var a=this,o=this,n=t.keyframeIndex-e.keyframeIndex,r=this.animationModel.getLayerIndex(t.layerId)-this.animationModel.getLayerIndex(e.layerId),s=!1,l={};if(this.forEachLayerSelected(!0,function(e){var t=a.animationModel.getLayerIndex(e),i=t+r;return 0>i||i>=a.animationModel.getLayerCount()?void(l[e]=!0):void(a.animationModel.getLayerByIndex(t).type!==a.animationModel.getLayerByIndex(i).type&&(s=!0))}),s!==!0){var d=0>n,u=0>r;if(this.forEachSelected(u,d,function(e,t,s){var l=a.animationModel.getLayerIndex(e)+r,d=a.animationModel.getLayerByIndex(l).id,u=t+n;a.animationModel.keyframeExists(e,t)&&(l>=0&&l<=o.animationModel.getLayerCount()-1&&u>=0&&u<=o.animationModel.getDuration()-1?o.animationModel.moveKeyframe(e,t,d,u,!0,i):i||o.animationModel._deleteKeyByTime(e,t));var c=a.getState().selected[e];c[s]=c[s]+n}),t.layerId!==e.layerId){for(var c in l)delete this.getState().selected[c];var h={};for(var f in this.getState().selected){var p=this.animationModel.getLayerIndex(f);h[this.animationModel.getLayerByIndex(p+r).id]=this.getState().selected[f]}this.getState().selected=h}this.animationModel.setSelection(t.layerId),this.animationModel.addRedoUndoEntry(),this.animationModel.emit("ondatachanged"),this.animationModel.emit("onpropertieschanged")}}},{key:"cutSelectedKeyframes",value:function(){this.copySelectedKeyframes(),this.deleteKeyframes()}},{key:"copySelectedKeyframes",value:function(){var e=this,t=void 0;if(this.isMultiSelect())t=this.getState().selected;else{var i=this.getCurrentKeyframe();if(void 0===i.layerId)return;t={},t[i.layerId]=[i.keyframeIndex]}var a=this.animationModel.getDuration()-1,o=this.animationModel.getLayerCount()-1;for(var n in t)o=Math.min(o,this.animationModel.getLayerIndex(n)),t[n].forEach(function(e){a=Math.min(a,e)});var r=[],l=function(i){var n={layerType:e.animationModel.getLayer(i).type,layerIndex:e.animationModel.getLayerIndex(i)-o,keyframes:[]};t[i].forEach(function(t){var o=e.animationModel.getKeyframe(i,t);o?n.keyframes.push({keyframeIndex:t-a,value:s["default"].cloneDeep(o.value)}):n.keyframes.push({keyframeIndex:t-a,value:null})}),r.push(n)};for(var u in t)l(u);if(r=s["default"].sortBy(r,function(e){return e.layerIndex}),r.length){var c={type:"keyframes",value:r};d["default"].animationData=JSON.stringify(c)}}},{key:"pasteKeyframes",value:function(e,t){var i=this;if(this.canPasteKeyframes(e,t)!==!1){var a=this._clearSelection(),o=JSON.parse(d["default"].animationData).value,n=this.animationModel.getLayerIndex(e);o.forEach(function(e){var o=e.layerIndex+n;0>o||o>i.animationModel.getLayerCount()-1||e.keyframes.forEach(function(e){var n=e.keyframeIndex+t;if(n>=0||n<i.animationModel.getDuration()){var r=i.animationModel.getLayerByIndex(o);null!==e.value&&i.animationModel.upsertKeyframe(r,n,e.value),i._addKeyframe(r.id,n,u.NORMAL),a=!0}})}),a&&(this.animationModel.syncOverrides(),this.animationModel.emit("ondatachanged"),this.animationModel.emit("onpropertieschanged"),this.animationModel.addRedoUndoEntry())}}},{key:"_clearSelection",value:function(){var e=!1;for(var t in this.getState().selected)this.getState().selected[t].length&&(e=!0);return this.getState().selected={},e}},{key:"_addKeyframe",value:function(e,t,i){var a=i===u.TOGGLE&&this.isSelected(e,t),o=void 0;if(a){if("undefined"==typeof this.getState().selected[e])return!1;o=this.getState().selected[e].length,s["default"].remove(this.getState().selected[e],function(e){return e===t})}else{if("undefined"==typeof this.getState().selected[e])return this.getState().selected[e]=[t],!0;o=this.getState().selected[e].length,this.getState().selected[e].push(t),this.getState().selected[e].sort(),this.getState().selected[e]=s["default"].uniq(this.getState().selected[e])}return o!==this.getState().selected[e].length}},{key:"_deleteKeyframes",value:function(){var e=this,t=function(t){var i=e.getState().selected[t],a=e.animationModel.getLayer(t);a.keyframes=s["default"].filter(a.keyframes,function(e){return-1===s["default"].findIndex(i,function(t){return t===e.time})})};for(var i in this.getState().selected)t(i)}}]),e}();exports["default"]=c},{"../../common/clipboard":92,lodash:void 0}],14:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("./visualizer"),r=i(n),s=e("./timeline"),l=i(s),d=e("../../atom-react/mixins/pane-resize-event-mixin"),u=i(d),c=e("../../common/layout/layout"),h=i(c),f=e("../../common/layout/h-layout"),p=i(f),m=e("../../common/layout/v-layout"),v=i(m),y=e("./properties"),g=i(y),b=e("./face/face"),k=i(b),M=e("./video/video"),E=i(M),w=e("atom"),S=e("../../atom-react/core/react-editor"),D=i(S),C=e("lodash"),N=i(C),_=e("fs"),O=i(_),x=o["default"].createClass({displayName:"EditorView",mixins:[u["default"]],getInitialState:function(){return{visualizerWidth:0,visualizerHeight:0,timelineWidth:0,timelineHeight:0,focusOnProps:!0}},componentWillMount:function(){var e=this,t=this;this.props.editor.animationModel.on("ondatachanged",function(){t.forceUpdate()}),this.props.editor.animationModel.on("onpropertieschanged",function(){e.checkModified()}),this.props.editor.animationModel.on("save",function(){e.checkModified()})},checkModified:function(){var e=this;try{O["default"].readFile(this.props.editor.uri,"utf8",function(t,i){var a=JSON.parse(i);e.props.editor.animationModel.state&&(N["default"].isEqual(a,e.props.editor.animationModel.state.keyframes)?e.props.editor.setModifiedStatus(!1):e.props.editor.setModifiedStatus(!0))})}catch(t){console.warn("error reading keyframes file, ",t)}},componentDidMount:function(){var e=this;this.setupPaneResizeEventMixin(),this.disposables=new w.CompositeDisposable,this.disposables.add(atom.commands.add(this.getDOMNode(),{"jibo-sdk:select-all-keyframes":this.selectAllKeyframes,"jibo-sdk:clear-keyframe-selection":this.clearKeyframeSelection,"jibo-sdk:upsert-keyframe":this.upsertKeyframe,"jibo-sdk:upsert-all":this.upsertAllKeyframes,"jibo-sdk:reset-keyframes":this.resetKeyframes,"jibo-sdk:delete":this.deletePressed,"jibo-sdk:insert-blank-frame":this.insertBlankFrame,"jibo-sdk:delete-frame":this.deleteFrame,"jibo-sdk:start-playing":this.startPlaying,"jibo-sdk:stop-playing":this.stopPlaying,"jibo-sdk:step-backward":this.stepBackward,"jibo-sdk:step-forward":this.stepForward,"jibo-sdk:next-layer":this.nextLayer,"jibo-sdk:previous-layer":this.previousLayer,"core:undo":this.undo,"core:redo":this.redo,"core:cut":this.cut,"core:copy":this.copy,"core:paste":this.paste,"jibo-sdk:lose-focus":this.setEditorFocus,"jibo-sdk:upsert-and-save":this.upsertAndSave}));var t=this;requestAnimationFrame(function(){t.setState({visualizerWidth:Math.floor(e.props.paneWidth/2)-4,visualizerHeight:Math.floor(e.props.paneHeight/2)-4,timelineWidth:Math.floor(e.props.paneWidth/2)-4,timelineHeight:Math.floor(e.props.paneHeight/2)-20})}),this.onFocusInCB=this.onFocusIn.bind(this),this.getDOMNode().addEventListener("focusin",this.onFocusInCB,!0),this.onFocusOutCB=this.onFocusOut.bind(this),this.getDOMNode().addEventListener("focusout",this.onFocusOutCB,!0)},onFocusIn:function(){},onFocusOut:function(e){this.props.editor.isPaneActive()!==!1&&(null===e.relatedTarget||e.relatedTarget===document.getElementsByClassName("workspace")[0])&&this.getDOMNode().focus()},startPlaying:function(){this.props.editor.animationModel.togglePlay()},stopPlaying:function(){this.props.editor.animationModel.isPlaying()&&this.props.editor.animationModel.togglePlay()},stepBackward:function(){this.props.editor.animationModel.stepTimeBackward(),this.props.editor.animationModel.keyframeSelection.clearSelection()},stepForward:function(){this.props.editor.animationModel.stepTimeForward(),this.props.editor.animationModel.keyframeSelection.clearSelection()},nextLayer:function(){this.props.editor.animationModel.nextLayer()},previousLayer:function(){this.props.editor.animationModel.previousLayer()},undo:function(){this.props.editor.animationModel.undo()},redo:function(){this.props.editor.animationModel.redo()},cut:function(){this.props.editor.animationModel.keyframeSelection.cutSelectedKeyframes()},copy:function(){this.props.editor.animationModel.keyframeSelection.copySelectedKeyframes()},paste:function(){if(this.props.editor.animationModel.keyframeSelection.isSingleSelect()){var e=this.props.editor.animationModel.keyframeSelection.getCurrentKeyframe();this.props.editor.animationModel.keyframeSelection.pasteKeyframes(e.layerId,e.keyframeIndex)}},deletePressed:function(){this.props.editor.animationModel.keyframeSelection.deleteKeyframes()},selectAllKeyframes:function(){this.props.editor.animationModel.keyframeSelection.selectAll()},clearKeyframeSelection:function(){this.props.editor.animationModel.keyframeSelection.clearSelection()},upsertKeyframe:function(){this.props.editor.animationModel.keyframeSelection.isSingleSelect()&&this.props.editor.animationModel.upsertKeyframes()},upsertAllKeyframes:function(){this.props.editor.animationModel.keyframeSelection.isSingleSelect()&&this.props.editor.animationModel.upsertKeyframes(!0)},resetKeyframes:function(){this.props.editor.animationModel.keyframeSelection.isSingleSelect()&&this.props.editor.animationModel.resetKeyframes()},upsertAndSave:function(){this.props.editor.animationModel.keyframeSelection.isSingleSelect()&&this.upsertKeyframe(),atom.commands.dispatch(this.getDOMNode(),"core:save")},insertBlankFrame:function(){var e=1e4;this.props.editor.animationModel.keyframeSelection.forEachSelected(!0,!0,function(t,i){e>i&&(e=i)}),this.props.editor.animationModel.insertBlankFrame(e)},deleteFrame:function(){var e=1e4;this.props.editor.animationModel.keyframeSelection.forEachSelected(!0,!0,function(t,i){e>i&&(e=i)}),this.props.editor.animationModel.deleteFrame(e)},setEditorFocus:function(){this.getDOMNode().focus()},componentWillUnmount:function(){this.cleanupPaneResizeEventMixin(),this.disposables.dispose(),this.getDOMNode().removeEventListener("focusout",this.onFocusOutCB),this.getDOMNode().removeEventListener("focusin",this.onFocusInCB)},onInnerHLayoutResize:function(e){this.setState({visualizerWidth:e[0],timelineWidth:this.state.timelineWidth})},onHLayoutResize:function(e){this.setState({visualizerWidth:e[0],timelineWidth:e[0]})},onVLayoutResize:function(e){this.setState({visualizerHeight:e[0],timelineHeight:e[1]})},render:function(){var e=null,t=o["default"].createElement(k["default"],{animationModel:this.props.editor.animationModel});if(this.props.editor.animationModel.getLayersOfType("Video").length>0){var i=D["default"].getProjectRoot(this.props.editor.uri);e=o["default"].createElement(v["default"],null,t,o["default"].createElement(E["default"],{projectRoot:i,animationModel:this.props.editor.animationModel}))}else e=t;return o["default"].createElement("div",{tabIndex:"1"},o["default"].createElement(h["default"],{ref:"topLevel",width:this.props.paneWidth,height:this.props.paneHeight-40,serialized:this.props.editor.layout},o["default"].createElement(p["default"],{onLayoutResize:this.onHLayoutResize},o["default"].createElement(v["default"],{onLayoutResize:this.onVLayoutResize},o["default"].createElement(p["default"],{onLayoutResize:this.onInnerHLayoutResize},o["default"].createElement(r["default"],{animationModel:this.props.editor.animationModel,width:this.state.visualizerWidth,height:this.state.visualizerHeight}),e),o["default"].createElement(l["default"],{playbackTime:this.props.editor.animationModel.uiState.currentKeyframe,onLabelonDoubleClick:this.onLabelonDoubleClick,animationModel:this.props.editor.animationModel,width:this.state.timelineWidth,height:this.state.timelineHeight,visualizerWidth:this.state.visualizerWidth,visualizerHeight:this.state.visualizerHeight})),o["default"].createElement(g["default"],{paneHeight:this.props.paneHeight,animationModel:this.props.editor.animationModel}))))}});exports["default"]=x},{"../../atom-react/core/react-editor":53,"../../atom-react/mixins/pane-resize-event-mixin":56,"../../common/layout/h-layout":98,"../../common/layout/layout":99,"../../common/layout/v-layout":100,"./face/face":16,"./properties":23,"./timeline":41,"./video/video":42,"./visualizer":43,atom:void 0,fs:void 0,lodash:void 0,react:void 0}],15:[function(e,t,exports){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),o=e("jibo-keyframes"),n=function(){function e(t,a,o){i(this,e),this.renderer=t,this.animationModel=a,this.layerType=o?"Overlay":"Eye";var n=o?"overlay_textureSubRootBn":"eyeSubRootBn",r=t.scene.getScene();this.rootBone=r.getObjectByName(n),this.prefix=o?"overlay_vertexJoint":"vertexJoint",this.vertices={};for(var s=1;10>s;s++){var l=""+this.prefix+s,d=r.getObjectByName(l);this.vertices[l]=d}this.onDataChangedBind=this.onDataChanged.bind(this),this.animationModel.on("ondatachanged",this.onDataChangedBind),this.onDataChanged()}return a(e,[{key:"onDataChanged",value:function(){var e=this,t=this.animationModel.evaluateAllLayersFiltered(function(t){return t.type===e.layerType})[this.layerType];t=t?t:this.animationModel.getDefaultPropsForLayerType(this.layerType);for(var i=1;10>i;i++){var a=t["Vertex "+i],n=""+this.prefix+i,r=this.vertices[n];r.position.x=o.conversion.toMetersX(a.x),r.position.y=o.conversion.toMetersY(a.y)}this.rootBone.position.x=o.conversion.toMetersX(t.Translate.x),this.rootBone.position.y=o.conversion.toMetersY(t.Translate.y),this.rootBone.scale.x=t.Scale.x,this.rootBone.scale.y=t.Scale.y,this.rootBone.rotation.z=t.Rotate*Math.PI/180}},{key:"dispose",value:function(){this.animationModel.removeListener("ondatachanged",this.onDataChangedBind)}}]),e}();exports["default"]=n},{"jibo-keyframes":void 0}],16:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("animation-utilities"),r=e("path"),s=i(r),l=e("../../controllers/vertex-controller"),d=i(l),u=e("../../controllers/scale-translate-controller"),c=i(u),h=e("../../controllers/rotation-controller"),f=i(h),p=e("./mode-select"),m=i(p),v=e("./eye-layer"),y=i(v),g=e("lodash"),b=i(g),k={vertex:d["default"],str:c["default"],rotation:f["default"]},M=new n.JiboConfig,E=1280/720,w=o["default"].createClass({displayName:"layout-child",getInitialState:function(){return{disabled:!0,mode:"str"}},render:function(){var e={face:{width:this.props.width,height:this.props.height,cursor:this.state.disabled?"not-allowed":"pointer"},div:{position:"relative"},container:{top:0,bottom:0,left:0,right:0,position:"absolute"}},t=this.props.height-40;return E<this.props.width/t?(e.div.height=t,e.div.width=E*t,e.div.left=.5*(this.props.width-e.div.width),e.div.right=.5*(this.props.width-e.div.width)):(e.div.height=this.props.width/E,e.div.width=this.props.width,e.div.top=.5*(t-e.div.height),e.div.bottom=.5*(t-e.div.height)),o["default"].createElement("div",{className:"face",onWheel:this.onWheel,style:e.face},o["default"].createElement(m["default"],{disabled:this.state.disabled,onSelect:this.onSelectMode}),o["default"].createElement("div",{style:e.div},o["default"].createElement("div",{ref:"container",style:e.container,className:"face-view"})))},getIntersectionAtHeight:function(e,t,i){var a=o["default"].findDOMNode(this.refs.container),r=new n.THREE.Vector3;r.set(e/a.clientWidth*2-1,2*-(t/a.clientHeight)+1,.5);var s=this.renderer.scene.getCamera();return r.unproject(s),r.z=i,r},drawBounds:function(){var e=o["default"].findDOMNode(this.refs.container);if(e)for(var t=e.getBoundingClientRect(),i=this.getIntersectionAtHeight(0,0,.5),a=this.getIntersectionAtHeight(t.width,0,.5),r=this.getIntersectionAtHeight(0,t.height,.5),s=this.getIntersectionAtHeight(t.width,t.height,.5),l=new n.THREE.LineBasicMaterial({color:11842740,linewidth:2}),d=[i,a,a,s,s,r,r,i];d.length;){var u=new n.THREE.Geometry;u.vertices.push(d.shift()),u.vertices.push(d.shift());var c=new n.THREE.Line(u,l);this.renderer.scene.getScene().add(c)}},onWheel:function(e){var t=e.nativeEvent.wheelDelta/1200;this.currentScale-=t,this.currentScale<1&&(this.currentScale=1);var i=this.renderer.scene.getCamera();i.left=this.originalCamera.left*this.currentScale,i.right=this.originalCamera.right*this.currentScale,i.top=this.originalCamera.top*this.currentScale,i.bottom=this.originalCamera.bottom*this.currentScale,i.updateProjectionMatrix()},componentWillMount:function(){},componentDidMount:function(){var e=this;this.lastLayerType="";var t=o["default"].findDOMNode(this.refs.container);n.RobotInfo.createInfo(M,function(i){e.robotInfo=i,n.visualize.createRobotRenderer(i,t,n.visualize.DisplayType.EYE,function(t){e.renderer=t,t.display(i.getDefaultDOFValues()),e.drawBounds(),e.init();var a=e.renderer.scene.getCamera();e.originalCamera={left:a.left,right:a.right,top:a.top,bottom:a.bottom},e.currentScale=1,e.onSelectMode(e.state.mode),e.onDataChanged(),e.onDataChangedBind=e.onDataChanged.bind(e),e.props.animationModel.on("ondatachanged",e.onDataChangedBind)})})},init:function(){this.eyeLayer=new y["default"](this.renderer,this.props.animationModel,!1),this.eyeOverlayLayer=new y["default"](this.renderer,this.props.animationModel,!0)},componentWillUnmount:function(){this.eyeLayer&&this.eyeLayer.dispose(),this.eyeOverlayLayer&&this.eyeOverlayLayer.dispose(),this.onDataChangedBind&&this.props.animationModel.removeListener("ondatachanged",this.onDataChangedBind)},onDataChanged:function(){var e=this,t=this.props.animationModel.getSelectedLayer(),i=this.state.disabled;if(this.props.animationModel.keyframeSelection.isMultiSelect()||!this.props.animationModel.isLayerOfTypeSelected(["Eye","Overlay"])||!t.visible||t.locked)this.controller&&this.controller.dispose(),this.setState({disabled:!0});else{this.setState({disabled:!1});var a=this.props.animationModel.keyframeSelection.getSelectionLayerType();(this.controller instanceof k[this.state.mode]==!1||i===!0||this.lastLayerType!==a)&&this.onSelectMode(this.state.mode)}if(this.robotInfo){if(!this.props.animationModel.keyframeSelection.isMultiSelect()&&this.props.animationModel.isLayerOfTypeSelected(["Eye","Overlay"])){var o=this.props.animationModel.evaluateAllLayersFiltered(function(e){return"Eye"===e.type||"Overlay"===e.type})[t.type];o=o?o:this.props.animationModel.getDefaultPropsForLayerType("Eye"),this.controller.setProps(o)}var n=this.props.animationModel.evaluateAllDOFLayers();n=b["default"].extend({},b["default"].cloneDeep(this.robotInfo.getDefaultDOFValues()),b["default"].cloneDeep(n)),n={eyeTextureInfixBn_r:s["default"].resolve(this.props.animationModel.projectRoot,n.eyeTextureInfixBn_r),overlayTextureInfixBn_r:s["default"].resolve(this.props.animationModel.projectRoot,n.overlayTextureInfixBn_r),eye_redChannelBn_r:n.eye_redChannelBn_r,eye_greenChannelBn_r:n.eye_greenChannelBn_r,eye_blueChannelBn_r:n.eye_blueChannelBn_r,overlay_redChannelBn_r:n.overlay_redChannelBn_r,overlay_greenChannelBn_r:n.overlay_greenChannelBn_r,overlay_blueChannelBn_r:n.overlay_blueChannelBn_r,screenBG_redChannelBn_r:n.screenBG_redChannelBn_r,screenBG_greenChannelBn_r:n.screenBG_greenChannelBn_r,screenBG_blueChannelBn_r:n.screenBG_blueChannelBn_r,screenBGTextureInfixBn_r:s["default"].resolve(this.props.animationModel.projectRoot,n.screenBGTextureInfixBn_r)},this.renderer.display(n),window.requestAnimationFrame(function(){e.controller&&e.controller.scaleSpheres()})}},onSelectMode:function(e){var t=o["default"].findDOMNode(this.refs.container);this.controller&&this.controller.dispose(),this.controller=new k[e](this.renderer,t,this.robotInfo,this.props.animationModel,!this.props.animationModel.keyframeSelection.isMultiSelect()&&this.props.animationModel.isLayerOfTypeSelected("Overlay")),this.state.mode=e,this.lastLayerType=this.props.animationModel.keyframeSelection.getSelectionLayerType()}});exports["default"]=w},{"../../controllers/rotation-controller":9,"../../controllers/scale-translate-controller":10,"../../controllers/vertex-controller":11,"./eye-layer":15,"./mode-select":17,"animation-utilities":void 0,lodash:void 0,path:void 0,react:void 0}],17:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},o=e("react"),n=i(o),r=e("atom");exports["default"]=n["default"].createClass({displayName:"mode-select",getInitialState:function(){return{mode:"str",disabled:!0}},componentDidMount:function(){this.subs=new r.CompositeDisposable,this.subs.add(atom.tooltips.add(n["default"].findDOMNode(this.refs.str),{title:"Move & Resize"})),this.subs.add(atom.tooltips.add(n["default"].findDOMNode(this.refs.vertex),{title:"Reshape"})),this.subs.add(atom.tooltips.add(n["default"].findDOMNode(this.refs.rotation),{title:"Rotate"}))},componentWillUnmount:function(){this.subs.dispose()},render:function(){var e="btn selected",t="btn",i={};return this.props.disabled&&(i.disabled=!0),n["default"].createElement("div",{className:"eye-mode"},n["default"].createElement("div",{className:"btn-group",style:{margin:5}},n["default"].createElement("button",a({ref:"str"},i,{tabIndex:300,className:"str"===this.state.mode?e:t,onClick:this.onClick.bind(this,"str")}),n["default"].createElement("i",{className:"fa fa-arrows"})),n["default"].createElement("button",a({ref:"vertex"},i,{tabIndex:301,className:"vertex"===this.state.mode?e:t,onClick:this.onClick.bind(this,"vertex")}),n["default"].createElement("i",{className:"fa fa-crosshairs"})),n["default"].createElement("button",a({ref:"rotation"},i,{tabIndex:302,className:"rotation"===this.state.mode?e:t,onClick:this.onClick.bind(this,"rotation")}),n["default"].createElement("i",{className:"fa fa-undo"}))))},onClick:function(e){this.state.mode=e,this.setState(this.state),this.props.onSelect(e)}})},{atom:void 0,react:void 0}],18:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=e("react"),n=i(o),r=e("jquery"),s=i(r),l=e("atom"),d=e("../../common/find-node"),u=i(d),c=e("path"),h=i(c),f=e("react/addons").addons.PureRenderMixin,p=new AudioContext,m=void 0,v=void 0,y=!1,g=void 0,b=n["default"].createClass({displayName:"KeyframeSlotView",mixins:[f],componentDidMount:function(){this.disposable=new l.CompositeDisposable,this.disposable.add(atom.commands.add(this.getDOMNode(),{"jibo-sdk:delete-keyframe":this._deleteKeyframe,"jibo-sdk:add-keyframe":this._addKeyframe,"jibo-sdk:insert-blank-frame":this._insertBlankFrame,"jibo-sdk:delete-frame":this._deleteFrame,"jibo-sdk:cut-keyframe":this._cutKeyframe,"jibo-sdk:copy-keyframe":this._copyKeyframe,"jibo-sdk:paste-keyframe":this._pasteKeyframe})),this.getDOMNode().keyframeSlotView=this,this.onDropCB=this.onDrop.bind(this),this.getDOMNode().addEventListener("drop",this.onDropCB,!0),this.renderWaveform(this.props)},componentWillUnmount:function(){this.disposable.dispose(),this.getDOMNode().removeEventListener("drop",this.onDropCB)},onMouseDown:function(e){1===e.nativeEvent.which&&this.props.animationModel.keyframeSelection.onMouseDown(e,this.props.layerId,this.props.keyframeIndex)},onMouseClick:function(e){1===e.nativeEvent.which&&this.props.animationModel.keyframeSelection.onClick(e,this.props.layerId,this.props.keyframeIndex)},componentWillReceiveProps:function(e){this.props.exists||e.exists!==!0?this.props.exists!==!0||e.exists?"undefined"!=typeof e.upserted&&(0,s["default"])(this.getDOMNode().childNodes[0]).stop(!0,!0).css({display:"inline-block",backgroundColor:"white"}).fadeIn(100).fadeOut(200):(0,s["default"])(this.getDOMNode().childNodes[0]).stop(!0,!0).css({backgroundColor:"#AF2B2B",display:"inline-block"}).fadeIn(100).fadeOut(200):(0,s["default"])(this.getDOMNode().childNodes[0]).stop(!0,!0).css({backgroundColor:"#1F8BFF",display:"inline-block"}).fadeIn(200).fadeOut(200),this.renderWaveform(e)},renderWaveform:function(e){var t=this,i=e.animationModel,o=i.getLayer(e.layerId);if("Audio Event"===o.type&&e.exists){var r,s=function(){for(var a=null,s=0;s<o.keyframes.length;s++)if(o.keyframes[s].time===e.keyframeIndex){a=o.keyframes[s];break}var l=a.time/i.state.keyframes.framerate,d=i.audio.root,u=a.value.AudioEvent.file;if(!(u&&u.length>0))return{v:void 0};if(u===t.file)return{v:void 0};t.file=u;var c=h["default"].resolve(d,"audio",u);t.clearCanvas(),r=new XMLHttpRequest,r.open("GET",c,!0),r.responseType="arraybuffer",r.onload=function(){p.decodeAudioData(r.response,function(e){var a=e.getChannelData(0),o=n["default"].findDOMNode(t.refs.canvas),r=Math.min(i.state.keyframes.duration/i.state.keyframes.framerate-l,e.length/e.sampleRate);o.width=18*r*30,o.height=40;var s=o.getContext("2d");s.beginPath(),s.moveTo(0,20);for(var d=1/540,u=0,c=0;r>c;c+=d){var h=Math.floor(c*e.sampleRate);if(h<e.length){var f=a[h];s.lineTo(u,25*f+20)}u++}s.strokeStyle="#ffffff",s.stroke()})},r.send()}();if("object"===("undefined"==typeof s?"undefined":a(s)))return s.v}else{var l=n["default"].findDOMNode(this.refs.canvas);l.width=0}},onDragStart:function(e){if(this.props.animationModel.keyframeSelection.isSelected(this.props.layerId,this.props.keyframeIndex)===!1)return void e.preventDefault();var t=n["default"].findDOMNode(this.refs.canvas);t.width=0,t.height=0,y="win32"===process.platform?e.nativeEvent.shiftKey:e.nativeEvent.metaKey,g=y,e.dataTransfer.setData("animation-editor/keyframe-drop",JSON.stringify({layerId:this.props.layerId,keyframeIndex:this.props.keyframeIndex})),v={layerId:this.props.layerId,keyframeIndex:this.props.keyframeIndex},e.dataTransfer.effectAllowed="move"},onDragEnter:function(e){var t=this,i=this,a=e.dataTransfer.getData("animation-editor/keyframe-drop");if(""!==a){this.props.animationModel.setKeyframe(this.props.keyframeIndex),[].forEach.call(document.querySelectorAll(".animation-channel-keyframe-slot.drag-over"),function(e){e.classList.remove("drag-over")}),[].forEach.call(document.querySelectorAll(".animation-channel-keyframe-slot.drag-over-empty"),function(e){e.classList.remove("drag-over-empty")}),[].forEach.call(document.querySelectorAll(".animation-channel-keyframe-slot.drag-over-mismatched"),function(e){e.classList.remove("drag-over-mismatched")}),a=JSON.parse(a);var o=this.props.keyframeIndex-v.keyframeIndex,n=this.props.animationModel.getLayerIndex(this.props.layerId)-this.props.animationModel.getLayerIndex(v.layerId);this.props.animationModel.keyframeSelection.forEachSelected(!0,!0,function(e,a){var r=a+o,s=t.props.animationModel.getLayerIndex(e),l=s+n;0>r||r>=i.props.animationModel.getDuration()||0>l||l>=i.props.animationModel.getLayerCount()||(t.props.animationModel.getLayerByIndex(s).type!==t.props.animationModel.getLayerByIndex(l).type?i.getDOMNode().parentNode.parentNode.parentNode.childNodes[1+l].childNodes[0].childNodes[r].classList.add("drag-over-mismatched"):t.props.animationModel.keyframeExists(e,a)?i.getDOMNode().parentNode.parentNode.parentNode.childNodes[1+l].childNodes[0].childNodes[r].classList.add("drag-over"):i.getDOMNode().parentNode.parentNode.parentNode.childNodes[1+l].childNodes[0].childNodes[r].classList.add("drag-over-empty"));
}),m={layerId:this.props.layerId,keyframeIndex:this.props.keyframeIndex}}},onDragLeave:function(){delete this.getDOMNode().style.background},clearDragOverClasses:function(){for(var e=document.getElementsByClassName("animation-channel-keyframes"),t=0;t<e.length;t++)for(var i=0;i<e[t].childNodes.length;i++)e[t].childNodes[i].classList.remove("drag-over"),e[t].childNodes[i].classList.remove("drag-over-empty"),e[t].childNodes[i].classList.remove("drag-over-mismatched")},onDrop:function(){g=!0},onDragEnd:function(e){m&&g&&e.nativeEvent.target.classList.contains("animation-channel-keyframe-slot")&&this.props.animationModel.keyframeSelection.moveSelection(v,m,y),m=null,this.clearDragOverClasses(),document.querySelector(".active .animation-editor").childNodes[0].focus()},clearCanvas:function(){var e=n["default"].findDOMNode(this.refs.canvas),t=e.getContext("2d");t.clearRect(0,0,e.width,e.height)},render:function(){var e={},t="animation-channel-keyframe-slot native-key-bindings";return this.props.selected&&(t+=" selected"),t+=this.props.exists?" exists":" not-exists",this.props.marker&&(t+=" marker"),this.props.exceedsLimit&&(t+=" exceeds"),n["default"].createElement("span",{draggable:"true",style:e,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,onDrop:this.onDrop,onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onClickCapture:this.onMouseClick,onMouseDownCapture:this.onMouseDown,className:t},n["default"].createElement("span",{className:"slot-effect"}),n["default"].createElement("span",{style:{position:"relative",width:0,height:0}},n["default"].createElement("canvas",{width:0,height:0,ref:"canvas",style:{pointerEvents:"none",position:"absolute"}})))},_deleteKeyframe:function(){this.props.animationModel.keyframeSelection.deleteKeyframes()},_addKeyframe:function(){this.props.animationModel.addKeyByTime(this.props.layerId,this.props.keyframeIndex)},_cutKeyframe:function(){this.props.animationModel.keyframeSelection.cutSelectedKeyframes()},_copyKeyframe:function(){this.props.animationModel.keyframeSelection.copySelectedKeyframes()},_pasteKeyframe:function(){this.props.animationModel.keyframeSelection.pasteKeyframes(this.props.layerId,this.props.keyframeIndex)},_insertBlankFrame:function(){this.props.animationModel.insertBlankFrame(this.props.keyframeIndex)},_deleteFrame:function(){this.props.animationModel.deleteFrame(this.props.keyframeIndex)}});atom.contextMenu.add({".animation-channel-keyframe-slot.selected.exists":[{label:"Set Keyframe",command:"jibo-sdk:upsert-keyframe"}],".animation-channel-keyframe-slot.selected":[{label:"Delete Keyframe(s)",command:"jibo-sdk:delete-keyframe",shouldDisplay:function(e){var t=u["default"].getAncestor(e.target,".animation-channel-keyframe-slot"),i=t?t.keyframeSlotView.props:void 0;return i&&i.animationModel.keyframeSelection.canDeleteKeyframes()}},{label:"Insert Blank Frame",command:"jibo-sdk:insert-blank-frame"},{label:"Delete Frame",command:"jibo-sdk:delete-frame"},{type:"separator"},{label:"Cut",command:"jibo-sdk:cut-keyframe"},{label:"Copy",command:"jibo-sdk:copy-keyframe"}],".animation-channel-keyframe-slot.not-exists":[{label:"Add Keyframe",command:"jibo-sdk:add-keyframe"},{type:"separator"}],".animation-channel-keyframe-slot":[{label:"Paste",command:"jibo-sdk:paste-keyframe",shouldDisplay:function(e){var t=u["default"].getAncestor(e.target,".animation-channel-keyframe-slot"),i=t?t.keyframeSlotView.props:void 0;return i&&i.animationModel.keyframeSelection.canPasteKeyframes(i.layerId,i.keyframeIndex)}}]}),exports["default"]=b},{"../../common/find-node":94,atom:void 0,jquery:void 0,path:void 0,react:void 0,"react/addons":void 0}],19:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("atom"),r=e("../../common/find-node"),s=i(r),l=void 0,d=void 0,u=void 0,c=o["default"].createClass({displayName:"LayerLabelView",getInitialState:function(){return{editingName:!1}},componentDidMount:function(){var e=o["default"].findDOMNode(this.refs.label);this.onKeyDownCB=this.onKeyDown.bind(this),e.addEventListener("keydown",this.onKeyDownCB),this.disposable=new n.CompositeDisposable,this.disposable.add(atom.commands.add(this.getDOMNode(),{"jibo-sdk:delete-anim-layer":this._deleteLayer,"jibo-sdk:toggle-layer-lock":this._toggleLocked,"jibo-sdk:toggle-layer-visibility":this._toggleVisibility,"jibo-sdk:delete-all-keys":this.deleteAllKeys,"jibo-sdk:move-layer-up":this.moveUp,"jibo-sdk:move-layer-down":this.moveDown,"jibo-sdk:cut-layer":this._cutLayer,"jibo-sdk:copy-layer":this._copyLayer,"jibo-sdk:paste-layer":this._pasteLayer})),this.getDOMNode().layerLabelView=this,this.disposable.add(atom.tooltips.add(o["default"].findDOMNode(this.refs["delete"]),{title:"Delete Layer"})),this.disposable.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.locked),{title:"Lock/Unlock Layer"})),this.disposable.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.showhide),{title:"Show/Hide Layer"}));var t=this.props.animationModel.getLayer(this.props.layerId),i=t.type+" layer";this.disposable.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.showhide),{title:i}))},componentWillUnmount:function(){var e=o["default"].findDOMNode(this.refs.label);e.removeEventListener("keydown",this.onKeyDownCB),this.disposable.dispose()},componentWillReceiveProps:function(e){this.synchronizeLabelText(e)},onKeyDown:function(e){var t=o["default"].findDOMNode(this.refs.label);if(13===e.which)this.setLayerName(),t.blur();else if(27===e.which)this.synchronizeLabelText(this.props),t.blur();else if(9===e.which){var i=void 0;i=e.shiftKey?t.parentNode.previousSibling:t.parentNode.nextSibling,i&&(i.getElementsByTagName("input")[0].disabled=!1,i.getElementsByTagName("input")[0].focus(),i.getElementsByTagName("input")[0].select(),e.preventDefault(),e.stopPropagation())}},onBlur:function(){var e=o["default"].findDOMNode(this.refs.label);e.disabled=!0,this.setState({editingName:!1}),this.setLayerName()},onFocus:function(){this.setState({editingName:!0}),this.selectLayer(!0);var e=o["default"].findDOMNode(this.refs.label);setTimeout(function(){e.select()},10)},setLayerName:function(){var e=o["default"].findDOMNode(this.refs.label);""===e.value&&this.synchronizeLabelText(this.props),this.props.animationModel.getLayer(this.props.layerId).name!==e.value&&this.props.animationModel.setLayerName(this.props.layerId,e.value)},synchronizeLabelText:function(){var e=o["default"].findDOMNode(this.refs.label),t=e.selectionStart,i=e.selectionEnd,a=e===document.activeElement;e.value=this.props.animationModel.getLayer(this.props.layerId).name,a&&(e.focus(),e.setSelectionRange(t,i))},onClick:function(){this.selectLayer(!0)},toggleVisibility:function(e){0===e.button&&(e.stopPropagation(),e.preventDefault(),this.selectLayer(),this._toggleVisibility())},_toggleVisibility:function(){this.props.animationModel.toggleLayerVisibility(this.props.layerId)},selectLayer:function(e){var t=this.props.animationModel.getLayer(this.props.layerId);t!==this.props.animationModel.getSelectedLayer()&&(this.props.animationModel.keyframeSelection._clearSelection(),this.props.animationModel.setSelection(this.props.layerId),e&&this.props.animationModel.addRedoUndoEntry())},toggleLocked:function(e){0===e.button&&(e.stopPropagation(),e.preventDefault(),this.selectLayer(),this._toggleLocked())},_toggleLocked:function(){this.props.animationModel.toggleLayerLocked(this.props.layerId)},deleteLayer:function(e){0===e.button&&(e.stopPropagation(),e.preventDefault(),this._deleteLayer())},_deleteLayer:function(){this.props.animationModel.deleteLayerById(this.props.layerId)},deleteAllKeys:function(){this.props.animationModel.deleteKeysByLayerId(this.props.layerId)},onLabelMouseDown:function(e){if(0===e.button){e.stopPropagation();var t=o["default"].findDOMNode(this.refs.label);t!==document.activeElement,this.props.animationModel.isLayerSelected(this.props.layerId)===!1&&this.selectLayer(!0)}},onLabelClick:function(e){e.stopPropagation();var t=o["default"].findDOMNode(this.refs.label);t!==document.activeElement&&e.preventDefault()},onLabelDoubleClick:function(){this.startEditing()},startEditing:function(){var e=this,t=o["default"].findDOMNode(this.refs.label);t!==document.activeElement&&setTimeout(function(){t.disabled=!1,e.setState({editingName:!0}),t.focus(),t.select()},10)},moveUp:function(){this.props.animationModel.moveUp(this.props.layerId)},moveDown:function(){this.props.animationModel.moveDown(this.props.layerId)},_cutLayer:function(){this.props.animationModel.cutLayer(this.props.layerId)},_copyLayer:function(){this.props.animationModel.copyLayer(this.props.layerId)},_pasteLayer:function(){this.props.animationModel.pasteLayer(this.props.layerId)},onDragStart:function(e){e.dataTransfer.setData("animation-editor/layer-drop",this.props.layerId),e.dataTransfer.effectAllowed="move"},onDragEnterTop:function(e){var t=e.dataTransfer.getData("animation-editor/layer-drop");if(""!==t&&this.props.layerId!==t&&!this.props.animationModel.isPreviousLayer(t,this.props.layerId)){var i=o["default"].findDOMNode(this.refs.dropTop);i.className="drop-top drag-over",this.onDropEnter(e,!0)}},onDragEnterBottom:function(e){var t=e.dataTransfer.getData("animation-editor/layer-drop");if(""!==t&&this.props.layerId!==t&&!this.props.animationModel.isNextLayer(t,this.props.layerId)){var i=o["default"].findDOMNode(this.refs.dropBottom);i.className="drop-bottom drag-over",this.onDropEnter(e,!1)}},onDropEnter:function(e,t){var i=e.dataTransfer.getData("animation-editor/layer-drop");""!==i&&i!==this.props.layerId&&(t?(d=i,l=this.props.layerId,u=t):(d=i,l=this.props.layerId,u=t))},onDragLeaveTop:function(){var e=o["default"].findDOMNode(this.refs.dropTop);e.className="drop-top"},onDragLeaveBottom:function(){var e=o["default"].findDOMNode(this.refs.dropBottom);e.className="drop-bottom"},clearDragOverClasses:function(){for(var e=this.getDOMNode().parentNode.getElementsByClassName("drop-top"),t=0;t<e.length;t++)e[t].className="drop-top";for(var i=this.getDOMNode().parentNode.getElementsByClassName("drop-bottom"),a=0;a<i.length;a++)i[a].className="drop-bottom"},onDragEnd:function(){this.clearDragOverClasses(),l&&(u?this.props.animationModel.reorderToBeforeLayer(d,l):this.props.animationModel.reorderToAfterLayer(d,l),l=null,document.querySelector(".active .animation-editor").childNodes[0].focus(),this.props.animationModel.addRedoUndoEntry())},render:function(){var e=this.props.animationModel.getLayer(this.props.layerId),t={parent:{opacity:e.locked||!e.visible?.2:1},label:{"float":"left",paddingLeft:10},dropTop:{width:270,height:20,cursor:"default",position:"absolute"},dropBottom:{width:270,height:20,marginTop:20,cursor:"default",position:"absolute"}},i="animation-channel-label native-key-bindings";this.props.animationModel.isLayerSelected(e.id)&&(i+=" selected"),this.props.odd&&(i+=" odd");var a=void 0;a=e.locked?o["default"].createElement("i",{ref:"locked",className:"fa fa-lock locked",onMouseDownCapture:this.toggleLocked}):o["default"].createElement("i",{ref:"locked",className:"fa fa-unlock locked",onMouseDownCapture:this.toggleLocked});var n=void 0;n=e.visible?o["default"].createElement("i",{ref:"showhide",className:"fa fa-eye visible",onMouseDownCapture:this.toggleVisibility}):o["default"].createElement("i",{ref:"showhide",className:"fa fa-times visible",onMouseDownCapture:this.toggleVisibility});var r=e.type+" layer";return o["default"].createElement("div",{draggable:"true",title:r,onDragStart:this.onDragStart,onMouseMove:this.onMouseMove,onDragEnd:this.onDragEnd,onClick:this.onClick,style:t.parent,className:i},o["default"].createElement("div",{title:r,ref:"dropTop",onDragEnter:this.onDragEnterTop,onDragLeave:this.onDragLeaveTop,style:t.dropTop,className:"drop-top",onMouseDownCapture:this.onLabelMouseDown}),o["default"].createElement("div",{title:r,ref:"dropBottom",onDragEnter:this.onDragEnterBottom,onDragLeave:this.onDragLeaveBottom,style:t.dropBottom,className:"drop-bottom",onMouseDownCapture:this.onLabelMouseDown}),o["default"].createElement("div",{className:"flags"},n,a),o["default"].createElement("div",{disabled:!0,tabIndex:this.props.tabIndex,style:t.label,ref:"label",onFocus:this.onFocus,onBlur:this.onBlur,onDoubleClickCapture:this.onLabelDoubleClick,onClickCapture:this.onLabelClick,onMouseDownCapture:this.onLabelMouseDown,type:"text"},e.name),o["default"].createElement("i",{ref:"delete",className:"fa fa-times delete",onMouseDownCapture:this.deleteLayer}))}});atom.contextMenu.add({"atom-pane .animation-channel-label":[{label:"Delete",command:"jibo-sdk:delete-anim-layer"},{type:"separator"},{label:"Delete All Keys",command:"jibo-sdk:delete-all-keys",shouldDisplay:function(e){var t=s["default"].getAncestor(e.target,".animation-channel-label"),i=t&&t.layerLabelView.props,a=i?i.animationModel.getLayer(i.layerId):void 0;return a?0!==a.keyframes.length&&!a.locked:!1}},{type:"separator"},{label:"Move Up",command:"jibo-sdk:move-layer-up",shouldDisplay:function(e){var t=s["default"].getAncestor(e.target,".animation-channel-label"),i=t&&t.layerLabelView.props;return i&&i.animationModel.canMoveUp(i.layerId)}},{label:"Move Down",command:"jibo-sdk:move-layer-down",shouldDisplay:function(e){var t=s["default"].getAncestor(e.target,".animation-channel-label"),i=t&&t.layerLabelView.props;return i&&i.animationModel.canMoveDown(i.layerId)}},{type:"separator"},{command:"jibo-sdk:toggle-layer-lock",created:function(e){var t=s["default"].getAncestor(e.target,".animation-channel-label"),i=t?t.layerLabelView.props:void 0;i&&i.animationModel.getLayer(i.layerId).locked?this.label="Unlock Layer":this.label="Lock Layer"}},{command:"jibo-sdk:toggle-layer-visibility",created:function(e){var t=s["default"].getAncestor(e.target,".animation-channel-label"),i=t?t.layerLabelView.props:void 0;i&&i.animationModel.getLayer(i.layerId).visible?this.label="Hide Layer":this.label="Show Layer"}},{type:"separator"},{label:"Cut",command:"jibo-sdk:cut-layer"},{label:"Copy",command:"jibo-sdk:copy-layer"},{label:"Paste",command:"jibo-sdk:paste-layer",shouldDisplay:function(e){var t=s["default"].getAncestor(e.target,".animation-channel-label");return t&&t.layerLabelView.props.animationModel.canPasteLayer()}}]}),exports["default"]=c},{"../../common/find-node":94,atom:void 0,react:void 0}],20:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("./keyframe-slot"),r=i(n),s=o["default"].createClass({displayName:"LayerView",getInitialState:function(){var e=this;return this.props.animationModel.on("onpropertieschanged",function(){e.forceUpdate()}),{}},shouldComponentUpdate:function(e){return this.props.latestHash!==e.latestHash||this.props.totalFrames!==e.totalFrames||"undefined"!=typeof e.upserted||"undefined"!=typeof e.selected},render:function(){for(var e={width:this.props.totalWidth,height:40,opacity:this.props.locked?.4:1},t=[],i=0,a=0;i<this.props.totalFrames;){var n=this.props.keyframesExceeded&&"Body"===this.props.type?this.props.keyframesExceeded[i]:!1,s=i%5===0,l=this.props.animationModel.keyframeSelection.isSelected(this.props.layerId,i),d=void 0;"undefined"!=typeof this.props.upserted&&this.props.upserted===i&&(d=this.props.upserted),a<this.props.keyframes.length&&this.props.keyframes[a].time===i?(t.push(o["default"].createElement(r["default"],{animationModel:this.props.animationModel,key:i,keyframeIndex:i,layerId:this.props.layerId,exists:!0,exceedsLimit:n,marker:s,selected:l,upserted:d})),a++):t.push(o["default"].createElement(r["default"],{animationModel:this.props.animationModel,key:i,keyframeIndex:i,layerId:this.props.layerId,exceedsLimit:n,marker:s,selected:l})),i++}return o["default"].createElement("div",{style:e,className:"animation-channel"},o["default"].createElement("div",{className:"animation-channel-keyframes"},t))}});exports["default"]=s},{"./keyframe-slot":18,react:void 0}],21:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("atom"),r=e("../../../common/directory-tree-view"),s=i(r),l=e("path"),d=i(l),u=e("../../../common/get-asset-packs"),c=i(u);exports["default"]=o["default"].createClass({displayName:"choose-texture-modal",onChoose:function(){var e=this.state.currentAssetPack,t=d["default"].join(e.root,"animations","textures"),i=d["default"].relative(t,this.state.currentTexture);i="project"===this.state.currentAssetPack.id?d["default"].join("animations","textures",i):d["default"].join("node_modules",this.state.currentAssetPack.id,"animations","textures",i),this.props.onChoose(i),this.props.onClose()},onCancel:function(){this.props.onClose()},getInitialState:function(){return{currentAssetPack:{id:"project"},currentTexture:"",filter:"",key:0}},onAssetPackSelected:function(e){this.setState({currentAssetPack:e})},onSelected:function(e){console.log(e),this.setState({currentTexture:e})},getPanelHeading:function(e){return o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px",width:"100%",height:30}},o["default"].createElement("p",{style:{textAlign:"center",marginTop:"4px",marginBottom:"4px"}},e))},render:function(){for(var e=this,t=(0,c["default"])(this.props.root),i=void 0,a=[],n=0;n<t.length;n++){var r=t[n],l="list-item";this.state.currentAssetPack.id===r.id&&(this.state.currentAssetPack=r,i=r,l+=" selected"),a.push(o["default"].createElement("li",{className:l,onClick:this.onAssetPackSelected.bind(this,r)},o["default"].createElement("span",null,r.name)))}return o["default"].createElement("div",{className:"asset-selector-modal",ref:"modal"},o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px"}},o["default"].createElement("h2",{style:{textAlign:"center",marginTop:"6px",marginBottom:"6px"}},"Choose a Texture File")),o["default"].createElement("label",{style:{marginLeft:10}},"Search"),o["default"].createElement("atom-text-editor",{ref:"editor",style:{marginLeft:10,marginRight:10,marginBottom:10},mini:!0}),o["default"].createElement("div",{className:"contents"},o["default"].createElement("div",{className:"list-contents"},this.getPanelHeading("Asset Pack"),o["default"].createElement("div",{className:"list-group asset-pack",ref:"assetPackList"},a)),o["default"].createElement("div",{className:"list-contents"},this.getPanelHeading("Texture File"),o["default"].createElement("div",{className:"asset-list"},o["default"].createElement(s["default"],{uri:d["default"].resolve(i.root,"animations","textures"),onChosen:function(t){e.onSelected(t),e.onChoose()},onSelected:this.onSelected,extension:[".png",".jpg","jpeg"],filter:this.state.filter}))),o["default"].createElement("div",{className:"preview-contents"},this.getPanelHeading("Preview"),o["default"].createElement("div",{className:"asset-preview"},o["default"].createElement("img",{key:this.state.key++,controls:!0,style:{width:"100%",padding:15},src:this.state.currentTexture})))),o["default"].createElement("div",{className:"btn-group"},o["default"].createElement("button",{className:"btn",onClick:this.onChoose},"Choose"),o["default"].createElement("button",{className:"btn",onClick:this.onCancel},"Cancel")))},onLeft:function(){var e=o["default"].findDOMNode(this.refs.assetPackList);e.focus()},onRight:function(){var e=o["default"].findDOMNode(this.refs.schemaList);e.focus()},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor);setTimeout(function(){t.focus(),e.disposable=new n.CompositeDisposable,e.disposable.add(atom.commands.add(e.getDOMNode(),{"jibo-sdk:escape":e.onCancel})),e.disposable=atom.commands.add(t,"jibo-sdk:confirm",function(){e.onChoose()})},100);var i=t.getModel();i.onDidChange(function(){e.setState({filter:i.getText()})})},componentWillUnmount:function(){this.disposable.dispose()}})},{"../../../common/directory-tree-view":93,"../../../common/get-asset-packs":95,atom:void 0,path:void 0,react:void 0}],22:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("./settings.js"),r=i(n),s=e("atom"),l=o["default"].createClass({displayName:"PlaybackControlsView",getInitialState:function(){return{showSettings:!1}},onPlayPause:function(){this.props.animationModel.togglePlay()},onStepForward:function(){this.props.animationModel.stepTimeForward()},onStepBackward:function(){this.props.animationModel.stepTimeBackward()},onGoToNextKeyframe:function(){this.props.animationModel.goToNextKeyframe()},onGoToPrevKeyframe:function(){this.props.animationModel.goToPrevKeyframe()},onSettings:function(){this.setState({showSettings:!0})},onSettingsFinished:function(){this.setState({showSettings:!1})},render:function(){var e=this.props.animationModel.isPlaying()?o["default"].createElement("i",{ref:"pausePlaying",className:"fa fa-pause",onClick:this.onPlayPause}):o["default"].createElement("i",{ref:"startPlaying",className:"fa fa-play",onClick:this.onPlayPause}),t={marginLeft:(this.props.timelineWidth-297)/2},i=this.state.showSettings?o["default"].createElement(r["default"],{onFinished:this.onSettingsFinished,animationModel:this.props.animationModel}):void 0;return o["default"].createElement("div",{style:t,className:"animation-editor-playback-controls"},o["default"].createElement("i",{ref:"goToPrevKeyframe",className:"fa fa-fast-backward",onClick:this.onGoToPrevKeyframe}),o["default"].createElement("i",{ref:"stepTimeBackward",className:"fa fa-step-backward",onClick:this.onStepBackward}),e,o["default"].createElement("i",{ref:"stepTimeForward",className:"fa fa-step-forward",onClick:this.onStepForward}),o["default"].createElement("i",{ref:"goToNextKeyframe",className:"fa fa-fast-forward",onClick:this.onGoToNextKeyframe}),o["default"].createElement("i",{ref:"settings",className:"fa fa-gear",onClick:this.onSettings}),i)},componentDidMount:function(){this.subs=new s.CompositeDisposable;var e=o["default"].findDOMNode(this.refs.startPlaying),t=o["default"].findDOMNode(this.refs.pausePlaying),i=e?e:t;this.subs.add(atom.tooltips.add(i,{title:"Play/Pause"})),this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.goToPrevKeyframe),{title:"Previous Keyframe"})),this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.goToNextKeyframe),{title:"Next Keyframe"})),this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.stepTimeForward),{title:"Next Frame"})),this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.stepTimeBackward),{title:"Previous Frame"})),this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.settings),{title:"Settings"}))},componentWillUnmount:function(){this.subs.dispose()}});exports["default"]=l},{"./settings.js":38,atom:void 0,react:void 0}],23:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=e("react"),n=i(o),r=e("../../atom-react/components/float-input-view"),s=i(r),l=e("./properties/texture-input"),d=i(l),u=e("./properties/rgb-input"),c=i(u),h=e("./properties/video-input"),f=i(h),p=e("./properties/event-input"),m=i(p),v=e("./properties/audio-input"),y=i(v),g=e("../../atom-react/components/jibo-combo-box"),b=i(g),k=0,M=n["default"].createClass({displayName:"PropertiesView",onPropertyChange:function(e,t){var i={};i[e]=t,this.props.animationModel.updateSelectedLayerProperties(i),this.props.animationModel.addRedoUndoEntry()},onVector2Change:function(e,t,i){var a={};a[e]={},a[e][t]=i,this.props.animationModel.updateSelectedLayerProperties(a),this.props.animationModel.addRedoUndoEntry()},vector2Input:function(e,t,i,a){var o=this,r="Scale"===e?4:1;return n["default"].createElement("div",{style:{"float":"right",display:"flex"}},n["default"].createElement("div",{className:"btn",style:{marginRight:5},onClick:function(){o.onVector2Change(e,"x",a.x),o.onVector2Change(e,"y",a.y)}},n["default"].createElement("i",{className:"fa fa-refresh"})),n["default"].createElement("div",{style:{"float":"left"}},[n["default"].createElement(s["default"],{style:{clear:"both",maxWidth:150},onChange:this.onVector2Change.bind(this,e,"x"),value:t.x,precision:r,tabIndex:i}),n["default"].createElement(s["default"],{style:{clear:"both",maxWidth:150},onChange:this.onVector2Change.bind(this,e,"y"),value:t.y,precision:r,tabIndex:i+1})]))},rgbInput:function(e,t,i,a){return(0,c["default"])(e,t,i,a,this.props.animationModel)},floatInput:function(e,t,i){return n["default"].createElement("div",{style:{"float":"right",display:"flex"}},n["default"].createElement("div",{className:"btn",style:{marginRight:5}},n["default"].createElement("i",{className:"fa fa-refresh"})),n["default"].createElement(s["default"],{step:1,style:{clear:"both",maxWidth:150},onChange:this.onPropertyChange.bind(this,e),value:t,precision:2,tabIndex:i}))},textureInput:function(e,t){var i=this;return(0,d["default"])(function(t){i.onPropertyChange(e,t),i.props.animationModel.editor.focus()},t,this.props.animationModel.projectRoot,this.props.animationModel.uri)},videoInput:function(e,t){var i=this.onPropertyChange.bind(this,e);return(0,f["default"])(i,t,this.props.animationModel.projectRoot,this.props.animationModel.uri)},eventInput:function(e,t){var i=this.onPropertyChange.bind(this,e);return(0,m["default"])(i,t,this.props.animationModel.projectRoot,this.props.animationModel.uri)},audioInput:function(e,t){var i=this;return(0,y["default"])(function(t){i.onPropertyChange(e,t),i.props.animationModel.editor.focus()},t,this.props.animationModel.projectRoot)},enumInput:function(e,t,i,a,o){var r=this;return n["default"].createElement("div",{style:{"float":"right",marginRight:5}},n["default"].createElement(b["default"],{key:k++,data:i,init:t?t:o,onSelected:function(t){r.onPropertyChange(e,t),r.props.animationModel.editor.focus()}}))},renderProperties:function(){var e=this,t=this.props.animationModel.getKeyframeInfo(),i=this.props.animationModel.getSelectedLayer(),o=t.layerTypes[i.type].getInfo(),r=[],s=1;for(var l in o.properties){var d=o.properties[l].type,u=this.props.animationModel.state.overrides[i.id][l],c=1;u&&(c=Object.keys(u).length?Object.keys(u).length:1);var h=o.properties[l].defaultValue;if("string"==typeof d)try{r.push(n["default"].createElement("h3",{style:{paddingTop:7,marginBottom:7,marginRight:4,clear:"both",textAlign:"right"}},l)),r.push(this[d+"Input"](l,u,s,h))}catch(f){}else"object"===("undefined"==typeof d?"undefined":a(d))&&"enum"===d.name&&(r.push(n["default"].createElement("h3",{style:{paddingTop:7,marginBottom:7,marginRight:4,clear:"both",textAlign:"right"}},l)),r.push(this.enumInput(l,u,d.values,s,h)));s+=c}r.push(n["default"].createElement("div",{style:{clear:"both"}})),r.push(n["default"].createElement("div",{style:{"float":"right",marginTop:7},className:"btn",onClick:function(){var t={};for(var i in o.properties)t[i]=o.properties[i].defaultValue;e.props.animationModel.updateSelectedLayerProperties(t),e.props.animationModel.addRedoUndoEntry()}},"Reset All")),r.push(n["default"].createElement("div",{style:{clear:"both"}}));var p=[],m=this.props.animationModel.limits.exceedsVelLimit,v=this.props.animationModel.limits.exceedsAccelLimit;if((m||v)&&"Body"===o.layerType){m?p.push("velocity"):"",v?p.push("acceleration"):"";var y=p.join(" and ");r.push(n["default"].createElement("p",{className:"text-warning",style:{marginTop:7,whiteSpace:"normal",color:"#A83131"}},"Warning: an animation you have created exceeds Jibo's internal motor ",y," limits. Your animation may appear slower on Jibo than in the simulator, or you may hurt Jibo using this animation."))}return r},render:function(){var e={properties:{},panel:{minHeight:this.props.paneHeight-60}},t=this.props.animationModel.getSelectedLayer(),i=void 0;return null===t||t.locked||!t.visible||this.props.animationModel.keyframeSelection.isMultiSelect()?i=n["default"].createElement("div",{style:{height:200}}):(i=[n["default"].createElement("h2",{style:{textAlign:"right"}},t.name)],i=i.concat(this.renderProperties())),n["default"].createElement("div",{style:e.properties,className:"animation-editor-properties native-key-bindings"},n["default"].createElement("atom-panel",{className:"top native-key-bindings"},n["default"].createElement("div",{className:"padded native-key-bindings"},n["default"].createElement("div",{style:e.panel,className:"inset-panel native-key-bindings"},n["default"].createElement("div",{className:"panel-heading native-key-bindings"},"Properties"),n["default"].createElement("div",{className:"panel-body padded native-key-bindings"},i)))))}});exports["default"]=M},{"../../atom-react/components/float-input-view":48,"../../atom-react/components/jibo-combo-box":51,"./properties/audio-input":24,"./properties/event-input":33,"./properties/rgb-input":34,"./properties/texture-input":35,"./properties/video-input":36,react:void 0}],24:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("fs"),r=i(n),s=e("path"),l=i(s),d=e("normalize-path"),u=i(d),c=e("../../../common/modals/choose-audio-modal"),h=i(c),f=e("../../../atom-react/mixins/modal-mixin"),p=i(f),m=e("atom"),v=o["default"].createClass({displayName:"AudioInput",mixins:[p["default"]],getInitialState:function(){var e={file:this.props.content.file};return e},componentWillReceiveProps:function(e){e.content.file!==this.state.file&&(this.setState({file:e.content.file}),this.refs.audioEditor.getDOMNode().getModel().setText(e.content.file))},getRoot:function(){return l["default"].resolve(this.props.projectRoot,"audio")},getUri:function(){var e=this.state.file.split("://");if(1===e.length){var t=l["default"].resolve(this.props.projectRoot,"audio",this.state.file);return t}if(2===e.length){var i=l["default"].resolve(this.props.projectRoot,"node_modules",e[0],"audio",e[1]);return i}},render:function(){var e={};try{r["default"].statSync(this.getUri())}catch(t){e={disabled:!0}}var i=e.disabled?o["default"].createElement("div",{className:"error-messages"},"No audio file by that name"):null;return o["default"].createElement("div",{style:{width:"100%"}},o["default"].createElement("div",{className:"block"},o["default"].createElement("div",{className:"fileBlock"},o["default"].createElement("button",{ref:"chooseAudio",style:{"float":"right"},className:"btn",onClick:this.onChoose},"..."),o["default"].createElement("atom-text-editor",{ref:"audioEditor",mini:!0},this.state.file)),i,o["default"].createElement("br",null)))},onChoose:function(){var e=this;this.createModal(o["default"].createElement(h["default"],{root:this.getRoot(),uri:this.getUri(),onChoose:function(t){t=(0,u["default"])(t);var i=o["default"].findDOMNode(e.refs.audioEditor);i.getModel().setText(t),e.setState({file:t}),e.props.onChange({file:t})},onClose:function(){e.destroyModal()}}))},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.audioEditor),i=t.getModel();i.onDidChange(function(){e.setState({file:i.getText()})}),this.disposable=atom.commands.add(t,"core:confirm",function(){e.props.onChange({file:e.state.file})}),this.subs=new m.CompositeDisposable,this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.chooseAudio),{title:"Choose Audio"})),this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.audioEditor),{title:"Current Audio"}))},componentWillUnmount:function(){this.disposable&&this.disposable.dispose(),this.subs.dispose()}});exports["default"]=function(e,t,i){return o["default"].createElement(v,{onChange:e,content:t,projectRoot:i})}},{"../../../atom-react/mixins/modal-mixin":55,"../../../common/modals/choose-audio-modal":102,atom:void 0,
fs:void 0,"normalize-path":void 0,path:void 0,react:void 0}],25:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("region"),r=i(n),s=e("./utils/common"),l=i(s),d=e("./utils/validate"),u=i(d),c=e("./defaultColor"),h=i(c),f=e("./utils/toStringValue"),p=i(f),m=e("atom");exports["default"]=o["default"].createClass(Object.assign({displayName:"HueSpectrum",getDefaultProps:function(){return{height:300,width:30,pointerSize:3,defaultColor:h["default"]}},getInitialState:function(){return{h:0}},componentDidUpdate:function(){},componentDidMount:function(){this.updateDragPositionIf(),this.subs=new m.CompositeDisposable,this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.huePicker),{title:"Hue Picker"}))},componentWillUnmount:function(){this.subs.dispose()},updateDragPositionIf:function(){this.props.height||this.setState({})},render:function(){this.hsv=this.toColorValue(this.state.value||this.props.value||this.props.defaultValue||this.props.defaultColor),360!=this.state.h||this.hsv.h||(this.hsv.h=360);var e=Object.assign({},this.props.style);this.props.height&&(e.height=this.props.height),this.props.width&&(e.width=this.props.width);var t={height:this.props.pointerSize},i=this.getDragPosition();return null!=i&&(t.top=i,t.display="block"),o["default"].createElement("div",{ref:"huePicker",className:"cp-hue-spectrum",style:e,onMouseDown:this.onMouseDown},o["default"].createElement("div",{className:"cp-hue-drag",style:t},o["default"].createElement("div",{className:"inner"})))},getDragPosition:function(e){if(e=e||this.hsv,!this.props.height&&!this.isMounted())return null;var t=this.props.height||r["default"].fromDOM(this.getDOMNode()).getHeight(),i=this.props.pointerSize,a=Math.round(e.h*t/360),o=Math.round(i/2);return a-o},updateColor:function(e){e=(0,u["default"])(e),this.hsv.h=360*e.y/e.height,0!=this.hsv.h&&(this.state.h=this.hsv.h),this.state.h=0!=this.hsv.h?this.hsv.h:0},toStringValue:p["default"]},l["default"]))},{"./defaultColor":27,"./utils/common":30,"./utils/toStringValue":31,"./utils/validate":32,atom:void 0,react:void 0,region:void 0}],26:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("region"),r=i(n),s=e("./utils/color"),l=i(s),d=e("./utils/common"),u=i(d),c=e("./utils/validate"),h=i(c),f=e("./defaultColor"),p=i(f),m=e("./utils/toStringValue"),v=i(m),y=e("atom"),g=l["default"].fromRatio;exports["default"]=o["default"].createClass(Object.assign({displayName:"SaturationSpectrum",getDefaultProps:function(){return{height:300,width:300,pointerSize:7,defaultColor:p["default"]}},getInitialState:function(){return{pointerTop:null,pointerLeft:null}},componentDidUpdate:function(){},componentDidMount:function(){this.updateDragPositionIf(),this.subs=new y.CompositeDisposable,this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.saturationPicker),{title:"Saturation Picker"}))},componentWillUnmount:function(){this.subs.dispose()},updateDragPositionIf:function(){this.props.height&&this.props.width||this.setState({})},getDragPosition:function(e){e=e||this.hsv;var t=this.props.width,i=this.props.height,a=t&&i;if(!a&&!this.isMounted())return null;var o;a||(o=r["default"].fromDOM(this.getDOMNode()),i=i||o.getHeight(),t=t||o.getWidth());var n=e.s*t,s=i-e.v*i,l=this.props.pointerSize,d=Math.floor(l/2);return this.props.value&&this.state.mouseDown,{left:n-d,top:s-d}},prepareBackgroundColor:function(e){var t=e,i=g({h:t.h%360/360,s:1,v:1});return i.toRgbString()},prepareProps:function(e,t){var i=Object.assign({},e),a=t.value||i.value||i.defaultValue||i.defaultColor;return i.color=a,this.hsv=this.toColorValue(a),i.style=this.prepareStyle(i),i.className=this.prepareClassName(i),i},prepareClassName:function(e){var t=e.className||"";return t+=" cp-saturation-spectrum"},prepareStyle:function(e){var t=e.style||{};return e.height&&(t.height=e.height),e.width&&(t.width=e.width),t.backgroundColor=this.prepareBackgroundColor(this.hsv),t},render:function(){var e=this.p=this.prepareProps(this.props,this.state),t={width:this.props.pointerSize,height:this.props.pointerSize},i=this.getDragPosition();return i&&(t.top=i.top,t.left=i.left,t.display="block"),o["default"].createElement("div",{ref:"saturationPicker",className:e.className,style:e.style,onMouseDown:this.onMouseDown},o["default"].createElement("div",{className:"cp-saturation-white"},o["default"].createElement("div",{className:"cp-saturation-black"})),o["default"].createElement("div",{className:"cp-saturation-drag",style:t},o["default"].createElement("div",{className:"inner"})))},getSaturationForPoint:function(e){return e.x/e.width},getColorValueForPoint:function(e){return(e.height-e.y)/e.height},updateColor:function(e){e=(0,h["default"])(e),this.hsv.s=this.getSaturationForPoint(e),this.hsv.v=this.getColorValueForPoint(e)},toStringValue:v["default"]},u["default"]))},{"./defaultColor":27,"./utils/color":29,"./utils/common":30,"./utils/toStringValue":31,"./utils/validate":32,atom:void 0,react:void 0,region:void 0}],27:[function(e,t,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]="red"},{}],28:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(){}Object.defineProperty(exports,"__esModule",{value:!0});var o=e("react"),n=i(o),r=e("./utils/color"),s=i(r),l=e("./HueSpectrum"),d=i(l),u=e("./SaturationSpectrum"),c=i(u),h=e("./defaultColor"),f=i(h),p=e("./utils/toStringValue"),m=i(p),v=s["default"].toHsv,y=n["default"].createClass({displayName:"ColorPicker",getDefaultProps:function(){return{defaultColor:f["default"],saturationWidth:300,saturationHeight:300,hueHeight:null,hueWidth:30,hueMargin:10}},getInitialState:function(){return{value:this.props.defaultValue}},prepareClassName:function(e){var t=e.className||"";return t+=" cp"},prepareProps:function(e){return e.className=this.prepareClassName(e),e},render:function(){var e=this.prepareProps(Object.assign({},this.props)),t=this.props.hueStyle||{};t.marginLeft=this.props.hueMargin;var i=e.value?this.toColorValue(this.props.value):null,a=i?null:this.toColorValue(this.state.value||e.defaultValue||e.defaultColor),o={onDrag:this.handleSaturationDrag,onChange:this.handleSaturationChange,onMouseDown:this.handleSaturationMouseDown,height:e.saturationHeight,width:e.saturationWidth,inPicker:!0},r={onDrag:this.handleHueDrag,onChange:this.handleHueChange,height:e.hueHeight||e.saturationHeight,width:e.hueWidth,inPicker:!0,style:t};return this.state.dragHue&&((i||a).h=this.state.dragHue),i?(o.value=Object.assign({},i),r.value=Object.assign({},i)):(o.defaultValue=Object.assign({},a),r.defaultValue=Object.assign({},a)),n["default"].createElement("div",e,n["default"].createElement(c["default"],o),n["default"].createElement(d["default"],r))},toColorValue:function(e){return"string"==typeof e?v(e):e},toStringValue:m["default"],handleChange:function(e){this.state.dragHue=null,e=Object.assign({},e);var t=this.toStringValue(e);(this.props.onChange||a)(t,e)},handleSaturationChange:function(e){this.handleChange(e)},handleHueChange:function(e){this.handleChange(e)},handleHueDrag:function(e){this.handleDrag(e)},handleSaturationDrag:function(e){this.handleDrag(e)},handleDrag:function(e){this.props.value||this.setState({value:e}),(this.props.onDrag||a)(this.toStringValue(e),e)},handleSaturationMouseDown:function(e){this.setState({dragHue:e.h})}});y.HueSpectrum=d["default"],y.SaturationSpectrum=c["default"],exports["default"]=y},{"./HueSpectrum":25,"./SaturationSpectrum":26,"./defaultColor":27,"./utils/color":29,"./utils/toStringValue":31,react:void 0}],29:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e){return(0,d["default"])(e)}function o(e){var t=a(e).toHsl().h;return a({h:t,s:100,l:50,a:1})}function n(e){return d["default"].fromRatio(e)}function r(e,t){return t>1&&(t/=100),e=a(e).toRgb(),e.a=t,a(e)}function s(e){return a(e).toHsv()}Object.defineProperty(exports,"__esModule",{value:!0});var l=e("tinycolor2"),d=i(l);"undefined"!=typeof window&&(window.tinycolor=d["default"]);var u={toColor:a,toPure:o,fromRatio:n,toAlpha:r,toHsv:s};"undefined"!=typeof window&&(window.color=u),exports["default"]=u},{tinycolor2:void 0}],30:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(){}Object.defineProperty(exports,"__esModule",{value:!0});var o=e("region"),n=i(o),r=e("drag-helper"),s=i(r),l=e("./color");exports["default"]={toColorValue:function(e){return"string"==typeof e?(0,l.toHsv)(e):{h:e.h,s:e.s,v:e.v,a:e.a}},onMouseDown:function(e){e.preventDefault();var t=n["default"].fromDOM(this.getDOMNode()),i=this.getEventInfo(e,t);(0,s["default"])(e,{scope:this,constrainTo:t,onDragStart:function(e,a){a.initialPoint=i,a.minLeft=0,a.maxLeft=t.width,this.handleDragStart(e)},onDrag:function(e,i){var a=this.getEventInfo(e,t);this.updateColor(a),this.handleDrag(e,i)},onDrop:function(e,i){var a=this.getEventInfo(e,t);this.updateColor(a),this.handleDrop(e,i)}}),this.updateColor(i),this.handleMouseDown(e,{initialPoint:i})},handleMouseDown:function(e,t){(this.props.onMouseDown||a).apply(this,this.getColors()),this.handleDrag(e,t)},handleUpdate:function(e,t){var i=t.diff||{top:0,left:0},a=t.initialPoint;if(a){var o,n;n=a.x+i.left,o=a.y+i.top,n=Math.max(n,t.minLeft),n=Math.min(n,t.maxLeft),this.state.top=o,this.state.left=n,this.state.mouseDown={x:n,y:o,width:a.width,height:a.height}}this.props.inPicker||this.props.value||this.setState({value:this.hsv})},handleDragStart:function(){},handleDrag:function(e,t){this.handleUpdate(e,t),(this.props.onDrag||a).apply(this,this.getColors())},handleDrop:function(e,t){this.handleUpdate(e,t),this.state.mouseDown=!1,(this.props.onChange||a).apply(this,this.getColors())},getColors:function(){var e=this.props.inPicker?this.hsv:this.toStringValue(this.hsv),t=[e];return this.props.inPicker||t.push(Object.assign({},this.hsv)),t},getEventInfo:function(e,t){t=t||n["default"].fromDOM(this.getDOMNode());var i=e.clientX-t.left,a=e.clientY-t.top;return{x:i,y:a,width:t.getWidth(),height:t.getHeight()}}}},{"./color":29,"drag-helper":void 0,region:void 0}],31:[function(e,t,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var i=e("tinycolor2");exports["default"]=function(e){return e=i(Object.assign({},e)),1==e.toRgb().a?e.toHexString():e.toRgbString()}},{tinycolor2:void 0}],32:[function(e,t,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=function(e){var t=e.height,i=e.width;return e.x<0&&(e.x=0),e.x>=i&&(e.x=i),e.y<0&&(e.y=0),e.y>=t&&(e.y=t),e}},{}],33:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("atom"),r=o["default"].createClass({displayName:"EventInput",getInitialState:function(){for(var e={name:this.props.content.name,payload:this.props.content.payload},t=atom.grammars.getGrammars(),i=0;i<t.length;i++){var a=t[i];if("JSON"===a.name){e.jsonGrammar=a;break}}return e},componentWillReceiveProps:function(e){(e.content.name!==this.state.name||e.content.payload!==this.state.payload)&&(this.setState({payload:e.content.payload,name:e.content.name}),this.refs.payloadEditor.getDOMNode().getModel().setText(e.content.payload),this.refs.nameEditor.getDOMNode().getModel().setText(e.content.name))},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.payloadEditor),i=t.getModel();void 0!==this.state.jsonGrammar&&i.setGrammar(this.state.jsonGrammar);var a=o["default"].findDOMNode(this.refs.nameEditor),r=a.getModel();i.onDidChange(function(){e.setState({payload:i.getText()}),e.props.onChange({name:r.getText(),payload:i.getText()})}),r.onDidChange(function(){e.setState({name:r.getText()}),e.props.onChange({name:r.getText(),payload:i.getText()})}),this.subs=new n.CompositeDisposable,this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.nameEditor),{title:"Event Name"})),this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.payloadEditor),{title:"Event Payload"}))},componentWillUnmount:function(){this.subs.dispose()},render:function(){var e="";if(this.state.payload.length>0)try{JSON.parse(this.state.payload)}catch(t){e="Not valid JSON:\n"+t}return o["default"].createElement("div",{className:"event-editor",style:{width:"100%"}},o["default"].createElement("div",{style:{display:"flex",clear:"both",marginTop:15,marginBottom:15}},o["default"].createElement("div",{style:{fontSize:14,marginRight:15}},"Name"),o["default"].createElement("atom-text-editor",{mini:!0,ref:"nameEditor",style:{width:"100%"}},this.state.name)),o["default"].createElement("div",{style:{fontSize:14,marginRight:15,marginBottom:5}},"Payload"),o["default"].createElement("atom-text-editor",{ref:"payloadEditor",style:{height:250,width:"100%"}},this.state.payload),o["default"].createElement("div",{className:"error-messages"},e))}});exports["default"]=function(e,t){return o["default"].createElement(r,{onChange:e,content:t})}},{atom:void 0,react:void 0}],34:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("../../../atom-react/components/float-input-view"),r=i(n),s=e("./color-picker/index"),l=i(s),d=e("color-space"),u=e("color-string"),c=i(u),h=e("atom"),f=o["default"].createClass({displayName:"RGBInput",getInitialState:function(){var e=[Math.floor(this.props.value.r),Math.floor(this.props.value.g),Math.floor(this.props.value.b)];return{color:c["default"].hexString(e),value:this.props.value}},updateFromDrag:function(e,t){var i=d.hsv.rgb([Math.round(t.h),Math.round(100*t.s),Math.round(100*t.v)]),a={r:Math.round(i[0]),g:Math.round(i[1]),b:Math.round(i[2])},o={};o[this.props.propName]=a,this.props.animationModel.updateSelectedLayerProperties(o)},updateFromHexString:function(e){var t=c["default"].getRgb(e);if(t){var i={};i[this.props.propName]={r:t[0],g:t[1],b:t[2]},this.props.animationModel.updateSelectedLayerProperties(i)}else{var a=o["default"].findDOMNode(this.refs.editor);a.getModel().setText(this.state.color)}},updateFromHsv:function(e){var t=d.hsv.rgb(e),i={r:Math.round(t[0]),g:Math.round(t[1]),b:Math.round(t[2])},a={};a[this.props.propName]=i,this.props.animationModel.updateSelectedLayerProperties(a)},_hsvFromState:function(){var e=d.rgb.hsv([this.state.value.r,this.state.value.g,this.state.value.b]);return e},_clamp:function(e){return e},onRChange:function(e){var t={};t[this.props.propName]={r:this._clamp(e,0,255),g:this.state.g,b:this.state.b},this.props.animationModel.updateSelectedLayerProperties(t)},onGChange:function(e){var t={};t[this.props.propName]={r:this.state.r,g:this._clamp(e,0,255),b:this.state.b},this.props.animationModel.updateSelectedLayerProperties(t)},onBChange:function(e){var t={};t[this.props.propName]={r:this.state.r,g:this.state.g,b:this._clamp(e,0,255)},this.props.animationModel.updateSelectedLayerProperties(t)},onHChange:function(e){var t=this._hsvFromState();t[0]=this._clamp(Math.round(e),0,360),this.updateFromHsv(t)},onSChange:function(e){var t=this._hsvFromState();t[1]=this._clamp(Math.round(e),0,100),this.updateFromHsv(t)},onVChange:function(e){var t=this._hsvFromState();t[2]=this._clamp(Math.round(e),0,100),this.updateFromHsv(t)},componentWillReceiveProps:function(e){var t=[Math.round(e.value.r),Math.round(e.value.g),Math.round(e.value.b)],i=c["default"].hexString(t),a=o["default"].findDOMNode(this.refs.editor);a.getModel().setText(i),this.setState({color:i,value:{r:t[0],g:t[1],b:t[2]}})},componentWillUnmount:function(){this.disposable.dispose(),this.subs.dispose()},componentDidMount:function(){var e=o["default"].findDOMNode(this.refs.editor);this.disposable=atom.commands.add(e,"core:confirm",function(){e.blur()}),this.subs=new h.CompositeDisposable,this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.reset),{title:"Reset Color"})),this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.editor),{title:"RGB Color"})),this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.rgb),{title:"RGB Color"})),this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.hsv),{title:"HSV Color"}))},onRgbConfirm:function(){var e=o["default"].findDOMNode(this.refs.editor),t=e.getModel().getText();this.updateFromHexString(t)},render:function(){var e=this,t=this.props.animationModel.getKeyframeInfo(),i=this.props.animationModel.getSelectedLayer(),a=t.layerTypes[i.type].getInfo(),n=this.props.tabIndex,s=this._hsvFromState();return o["default"].createElement("div",{className:"hsv-input",style:{"float":"right"}},o["default"].createElement(l["default"],{saturationWidth:150,saturationHeight:150,value:this.state.color,width:150,onDrag:this.updateFromDrag}),o["default"].createElement("div",{style:{display:"flex","float":"right",clear:"both",marginTop:15}},o["default"].createElement("div",{style:{fontSize:14,margin:2}},"rgb"),o["default"].createElement("atom-text-editor",{mini:!0,ref:"editor",onBlur:this.onRgbConfirm,style:{width:150,"float":"left"}},this.state.color)),o["default"].createElement("div",{style:{display:"flex","float":"right",clear:"both",marginTop:15}},o["default"].createElement("div",{ref:"reset",className:"btn",style:{marginRight:5},onClick:function(){var t={};for(var i in a.properties)t[i]=a.properties[i].defaultValue;e.props.animationModel.updateSelectedLayerProperties(t),e.props.animationModel.addRedoUndoEntry()}},o["default"].createElement("i",{className:"fa fa-refresh"})),o["default"].createElement("div",{style:{"float":"left"}},[o["default"].createElement("div",{ref:"rgb"},o["default"].createElement("div",{style:{display:"flex"}},o["default"].createElement("div",{style:{fontSize:14,margin:2,width:10}},"r"),o["default"].createElement(r["default"],{step:1,style:{clear:"both",maxWidth:150},onChange:this.onRChange,value:this.state.value.r,precision:0,tabIndex:n})),o["default"].createElement("div",{style:{display:"flex"}},o["default"].createElement("div",{style:{fontSize:14,margin:2,width:10}},"g"),o["default"].createElement(r["default"],{step:1,style:{clear:"both",maxWidth:150},onChange:this.onGChange,value:this.state.value.g,precision:0,tabIndex:n+1})),o["default"].createElement("div",{style:{display:"flex"}},o["default"].createElement("div",{style:{fontSize:14,margin:2,width:10}},"b"),o["default"].createElement(r["default"],{step:1,style:{clear:"both",maxWidth:150},onChange:this.onBChange,value:this.state.value.b,precision:0,tabIndex:n+2}))),o["default"].createElement("div",{style:{height:10}}),o["default"].createElement("div",{ref:"hsv"},o["default"].createElement("div",{style:{display:"flex"}},o["default"].createElement("div",{style:{fontSize:14,margin:2,width:10}},"h"),o["default"].createElement(r["default"],{step:1,style:{clear:"both",maxWidth:150},onChange:this.onHChange,value:s[0],precision:0,tabIndex:n+3})),o["default"].createElement("div",{style:{display:"flex"}},o["default"].createElement("div",{style:{fontSize:14,margin:2,width:10}},"s"),o["default"].createElement(r["default"],{step:1,style:{clear:"both",maxWidth:150},onChange:this.onSChange,value:s[1],precision:0,tabIndex:n+4})),o["default"].createElement("div",{style:{display:"flex"}},o["default"].createElement("div",{style:{fontSize:14,margin:2,width:10}},"v"),o["default"].createElement(r["default"],{step:1,style:{clear:"both",maxWidth:150},onChange:this.onVChange,value:s[2],precision:0,tabIndex:n+5})))])))}});exports["default"]=function(e,t,i,a,n){return o["default"].createElement(f,{propName:e,value:t,tabIndex:i,defaultValue:a,animationModel:n})}},{"../../../atom-react/components/float-input-view":48,"./color-picker/index":28,atom:void 0,"color-space":void 0,"color-string":void 0,react:void 0}],35:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("../../../atom-react/mixins/modal-mixin"),r=i(n),s=e("path"),l=i(s),d=e("fs"),u=i(d),c=e("../modals/choose-texture-modal"),h=i(c),f=e("normalize-path"),p=i(f),m=e("atom"),v=o["default"].createClass({displayName:"TextureInput",mixins:[r["default"]],getInitialState:function(){var e=this.getDisplayValue(this.props.content);return{content:this.props.content,displayValue:e}},componentWillReceiveProps:function(e){var t=e.content,i=this.getDisplayValue(t);this.setState({content:t,displayValue:i}),this.refs.editor.getDOMNode().getModel().setText(i)},render:function(){var e={};try{u["default"].statSync(this.getUri())}catch(t){e={disabled:!0}}var i=e.disabled?o["default"].createElement("div",{className:"error-messages"},"No texture file by that name"):null;return o["default"].createElement("div",{style:{width:"100%"}},o["default"].createElement("div",{className:"block"},o["default"].createElement("div",{className:"fileBlock"},o["default"].createElement("button",{ref:"chooseTexture",style:{"float":"right"},className:"btn",onClick:this.onChoose},"..."),o["default"].createElement("atom-text-editor",{onBlur:this.onBlur,ref:"editor",mini:!0},this.state.displayValue)),i,o["default"].createElement("br",null)))},getUri:function(){return l["default"].resolve(this.props.projectRoot,this.state.content)},getDisplayValue:function(e){var t=e.split("/");if("node_modules"===t[0]){var i=t[1],a=l["default"].join("node_modules",i,"animations","textures");return a=(0,p["default"])(l["default"].relative(a,e)),i+"://"+a}var o=l["default"].join("animations","textures");return o=l["default"].relative(o,e),(0,p["default"])(o)},getDataValue:function(e){var t=e.split("://");if(1===t.length){var i=l["default"].join("animations","textures",e);return(0,p["default"])(i)}if(2===t.length){var a=l["default"].join("node_modules",t[0],"animations","textures",t[1]);return(0,p["default"])(a)}return""},onChoose:function(){var e=this;this.createModal(o["default"].createElement(h["default"],{root:this.props.projectRoot,uri:this.getUri(),onChoose:function(t){var i=(0,p["default"])(t),a=e.getDisplayValue(i);e.setState({content:i,displayValue:a}),e.props.onChange(i),document.querySelector("atom-pane.pane.active .animation-editor").childNodes[0].focus()},onClose:function(){e.destroyModal()}}))},onBlur:function(){this.props.onChange(this.state.content),document.querySelector("atom-pane.pane.active .animation-editor").childNodes[0].focus()},componentWillUnmount:function(){this.disposable.dispose(),this.subs.dispose()},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor),i=t.getModel();i.onDidChange(function(){e.setState({content:e.getDataValue(i.getText()),displayValue:i.getText()})}),this.disposable=atom.commands.add(t,"core:confirm",function(){e.props.onChange(e.state.content),document.querySelector("atom-pane.pane.active .animation-editor").childNodes[0].focus()}),this.subs=new m.CompositeDisposable,this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.chooseTexture),{title:"Change Texture"})),this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.editor),{title:"Current Texture"}))}});exports["default"]=function(e,t,i,a){return o["default"].createElement(v,{key:100,content:t,onChange:e,projectRoot:i,animationPath:a})}},{"../../../atom-react/mixins/modal-mixin":55,"../modals/choose-texture-modal":21,atom:void 0,fs:void 0,"normalize-path":void 0,path:void 0,react:void 0}],36:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("../../../atom-react/mixins/modal-mixin"),r=i(n),s=e("path"),l=i(s),d=e("fs"),u=i(d),c=e("normalize-path"),h=i(c),f=e("../../../common/directory-tree-view"),p=i(f),m=o["default"].createClass({displayName:"VideoChooserModal",getInitialState:function(){return{uri:this.props.uri,filter:""}},onSelected:function(e){this.state.uri=(0,h["default"])(e),this.setState(this.state)},onChosen:function(e){this.state.uri=(0,h["default"])(e),this.onChoose()},onChoose:function(){this.props.onChoose(this.state.uri),this.props.onClose()},render:function(){return o["default"].createElement("div",{className:"block"},o["default"].createElement("div",{className:"panel-heading"},o["default"].createElement("h1",{style:{textAlign:"center"}},"Choose a Video")),o["default"].createElement("label",{style:{marginLeft:10}},"Search"),o["default"].createElement("atom-text-editor",{ref:"editor",style:{marginLeft:10,marginRight:10,marginBottom:10},mini:!0}),o["default"].createElement("div",null,o["default"].createElement("div",{className:"inline-block",style:{height:600,overflowY:"auto",overflowX:"hidden"}},o["default"].createElement(p["default"],{uri:this.props.root,onChosen:this.onChosen,onSelected:this.onSelected,extension:[".m4v",".mp4",".mov"],filter:this.state.filter}))),o["default"].createElement("hr",null),o["default"].createElement("div",{className:"btn-group"},o["default"].createElement("button",{className:"btn",onClick:this.onChoose},"Choose"),o["default"].createElement("button",{className:"btn",onClick:this.props.onClose},"Close")))},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor),i=t.getModel();i.onDidChange(function(){e.state.filter=i.getText(),e.setState(e.state)}),this.onSelected(this.props.uri)},componentWillUnmount:function(){}}),v=o["default"].createClass({displayName:"VideoInput",mixins:[r["default"]],getInitialState:function(){return{content:this.props.content}},componentWillReceiveProps:function(e){this.setState({content:e.content}),this.refs.editor.getDOMNode().getModel().setText(e.content)},render:function(){var e={};try{u["default"].statSync(this.getUri())}catch(t){e={disabled:!0}}var i=e.disabled?o["default"].createElement("div",{className:"error-messages"},"No video file by that name"):null;return o["default"].createElement("div",{style:{width:"100%"}},o["default"].createElement("div",{className:"block"},o["default"].createElement("div",{className:"fileBlock"},o["default"].createElement("button",{style:{"float":"right"},className:"btn",onClick:this.onChoose},"..."),o["default"].createElement("atom-text-editor",{onBlur:this.onBlur,ref:"editor",mini:!0},this.state.content)),i,o["default"].createElement("br",null)))},getUri:function(){var e=l["default"].resolve(this.props.projectRoot,this.state.content);return e},onChoose:function(){var e=this;this.createModal(o["default"].createElement(m,{root:this.props.projectRoot,uri:this.getUri(),onChoose:function(t){var i=l["default"].relative(e.props.projectRoot,t);e.state.content=(0,h["default"])(i);var a=o["default"].findDOMNode(e.refs.editor);a.getModel().setText(e.state.content),e.setState(e.state),e.props.onChange(e.state.content)},onClose:function(){e.destroyModal()}}))},onBlur:function(){this.props.onChange(this.state.content)},componentWillUnmount:function(){this.disposable.dispose()},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor),i=t.getModel();i.onDidChange(function(){e.setState({content:i.getText()})}),this.disposable=atom.commands.add(t,"core:confirm",function(){e.props.onChange(e.state.content)})}});exports["default"]=function(e,t,i,a){return o["default"].createElement(v,{key:100,content:t,onChange:e,projectRoot:i,animationPath:a})}},{"../../../atom-react/mixins/modal-mixin":55,"../../../common/directory-tree-view":93,fs:void 0,"normalize-path":void 0,path:void 0,react:void 0}],37:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=o["default"].createClass({displayName:"SettingsItem",onFocus:function(){this.getDOMNode().childNodes[2].select()},render:function(){return o["default"].createElement("div",null,o["default"].createElement("label",null,this.props.label),o["default"].createElement("br",null),o["default"].createElement("input",{ref:"input",style:{width:122},onFocus:this.onFocus,className:"native-key-bindings",tabIndex:this.props.tabIndex,type:this.props.type,step:this.props.step,onMouseDown:this.props.onMouseDown,onChange:this.props.onChange,value:this.props.value,min:this.props.min}))}});exports["default"]=n},{react:void 0}],38:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("./settings-item"),r=i(n),s=e("atom"),l=o["default"].createClass({displayName:"SettingsView",getInitialState:function(){return{duration:this.props.animationModel.state.keyframes.duration,scale:this.props.animationModel.state.keyframes.scale,lastScale:this.props.animationModel.state.keyframes.scale}},componentDidMount:function(){var e=this;this.getDOMNode().childNodes[1].childNodes[0].childNodes[2].focus(),this.disposables=new s.CompositeDisposable,this.disposables.add(atom.commands.add(this.getDOMNode().childNodes[1].childNodes[1],{"jibo-sdk:confirm":function(){e.onFinished()}}))},componentWillUnmount:function(){this.disposables.dispose()},onFinished:function(){if(this.state.duration!==this.props.animationModel.state.keyframes.duration)this.props.animationModel.setDuration(this.state.duration,!0,!0),this.props.animationModel.addRedoUndoEntry(),this.props.onFinished();else if(this.state.scale!==this.props.animationModel.state.keyframes.scale){if(0==this.state.scale)return this.setState({scale:this.state.lastScale}),void this.props.onFinished();this.setState({lastScale:this.state.scale}),this.props.animationModel.setScale(this.state.scale),this.props.animationModel.setDuration(this.state.duration,!1,!0),this.props.animationModel.setKeyframes(),this.props.animationModel.addRedoUndoEntry(),this.props.onFinished()}else this.props.onFinished()},onDurationChange:function(e){if(/^\d+$/.test(e.target.value)){var t=parseInt(e.target.value);this.setState({duration:t})}},onScaleChange:function(e){var t=e.target.value;this.setState({scale:t})},onMouseDown:function(){if(this.state.duration!==this.props.animationModel.state.keyframes.duration)this.props.animationModel.setDuration(this.state.duration,!0,!0),this.props.animationModel.addRedoUndoEntry();else if(this.state.scale!==this.props.animationModel.state.keyframes.scale){if(0==this.state.scale)return void this.setState({scale:this.state.lastScale});this.setState({lastScale:this.state.scale}),this.props.animationModel.setScale(this.state.scale);var e=this.props.animationModel.setDuration(this.state.duration,!1,!0);this.props.animationModel.setKeyframes(),this.props.animationModel.addRedoUndoEntry(),this.setState({duration:e})}},onKeyPress:function(e){13===e.keyCode?this.onFinished():27===e.keyCode&&this.props.onFinished()},render:function(){var e=o["default"].createElement(r["default"],{label:"Animation Duration",type:"number",step:"0.01",tabIndex:1,onMouseDown:this.onMouseDown,onChange:this.onDurationChange,value:this.state.duration,min:1}),t=o["default"].createElement(r["default"],{label:"Scale",type:"number",step:"0.01",tabIndex:2,onMouseDown:this.onMouseDown,onChange:this.onScaleChange,value:this.state.scale,min:0});return o["default"].createElement("div",{className:"animation-settings native-key-bindings"},o["default"].createElement("div",{onMouseDown:this.onFinished,className:"settings-mousetrap"}),o["default"].createElement("div",{className:"settings-container",onKeyUp:this.onKeyPress,style:{height:"auto"}},e,t))}});exports["default"]=l},{"./settings-item":37,atom:void 0,react:void 0}],39:[function(e,t,exports){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,
"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),o=e("animation-utilities"),n=function(){function e(t){i(this,e),this.scene=t,this.debugObjects={}}return a(e,[{key:"removeIfExists",value:function(e){this.debugObjects[e]&&(this.scene.remove(this.debugObjects[e]),delete this.debugObjects[e])}},{key:"addByName",value:function(e,t){this.removeIfExists(e),this.debugObjects[e]=t,this.scene.add(t)}},{key:"coerceIfMatrix",value:function(e){return e instanceof o.THREE.Matrix4?(new o.THREE.Vector3).setFromMatrixPosition(e):e.clone()}},{key:"info",value:function(e,t){t=t||"",console.log(t+" name: "+e.name+" ( "+e.position.x+", "+e.position.y+", "+e.position.z+" )");for(var i=0;i<e.children.length;i++)this.info(e.children[i],t+"    ")}},{key:"cube",value:function(e,t,i,a){var n=new o.THREE.BoxGeometry(i,i,i),r=new o.THREE.MeshBasicMaterial({color:a}),s=new o.THREE.Mesh(n,r),l=this.coerceIfMatrix(t);s.position.x=l.x,s.position.y=l.y,s.position.z=l.z,this.addByName(e,s)}},{key:"axis",value:function(e,t,i){var a=new o.THREE.AxisHelper(i);a.applyMatrix(t),this.addByName(e,a)}},{key:"bounds",value:function(e,t,i){var a=new o.THREE.BoundingBoxHelper(t,i);a.update(),this.addByName(e,a)}},{key:"wireframes",value:function(e,t,i){try{var a=new o.THREE.WireframeHelper(t,i);this.addByName(e,a)}catch(n){console.log("edges error: "+n)}}},{key:"clear",value:function(){for(var e in this.debugObjects)this.scene.remove(this.debugObjects[e]);this.debugObjects={}}}]),e}();exports["default"]=n},{"animation-utilities":void 0}],40:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("../../atom-react/components/jibo-combo-box"),r=i(n),s=e("atom"),l=o["default"].createClass({displayName:"TimeNotchesView",onNewLayer:function(e){this.props.animationModel.addLayer(e.value),document.querySelector(".active .animation-editor").childNodes[0].focus()},componentDidMount:function(){this.subs=new s.CompositeDisposable,this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.addLayer),{title:"Add Layer"})),this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.scrubber),{title:"Scrubber"}))},componentWillUnmount:function(){this.subs.dispose()},render:function(){for(var e=this.props.animationModel.state.keyframes.duration,t=this.props.animationModel.state.keyframes.framerate,i=this.props.animationModel.state.keyframes.duration/t,a=this.props.animationModel.uiState.currentKeyframe,n=[],s=Math.floor(this.props.totalFrames/5)+1,l=0;s>l;l++)n.push(o["default"].createElement("span",{key:l,className:"animation-timeline-notch"},5*l));var d=22,u={container:{width:Math.max(5*s*18+this.props.labelWidth+20,this.props.width),height:d,position:"absolute",marginTop:this.props.offset.y,background:"#363636",borderBottom:"thin solid #444444",zIndex:10},indicator:{marginLeft:18*a,height:20,display:null===this.props.animationModel.getSelectedLayer()?"none":"inline-block"},displayAnchor:{width:this.props.labelWidth-13,marginRight:13,height:d,"float":"left",position:"relative"},display:{width:this.props.labelWidth,paddingRight:13,height:d-1,position:"absolute",marginLeft:this.props.offset.x,background:"#363636",zIndex:2},notches:{width:18*s*5,height:d,"float":"left",marginLeft:270},miniLine:{height:4,width:2,opacity:.7,position:"absolute",marginTop:18,marginLeft:7,background:"red"}},c=this.props.animationModel.getKeyframeInfo(),h=Object.keys(c.layerTypes),f=[],p=this.props.animationModel.getLayersOfType("Video");h.forEach(function(e){"Video"===e&&p.length>0||f.push({label:e,display:function(){return o["default"].createElement("i",{className:"fa fa-plus-square",style:{fontSize:17}})},value:e})});var m=f[0];return o["default"].createElement("div",{style:u.container,className:"animation-timeline-notches-container"},o["default"].createElement("div",{style:this.displayAnchor},o["default"].createElement("div",{style:u.display,className:"time-display"},o["default"].createElement("div",{ref:"addLayer",style:{"float":"left"},className:"new-layer"},o["default"].createElement(r["default"],{hideButton:!0,data:f,init:m,onSelected:this.onNewLayer})),o["default"].createElement("span",{className:"frames"},a," of ",e,", "),o["default"].createElement("span",{className:"frame-rate"},t,"fps, "),o["default"].createElement("span",{className:"seconds"},i.toFixed(1),"s"))),o["default"].createElement("div",{style:u.notches,className:"animation-timeline-notches"},o["default"].createElement("div",{ref:"scrubber",style:u.indicator,className:"animation-timeline-indicator",onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp},o["default"].createElement("div",{className:"animation-timeline-indicator-handle"},o["default"].createElement("div",{style:u.miniLine}))),n))},onMouseDown:function(){this.props.animationModel.emit("toggle-time-scrub",!0),this.onMouseUpBind=this.onMouseUp.bind(this),document.addEventListener("mouseup",this.onMouseUpBind)},onMouseUp:function(){this.props.animationModel.emit("toggle-time-scrub",!1),document.removeEventListener("mouseup",this.onMouseUpBind)}});exports["default"]=l},{"../../atom-react/components/jibo-combo-box":51,atom:void 0,react:void 0}],41:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("./layer"),r=i(n),s=e("./layer-label"),l=i(s),d=e("./time-notches"),u=i(d),c=e("jquery"),h=i(c),f=e("lodash"),p=i(f),m=e("jibo-keyframes"),v=i(m),y=e("jibo-keyframes/lib/jibo-keyframe-info"),g=i(y),b=e("./playback-controls"),k=i(b),M=o["default"].createClass({displayName:"layout-child",getInitialState:function(){var e=this;return this.props.animationModel.on("onpropertieschanged",function(){e.setLimits(),e.forceUpdate()}),{headerOffset:{x:0,y:0},labelsOffset:0}},componentDidMount:function(){this.getDOMNode().addEventListener("scroll",this.onScroll.bind(this)),this.onKeyframeUpsertCB=this.onKeyframeUpsert.bind(this),this.props.animationModel.on("onkeyframeupsert",this.onKeyframeUpsertCB),this.keyframesUpserted=void 0},componentWillUnmount:function(){this.props.animationModel.removeListener("onkeyframeupsert",this.onKeyframeUpsertCB)},componentWillReceiveProps:function(e){if(e.playbackTime!==this.props.playbackTime){var t=18*e.playbackTime+270;0===e.playbackTime&&this.props.playbackTime===this.props.animationModel.state.keyframes.duration-1?this.getDOMNode().scrollLeft=0:e.playbackTime>this.props.playbackTime?this.getDOMNode().scrollLeft+this.getDOMNode().offsetWidth<t&&(this.getDOMNode().scrollLeft=t-270):e.playbackTime<this.props.playbackTime&&this.getDOMNode().scrollLeft+270>t&&(this.getDOMNode().scrollLeft=t-this.getDOMNode().offsetWidth)}},onScroll:function(){this.setState({labelsOffset:this.getDOMNode().scrollLeft,headerOffset:{x:this.getDOMNode().scrollLeft,y:this.getDOMNode().scrollTop}})},onMouseMove:function(e){return 0===e.buttons?void this.onMouseUp():(this.setTimeFromMousePosition({nativeEvent:e}),void this.props.animationModel.emit("drag-keyframe"))},onMouseUp:function(){document.removeEventListener("mousemove",this.onMouseMoveBind),document.removeEventListener("mouseup",this.onMouseUpBind)},onMouseDown:function(e){1===e.nativeEvent.which&&(this.onMouseMoveBind=this.onMouseMove.bind(this),this.onMouseUpBind=this.onMouseUp.bind(this),document.addEventListener("mousemove",this.onMouseMoveBind),document.addEventListener("mouseup",this.onMouseUpBind),this.setTimeFromMousePosition(e))},setTimeFromMousePosition:function(e){var t=(0,h["default"])(this.getDOMNode()).find(".animation-timeline-notch").offset(),i=Math.floor((e.nativeEvent.clientX-t.left)/18);i=Math.max(i,0),i=Math.min(i,this.props.animationModel.state.keyframes.duration-1),this.props.animationModel.setKeyframe(i)},onKeyframeUpsert:function(e){this.keyframesUpserted=e},evaluateFiltered:function(e,t){return v["default"].runtime.evaluateAllLayersFiltered(e,g["default"],t,function(e){return"Body"===e.type})},toRadians:function(e){return Math.PI*e/180},setLimits:function(){var e=this.props.animationModel.state.keyframes,t=1/e.framerate,i=0,a=this.props.animationModel.limits,o=this.props.animationModel.state.keyframes.duration,n=!1,r=!1;this.keyframesExceeded=[];for(var s=0;o>s;s++){var l=!1,d=this.evaluateFiltered(e,i),u=void 0,c=void 0;s>0&&o-1>s&&(u=this.evaluateFiltered(e,i+t),c=this.evaluateFiltered(e,i-t));for(var h in d.Body){var f=0,p=0;if(u){f=(this.toRadians(u.Body[h])-this.toRadians(d.Body[h]))/t;var m=(this.toRadians(d.Body[h])-this.toRadians(c.Body[h]))/t;p=(f-m)/t}a[h]&&Math.abs(f)>a[h].velocityLimit&&(n=!0,l=!0),a[h]&&Math.abs(p)>a[h].accelerationLimit&&(r=!0,l=!0)}this.keyframesExceeded.push(l),i+=t}this.props.animationModel.setLimit(n,r)},render:function(){var e=this,t=this.props.animationModel.state.keyframes.duration,i=18*(t+1),a=40*this.props.animationModel.state.keyframes.layers.length,n=Math.floor(t/5)+1,s=270,d={timeline:{width:this.props.width,height:this.props.height,background:"#404040"},container:{width:s+5*n*18+20,height:a+22},headerAnchor:{position:"relative",width:s+5*n*18+20,height:22},labelsAnchor:{position:"relative",width:s,height:a,"float":"left",zIndex:2},labels:{position:"absolute",marginLeft:this.state.labelsOffset},channelsContainer:{width:i,height:a,"float":"left",zIndex:1},channels:{width:i},indicator:{position:"absolute",marginLeft:18*this.props.animationModel.uiState.currentKeyframe+9-this.state.labelsOffset,height:this.props.height-22,zIndex:1,display:null===this.props.animationModel.getSelectedLayer()?"none":"inline-block"}},c=this.props.animationModel,h=this,f=[],m=[],v=0,y=this.props.animationModel.state.keyframes;return y.layers.forEach(function(a){var n=h.props.animationModel.isLayerSelected(a.id)?h.props.animationModel.uiState.currentKeyframe:void 0,s=void 0;void 0!==h.keyframesUpserted&&-1!==p["default"].indexOf(h.keyframesUpserted.layers,a)&&(s=h.keyframesUpserted.keyframeTime),f.push(o["default"].createElement(r["default"],{key:a.id,type:a.type,keyframesExceeded:e.keyframesExceeded,upserted:s,selected:n,totalWidth:i,layerId:a.id,animationModel:c,totalFrames:t,keyframes:a.keyframes,latestHash:e.props.animationModel.undoRedo.latestHash})),m.push(o["default"].createElement(l["default"],{tabIndex:200+v,animationModel:c,odd:v++%2===0,key:a.id,layerId:a.id}))}),this.keyframesUpserted=void 0,o["default"].createElement("div",{style:d.timeline,className:"animation-timeline"},o["default"].createElement(k["default"],{animationModel:this.props.animationModel,timelineWidth:this.props.width,timelineHeight:this.props.height}),o["default"].createElement("div",{ref:"timeline",style:d.container,className:"animation-timeline-container"},o["default"].createElement("div",{style:d.headerAnchor,onMouseDownCapture:this.onMouseDown},o["default"].createElement(u["default"],{offset:this.state.headerOffset,channelWidth:i,width:this.props.width,height:this.props.height+22,labelWidth:s,totalFrames:t,animationModel:this.props.animationModel})),o["default"].createElement("div",{style:d.labelsAnchor},o["default"].createElement("div",{ref:"layerContainer",style:d.labels,className:"animation-channel-labels-container"},m)),o["default"].createElement("div",{style:d.channelsContainer},o["default"].createElement("div",{style:d.channels,className:"animation-timeline-channels"},o["default"].createElement("div",{style:d.indicator,className:"animation-timeline-indicator-line"}),f))))}});exports["default"]=M},{"./layer":20,"./layer-label":19,"./playback-controls":22,"./time-notches":40,"jibo-keyframes":void 0,"jibo-keyframes/lib/jibo-keyframe-info":void 0,jquery:void 0,lodash:void 0,react:void 0}],42:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=e("react"),l=i(s),d=e("../../../ffmpeg/ffmpeg"),u=i(d),c=e("path"),h=i(c),f=e("fs"),p=i(f),m=e("async"),v=i(m),y=e("events"),g="win32"===process.platform?process.env.HOMEPATH:process.env.HOME,b=h["default"].resolve(g,".jibo","temp"),k=void 0,M=void 0,E={},w=function(e){function t(e){a(this,t);var i=o(this,Object.getPrototypeOf(t).call(this));return i.uri=e,i.fileName=h["default"].parse(i.uri).base,i.folderPath=h["default"].resolve(b,i.fileName),i.imageCache={},i.isLoaded=!1,p["default"].existsSync(b)||p["default"].mkdirSync(b),i}return n(t,e),r(t,[{key:"_getImageKey",value:function(e){return this.folderPath+e}},{key:"_loadImage",value:function(e,t,i){var a=new Image;E[this._getImageKey(t)]=a,a.onload=function(){i()};var o=h["default"].resolve(this.folderPath,"image"+e+".png");a.src=o+"?"+t}},{key:"_loadImages",value:function(e,t,i){var a=this;try{(0,u["default"])(this.uri).on("filenames",function(){}).on("end",function(){for(var e=[],o=0;o<t.length;o++)e.push(a._loadImage.bind(a,o+1,t[o]));v["default"].parallel(e,function(){i()})}).on("error",function(e){console.log(e)}).screenshots({timestamps:e,folder:this.folderPath,filename:"image%i.png",size:this.imageWidth+"x"+this.imageHeight})}catch(o){console.log(o)}}},{key:"load",value:function(e){var t=this;if(this.isLoaded)return void(e&&e());try{!function(){var i=(new Date).getTime();u["default"].ffprobe(t.uri,function(a,o){if(o){t.ratio=o.streams[0].coded_height/o.streams[0].coded_width,t.imageWidth=Math.min(o.streams[0].coded_width,500),t.imageHeight=Math.round(t.imageWidth*t.ratio),t.duration=o.streams[0].duration,t.frameRate=parseInt(o.streams[0].avg_frame_rate.split("/")[0],10),t.count=t.duration*t.frameRate;for(var n=[],r=[],s=[],l=1,d=0;d<Math.min(t.duration,15);d+=1/t.frameRate)r.push(d),s.push(l),r.length===t.frameRate&&(n.push(t._loadImages.bind(t,r,s)),r=[],s=[]),l++;r.length>0&&n.push(t._loadImages.bind(t,r,s)),v["default"].series(n,function(){var a=(new Date).getTime()-i;console.log("Video of "+t.duration+" seconds toolk "+a),e()})}})}()}catch(i){console.log(i)}}},{key:"getImage",value:function(e){return E[this._getImageKey(e)]}}]),t}(y.EventEmitter);exports["default"]=l["default"].createClass({displayName:"layout-child",getInitialState:function(){return this.onDataChangedBind=this.onDataChanged.bind(this),this.dataMap={},{}},render:function(){return k&&M&&this.setStyle(),l["default"].createElement("div",{className:"video-container",ref:"content",style:{width:"100%",height:"100%",display:"inline-block"},src:this.props.videoSource,preload:"auto"})},setStyle:function(){var e=k.getImage(M);if(e){var t=1/k.ratio;if(e.style.position="relative",t<this.props.width/this.props.height){var i=this.props.height,a=t*this.props.height,o=.5*(this.props.width-a);e.style.height=i+"px",e.style.width=a+"px",e.style.left=o+"px",e.style.top=""}else{var n=this.props.width/t,r=this.props.width,s=.5*(this.props.height-n);e.style.height=n+"px",e.style.width=r+"px",e.style.top=s+"px",e.style.left=""}}},componentWillUnmount:function(){this.props.animationModel.removeListener("ondatachanged",this.onDataChangedBind)},loadVideos:function(e){for(var t=this,i=this.props.animationModel,a=i.getLayersOfType("Video")[0].keyframes,o=[],n=a.length-1;n>=0;n--){var r=a[n].value.Video;if(""!==r){var s=h["default"].resolve(this.props.projectRoot,r);this.dataMap[s]||!function(){var e=new w(s);t.dataMap[s]=e,o.push(function(t){e.load(t)})}()}}o.length>0&&v["default"].parallel(o,e)},componentDidMount:function(){var e=this;this.content=l["default"].findDOMNode(this.refs.content),this.loadVideos(function(){e.onDataChanged()}),this.props.animationModel.on("ondatachanged",this.onDataChangedBind)},setChild:function(){var e=k.getImage(M);if(e){for(;this.content.firstChild;)this.content.removeChild(this.content.firstChild);this.content.appendChild(e),this.setStyle(k)}},onDataChanged:function(){var e=this.props.animationModel,t=e.getLayersOfType("Video");if(0!==t.length){this.loadVideos();for(var i=e.uiState.currentKeyframe,a=t[0].keyframes,o=void 0,n=a.length-1;n>=0;n--)if(i>=a[n].time){o=a[n];break}if(o){k=void 0;var r=o.value.Video;if(""!==r){var s=h["default"].resolve(this.props.projectRoot,r);k=this.dataMap[s];var l=(i-o.time)/this.props.animationModel.state.keyframes.framerate;M=Math.round(k.count*l/k.duration),this.setChild()}}else for(;this.content.firstChild;)this.content.removeChild(this.content.firstChild)}}})},{"../../../ffmpeg/ffmpeg":105,async:void 0,events:void 0,fs:void 0,path:void 0,react:void 0}],43:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("../controllers/animation-controller"),r=i(n),s=e("lodash"),l=i(s),d=e("path"),u=i(d),c=e("../../atom-react/components/jibo-combo-box"),h=i(c),f=e("atom"),p=[{label:"Front",display:"front",value:"front"},{label:"Back",display:"back",value:"back"},{label:"Left",display:"left",value:"left"},{label:"Right",display:"right",value:"right"}],m=o["default"].createClass({displayName:"layout-child",componentWillMount:function(){this.controller=new r["default"](this.props.animationModel),this.lastWidth=this.props.width,this.lastHeight=this.props.height,this.requestAnimationID=window.requestAnimationFrame(this.updateLoop.bind(this))},updateLoop:function(){if(this.controller.renderer){var e=this.props.animationModel.evaluateAllDOFLayers();e=l["default"].extend({},l["default"].cloneDeep(this.controller.robotInfo.getDefaultDOFValues()),l["default"].cloneDeep(e));for(var t in e){var i=e[t];("eyeTextureInfixBn_r"===t||"overlayTextureInfixBn_r"===t||"screenBGTextureInfixBn_r"===t)&&(i="file://"+u["default"].resolve(this.props.animationModel.projectRoot,i)),e[t]=i}this.controller.updateDofValues(e),this.controller.update()}this.requestAnimationID=window.requestAnimationFrame(this.updateLoop.bind(this))},componentDidMount:function(){var e=o["default"].findDOMNode(this.refs.preview);this.controller.initialize(e,function(){}),e.addEventListener("contextmenu",function(e){return"CANVAS"===e.target.tagName?(e.preventDefault(),e.stopPropagation(),!1):!0},!1),this.subs=new f.CompositeDisposable,this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.viewAngle),{title:"Body View Angle"})),this.subs.add(atom.tooltips.add(o["default"].findDOMNode(this.refs.reset),{title:"Reset Body View"}))},componentWillUnmount:function(){this.requestAnimationID&&window.cancelAnimationFrame(this.requestAnimationID),this.controller.dispose(),this.subs.dispose()},onMouseDown:function(){return!1},onMouseDownCapture:function(){return!1},onChangeCamera:function(e){this.controller.setCamera(e.value)},onBackgroundColor:function(){},onReset:function(){this.controller.setCamera(p[0].value)},render:function(){this.controller&&this.controller.renderer&&(this.lastWidth!==this.props.width||this.lastHeight!==this.props.height)&&(this.controller.renderer.scene.handleResize(),this.lastWidth=this.props.width,this.lastHeight=this.props.height);var e={reset:{position:"absolute",marginLeft:90,marginTop:10},comboBox:{position:"absolute",margin:10}};return o["default"].createElement("div",{tabIndex:1,ref:"preview",className:"animation-preview"},o["default"].createElement("div",{className:"block",style:e.reset},o["default"].createElement("button",{ref:"reset",className:"btn icon icon-sync inline-block-tight",onClick:this.onReset},"Reset")),o["default"].createElement("div",{style:e.comboBox},o["default"].createElement(h["default"],{ref:"viewAngle",data:p,init:p[0],onSelected:this.onChangeCamera})))}});exports["default"]=m},{"../../atom-react/components/jibo-combo-box":51,"../controllers/animation-controller":7,atom:void 0,lodash:void 0,path:void 0,react:void 0}],44:[function(e,t,exports){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),o=e("animation-utilities"),n=function(){function e(t){i(this,e),this.uri=t}return a(e,[{key:"play",value:function(){this.builder&&this.builder.play()}},{key:"setElement",value:function(e){var t=this,i=new o.JiboConfig;o.RobotInfo.createInfo(i,function(i){o.TimelineBuilder.createTimeline(i,function(a){if(null!==a){o.visualize.createRobotRenderer(i,e,o.visualize.DisplayType.BODY,function(e){null!==e?(e.setBackgroundColor(.8,.8,.8,0),o.TimelineBuilder.connectRenderer(a,e),e.setGrid(.05,10,new o.THREE.Color(1,1,1))):console.log("Renderer creation failed")});var n=o.animate.createAnimationUtilities(a,i);n.setDefaultTransition(null),n.createAnimationBuilder(t.uri,function(e){null!==e?(t.builder=e,e.setTransitionIn(null),e.on("STOPPED",function(){e.play(0)}),e.play()):console.log("Animation load failed")},!0)}else console.error("Timeline creation failed")})})}}]),e}();exports["default"]=n},{"animation-utilities":void 0}],45:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=e("atom-space-pen-views"),l=e("./animation"),d=i(l);t.exports=function(e){function t(){return a(this,t),o(this,Object.getPrototypeOf(t).apply(this,arguments))}return n(t,e),r(t,[{key:"attached",value:function(){return console.log("attached!")}},{key:"initialize",value:function(e){console.log(e.uri);var t=new d["default"](e.uri);return t.setElement(this[0])}}],[{key:"content",value:function(){return this.div({"class":"bodyRenderer"})}}]),t}(s.View)},{"./animation":44,"atom-space-pen-views":void 0}],46:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=e("./jibo-sim-view"),r=i(n),s=e("path"),l=i(s),d=e("fs"),u=i(d),JiboSim=function(){function JiboSim(e){a(this,JiboSim),this.uri=l["default"].normalize(e),this.tabTitle=l["default"].parse(e).base}return o(JiboSim,[{key:"getTitle",value:function(){return this.tabTitle}},{key:"getViewClass",value:function(){return r["default"]}},{key:"destroy",value:function(){return console.log("destroy")}},{key:"getURI",value:function(){return this.uri}},{key:"save",value:function(){return console.log("Save Item")}},{key:"saveAs",value:function(e){return console.log("Save Item As "+e)}},{key:"play",value:function(){return console.log("jibo-sim::play"),this.emit("play",this.uri)}},{key:"serialize",value:function(){return{filePath:this.uri,tabTitle:this.tabTitle,deserializer:"JiboSim"}}}],[{key:"deserialize",value:function(e){return u["default"].existsSync(e)?new JiboSim(e):console.warn("Could not deserialize image editor for path '"+e+"' because that file no longer exists")}}]),JiboSim}();atom.deserializers.add({deserialize:JiboSim.deserialize,name:"JiboSim"}),exports["default"]=JiboSim},{"./jibo-sim-view":45,fs:void 0,path:void 0}],47:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var a=e("react/lib/ReactInjection"),o=i(a),n={isCustomAttribute:function(e){return-1!==["mini","gutter-hidden","placeholder-text"].indexOf(e)},Properties:{mini:null,"gutter-hidden":null,"placeholder-text":null},DOMAttributeNames:{},DOMPropertyNames:{}};o["default"].DOMProperty.injectDOMPropertyConfig(n),t.exports={activate:function(){},deactivate:function(){}}},{"react/lib/ReactInjection":void 0}],48:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=o["default"].createClass({displayName:"FloatInputView",getDefaultProps:function(){return{style:{width:"100%"},tabIndex:-1,min:-Number.MAX_VALUE,max:Number.MAX_VALUE,defaultValue:0,value:0,precision:20,onChange:function(){}}},getInitialState:function(){return{value:this.toPrecision(this.props.value)}},componentWillMount:function(){this.textValue=this.props.value},componentWillReceiveProps:function(e){var t=this.toPrecision(e.value),i=this.getDOMNode().childNodes[0];this.textValue!==t&&(this.textValue=t,i.value=t,this.setState({value:t}))},toPrecision:function(e){return parseFloat(e.toFixed(this.props.precision))},onFocus:function(){this.getDOMNode().childNodes[0].select(),this.becameSelected=!0},onMouseUp:function(e){this.becameSelected===!0&&(this.becameSelected=!1,e.preventDefault(),e.stopPropagation())},render:function(){var e={width:"100%"};return o["default"].createElement("div",{className:"native-key-bindings",tabIndex:-1},o["default"].createElement("input",{onFocus:this.onFocus,onKeyPress:this.onKeyPress,className:"native-key-bindings",style:Object.assign({},e,this.props.style),tabIndex:this.props.tabIndex,type:"number",onMouseUpCapture:this.onMouseUp,onChange:this.onChange,defaultValue:this.state.value,min:this.props.min,max:this.props.max,onKeyDown:this.onKeyDown,step:"any"}))},onKeyDown:function(){},onKeyPress:function(e){13===e.nativeEvent.keyCode&&(this.getDOMNode().childNodes[0].value=this.state.value)},onChange:function(e){var t=e.target.value;0!==t.length&&(t=parseFloat(t),t=Math.max(this.props.min,t),t=Math.min(this.props.max,t),t=this.toPrecision(t),t!==this.state.value&&(this.setState({value:t}),this.textValue=t,this.props.onChange(t)))}});exports["default"]=n},{react:void 0}],49:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=o["default"].createClass({displayName:"IntegerInputView",getDefaultProps:function(){return{min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER,tabIndex:-1,defaultValue:0,value:0,precision:0,onChange:function(){}}},getInitialState:function(){return{value:this.toPrecision(this.props.value)}},componentWillMount:function(){this.textValue=this.props.value},componentWillReceiveProps:function(e){var t=this.toPrecision(e.value),i=this.getDOMNode().childNodes[0];this.textValue!==t&&(this.textValue=t,i.value=t,this.setState({value:t}))},toPrecision:function(e){return parseFloat(e.toFixed(this.props.precision))},render:function(){var e={width:"100%"};return o["default"].createElement("div",{className:"native-key-bindings",tabIndex:-1},o["default"].createElement("input",{onKeyPress:this.onKeyPress,className:"native-key-bindings",style:Object.assign({},e,this.props.style),tabIndex:this.props.tabIndex,type:"number",onChange:this.onChange,defaultValue:this.state.value,min:this.props.min,max:this.props.max,step:"any"}))},onKeyPress:function(e){13===e.nativeEvent.keyCode&&(this.getDOMNode().childNodes[0].value=this.state.value)},onChange:function(e){var t=e.target.value;0!==t.length&&(t=parseFloat(t),t=Math.max(this.props.min,t),t=Math.min(this.props.max,t),t=this.toPrecision(t),t!==this.state.value&&(this.setState({value:t}),this.textValue=t,this.props.onChange(t)))}});exports["default"]=n},{react:void 0}],50:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("jquery"),r=i(n),s=o["default"].createClass({displayName:"List",getInitialState:function(){return{hoveredElement:void 0}},onMouseOver:function(e){this.state.hoveredElement=e,this.setState(this.state)},onMouseOut:function(){this.state.hoveredElement=void 0,this.setState(this.state)},onClick:function(e){this.props.onSelect(e)},render:function(){var e=this,t=[];return this.props.data.forEach(function(i,a){var n="list-item";i===e.state.hoveredElement&&(n+=" selected");var r={},s=null;"string"==typeof i.label?(r={marginLeft:0},s=i.label):s=i.label(),t.push(o["default"].createElement("li",{key:a,className:n,onMouseOver:e.onMouseOver.bind(e,i),onMouseOut:e.onMouseOut.bind(e,i),onClick:e.onClick.bind(e,i)},o["default"].createElement("span",{style:r},s)))}),o["default"].createElement("ul",{className:"list-group"},t)}});exports["default"]=o["default"].createClass({displayName:"jibo-combo-box-unidirectional",getInitialState:function(){return{clickHandler:this.clickHandler.bind(this)}},render:function(){var e=null;if(this.props.current.display)if("function"==typeof this.props.current.display)e=this.props.current.display();else{var t=null;t=this.props.titleDisplay?this.props.titleDisplay:this.props.current.display,e="\xa0\xa0"+t,e=[o["default"].createElement("i",{className:"fa fa-caret-down",style:{fontSize:20}}),e]}var i="combo-box btn";return this.props.hideButton&&(i="combo-box"),o["default"].createElement("div",null,o["default"].createElement("div",{ref:"button",className:i,onClick:this.onClick},e))},removeList:function(){(0,r["default"])(document).off("click",this.state.clickHandler),this.node.remove(),this.node=null},onSelect:function(e){this.props.keepFocusAfterClick||this.removeList(),this.props.onSelected(e)},clickHandler:function(e){0===(0,r["default"])(e.target).closest(this.node).length&&this.removeList()},onClick:function(e){if(e.preventDefault(),e.stopPropagation(),this.node)this.removeList();else{var t=o["default"].findDOMNode(this.refs.button),i=t.getBoundingClientRect();this.node=(0,r["default"])("<div />").addClass("combo-box-list").css({left:i.left+"px",top:i.bottom+"px"}).appendTo(document.body),(0,r["default"])(document).on("click",this.state.clickHandler),o["default"].render(o["default"].createElement(s,{data:this.props.data,onSelect:this.onSelect}),this.node[0])}}})},{jquery:void 0,react:void 0}],51:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("jquery"),r=i(n),s=o["default"].createClass({displayName:"List",getInitialState:function(){return{hoveredElement:void 0}},onMouseOver:function(e){this.state.hoveredElement=e,this.setState(this.state)},onMouseOut:function(){this.state.hoveredElement=void 0,this.setState(this.state)},onClick:function(e){this.props.onSelect(e)},render:function(){var e=this,t=[];return this.props.data.forEach(function(i,a){var n="list-item";i===e.state.hoveredElement&&(n+=" selected");
var r={},s=null;"string"==typeof i.label?(r={marginLeft:5},s=i.label):s=i.label(),t.push(o["default"].createElement("li",{key:a,className:n,onMouseOver:e.onMouseOver.bind(e,i),onMouseOut:e.onMouseOut.bind(e,i),onClick:e.onClick.bind(e,i)},o["default"].createElement("span",{style:r},s)))}),o["default"].createElement("ul",{className:"list-group"},t)}});exports["default"]=o["default"].createClass({displayName:"jibo-combo-box",getInitialState:function(){return{clickHandler:this.clickHandler.bind(this),current:this.props.init}},render:function(){var e=null;if(this.state.current.display)if("function"==typeof this.state.current.display)e=this.state.current.display();else{var t=null;t=this.props.titleDisplay?this.props.titleDisplay:this.state.current.display,e="\xa0\xa0"+t,e=[o["default"].createElement("i",{className:"fa fa-caret-down",style:{fontSize:20}}),e]}var i="combo-box btn";return this.props.hideButton&&(i="combo-box"),o["default"].createElement("div",null,o["default"].createElement("div",{ref:"button",className:i,onClick:this.onClick},e))},removeList:function(){(0,r["default"])(document).off("click",this.state.clickHandler),this.node.remove(),this.node=null},onSelect:function(e){this.state.current=e,this.setState(this.state),this.props.keepFocusAfterClick||this.removeList(),this.props.onSelected(e)},clickHandler:function(e){0===(0,r["default"])(e.target).closest(this.node).length&&this.removeList()},onClick:function(e){if(e.preventDefault(),e.stopPropagation(),this.node)this.removeList();else{var t=o["default"].findDOMNode(this.refs.button),i=t.getBoundingClientRect();this.node=(0,r["default"])("<div />").addClass("combo-box-list").css({left:i.left+"px",top:i.bottom+"px"}).appendTo(document.body),(0,r["default"])(document).on("click",this.state.clickHandler),o["default"].render(o["default"].createElement(s,{data:this.props.data,onSelect:this.onSelect}),this.node[0])}}})},{jquery:void 0,react:void 0}],52:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=e("atom-space-pen-views"),l=e("atom"),d=e("react"),u=i(d);t.exports=function(e,t){var i={};if(i[t])return i[t];var d=function(i){function s(){return a(this,s),o(this,Object.getPrototypeOf(s).apply(this,arguments))}return n(s,i),r(s,[{key:"detached",value:function(){return u["default"].unmountComponentAtNode(this[0]),this.editor.dispose(),this.disposables.dispose()}},{key:"initialize",value:function(t){this.disposables=new l.CompositeDisposable,this.editor=t,t.shouldScroll&&(this[0].style.overflow="auto");var i=u["default"].createElement(e,{parent:this[0],editor:t,paneWidth:this[0].offsetWidth,paneHeight:this[0].offsetHeight});return this.editor.container=this[0],u["default"].render(i,this[0]),this.disposables.add(atom.workspace.onDidChangeActivePaneItem(this.onActivePaneChange.bind(this))),atom.workspace.getActivePaneItem()===this.editor?this.onActivePaneChange(null):void 0}},{key:"onActivePaneChange",value:function(e){var i=null;return e&&(i=e.__displayName||e.constructor.name),e&&i!==t?this.editor.active===!0?(this.editor.active=!1,this.editor.onPaneDeactivated()):void 0:(this.editor.active=!0,this.editor.onPaneActivated())}}],[{key:"content",value:function(){return this.div({"class":t.match(/[A-Z][a-z]+/g).map(function(e){return e.toLowerCase()}).join("-")})}}]),s}(s.View);return i[t]=d,d}},{atom:void 0,"atom-space-pen-views":void 0,react:void 0}],53:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=e("path"),r=i(n),s=e("fs"),l=i(s),d=e("./atom-view-react-bridge"),u=i(d),c=e("atom"),h=function(){function e(t,i,o){var n=this;a(this,e),this.__displayName=t,this.emitter=new c.Emitter,this.modifiedStatus=!1,this.shouldScroll=o,this.uri=r["default"].normalize(i),this.tabTitle=r["default"].parse(i).base,this.file=new c.File(this.uri),this.ignoreFirstReload=!0,this.onDidChangeDisposable=this.file.onDidChange(function(){return n.ignoreFirstReload?void(n.ignoreFirstReload=!1):n.shouldPromptToSave()?void(n.ignoreFirstReload=!0):(n.reload(),void(n.ignoreFirstReload=!0))}),this.onDidRenameDisposable=this.file.onDidRename(function(){n.uri=n.file.getPath(),n.tabTitle=r["default"].parse(n.uri).base,n.emitter.emit("did-change-title")}),this.active=!1,this.container=null}return o(e,[{key:"dispose",value:function(){this.onDidChangeDisposable.dispose(),this.onDidRenameDisposable.dispose()}},{key:"isPaneActive",value:function(){return this.active}},{key:"onPaneActivated",value:function(){}},{key:"onPaneDeactivated",value:function(){}},{key:"getTitle",value:function(){return this.tabTitle}},{key:"isModified",value:function(){return this.modifiedStatus}},{key:"shouldPromptToSave",value:function(){return this.modifiedStatus}},{key:"onDidChangeModified",value:function(e){return this.emitter.on("did-change-modified",e)}},{key:"getReactClass",value:function(){throw new Error("Override "+this.__displayName+".getReactClass()")}},{key:"getViewClass",value:function(){return(0,u["default"])(this.getReactClass(),this.__displayName)}},{key:"getURI",value:function(){return this.uri}},{key:"getPath",value:function(){return this.uri}},{key:"onDidChangeTitle",value:function(e){return this.emitter.on("did-change-title",e)}},{key:"setModifiedStatus",value:function(e){this.modifiedStatus=e,this.emitter.emit("did-change-modified",e)}},{key:"serialize",value:function(){return{filePath:this.uri,tabTitle:this.tabTitle,deserializer:this.__displayName}}},{key:"save",value:function(){this.saveFile(this.uri)&&(this.ignoreFirstReload=!0,this.setModifiedStatus(!1))}},{key:"saveAs",value:function(e){this.saveFile(e)&&(this.ignoreFirstReload=!0,this.uri=r["default"].normalize(e),this.tabTitle=r["default"].parse(e).base,this.emitter.emit("did-change-title",this.getTitle()))}},{key:"saveFile",value:function(){throw new Error("Override JiboEditor.saveFile()")}},{key:"undo",value:function(){console.log("undo")}},{key:"redo",value:function(){console.log("redo")}},{key:"saveUiState",value:function(e){atom.config.set("jibo-sdk."+this.__displayName,JSON.stringify(e))}},{key:"getUiState",value:function(){var e=atom.config.get("jibo-sdk."+this.__displayName);return e?JSON.parse(e):void 0}},{key:"reload",value:function(){}}],[{key:"getProjectRoot",value:function(e){e=r["default"].normalize(e).toLowerCase();for(var t=atom.project.getPaths(),i=0;i<t.length;i++){var a=r["default"].normalize(t[i]).toLowerCase();if("."===e||e.includes(a))return a}return null}},{key:"deserialize",value:function(e){return 0===e.filePath.search("atom:/")||l["default"].existsSync(e.filePath)?new this(e.filePath):void console.warn("Could not deserialize ReactEditor for path '"+e.filePath+"' because that file no longer exists")}}]),e}();exports["default"]=h},{"./atom-view-react-bridge":52,atom:void 0,fs:void 0,path:void 0}],54:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=e("fs"),r=i(n),s=e("./atom-view-react-bridge"),l=i(s),d=function(){function e(t,i,o,n){a(this,e),this.__displayName=t,this.shouldScroll=o,this.tabTitle=n,this.uri=i}return o(e,[{key:"dispose",value:function(){}},{key:"getTitle",value:function(){return this.tabTitle}},{key:"getReactClass",value:function(){throw new Error("Override ReactEditor.getReactClass()")}},{key:"serialize",value:function(){return{filePath:this.uri,tabTitle:this.tabTitle,deserializer:this.__displayName}}},{key:"getURI",value:function(){return this.uri}},{key:"getPath",value:function(){return this.uri}},{key:"saveUiState",value:function(e){atom.config.set("jibo-sdk."+this.__displayName,JSON.stringify(e))}},{key:"getUiState",value:function(){var e=atom.config.get("jibo-sdk."+this.__displayName);return e?JSON.parse(e):void 0}},{key:"onPaneActivated",value:function(){}},{key:"onPaneDeactivated",value:function(){}},{key:"getViewClass",value:function(){return(0,l["default"])(this.getReactClass(),this.__displayName)}}],[{key:"deserialize",value:function(e){return 0===e.filePath.search("atom:/")||r["default"].existsSync(e.filePath)?new this(e.filePath):void console.warn("Could not deserialize "+this.__displayName+" for path '"+e.filePath+"' because that file no longer exists")}}]),e}();exports["default"]=d},{"./atom-view-react-bridge":52,fs:void 0}],55:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("jquery"),o=i(a),n=e("react"),r=i(n),s={createModal:function(e,t){this._modalContainer=(0,o["default"])("<div/>"),t&&(this._modalContainer.width(t),this._modalContainer.addClass("modal-background")),r["default"].render(e,this._modalContainer[0]),this.state=this.state?this.state:{},this.state.modalPanel=atom.workspace.addModalPanel({item:this._modalContainer})},destroyModal:function(){r["default"].unmountComponentAtNode(this._modalContainer[0]),this.state.modalPanel&&(this.state.modalPanel.destroy(),this.state.modalPanel=void 0)}};exports["default"]=s},{jquery:void 0,react:void 0}],56:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e){var t=(0,r["default"])(e).parents(".pane");return 0===t.size()&&(t=(0,r["default"])(".item-views")),{width:t.width(),height:t.height()}}function o(e){var t=a(e.getDOMNode());e.setProps({paneWidth:t.width,paneHeight:t.height})}Object.defineProperty(exports,"__esModule",{value:!0});var n=e("jquery"),r=i(n),s={setupPaneResizeEventMixin:function(){function e(t){try{var i=a(t.getDOMNode());(i.width!==t.props.paneWidth||i.height!==t.props.paneHeight)&&o(t),t.requestID=window.requestAnimationFrame(function(){e(t)})}catch(n){console.log(n)}}e(this)},cleanupPaneResizeEventMixin:function(){window.cancelAnimationFrame(this.requestID)}};exports["default"]=s},{jquery:void 0}],57:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},o=e("react"),n=i(o),r=e("../../atom-react/mixins/modal-mixin"),s=i(r),l=e("path"),d=i(l),u=e("fs"),c=i(u),h=e("../../common/animation/animation-visualizer"),f=i(h),p=e("../modals/choose-animation-modal"),m=i(p),v=n["default"].createClass({displayName:"AnimationModal",getInitialState:function(){return{uri:this.props.uri}},render:function(){return n["default"].createElement("div",{className:"block"},n["default"].createElement("div",{className:"panel-heading"},n["default"].createElement("h1",{style:{textAlign:"center"}},d["default"].parse(this.props.uri).base)),n["default"].createElement(f["default"],{style:{width:"100%",height:300},uri:this.state.uri}),n["default"].createElement("button",{className:"btn",onClick:this.props.onClose},"Close"))}}),y=n["default"].createClass({displayName:"AnimationView",mixins:[s["default"]],getInitialState:function(){return{content:this.props.content}},render:function(){var e=c["default"].existsSync(this.getUri())?{}:{disabled:!0},t=c["default"].existsSync(this.getUri().replace(".anim",".keys"))?{}:{disabled:!0};t.disabled||(t=this.state.content.split("://").length>1?{disabled:!0}:{});var i=e.disabled?n["default"].createElement("div",{className:"error-messages"},"No animtaion by that name"):null;return n["default"].createElement("div",{style:{width:"100%"}},n["default"].createElement("div",{className:"block"},n["default"].createElement("div",{className:"fileBlock"},n["default"].createElement("button",{style:{"float":"right"},className:"btn",onClick:this.onChoose},"..."),n["default"].createElement("atom-text-editor",{ref:"editor",mini:!0},this.props.content)),i,n["default"].createElement("div",{className:"btn-group",style:{marginTop:5}},n["default"].createElement("button",a({},t,{className:"btn",onClick:this.onEdit}),"Edit"),n["default"].createElement("button",a({},e,{className:"btn",onClick:this.onPreview}),"Preview"))))},onEdit:function(){atom.workspace.open(this.getUri().replace(".anim",".keys"))},getRoot:function(){var e=d["default"].resolve(this.props.projectRoot,"animations");return e},getUri:function(){var e=this.state.content.split("://");if(1===e.length){var t=d["default"].resolve(this.props.projectRoot,"animations",this.state.content);return t}if(2===e.length){var i=d["default"].resolve(this.props.projectRoot,"node_modules",e[0],"animations",e[1]);return i}},onPreview:function(){var e=this;this.createModal(n["default"].createElement(v,{uri:this.getUri(),onClose:function(){e.destroyModal()}}))},onChoose:function(){var e=this;this.createModal(n["default"].createElement(m["default"],{root:this.getRoot(),uri:this.getUri(),onChoose:function(t){var i=n["default"].findDOMNode(e.refs.editor);i&&i.getModel().setText(t)},onClose:function(){e.destroyModal()}}))},componentDidMount:function(){var e=this,t=n["default"].findDOMNode(this.refs.editor),i=t.getModel();this.disposable=i.onDidChange(function(){e.state.content=i.getText(),e.props.onChange(i.getText()),e.setState(e.state)})},componentWillUnmount:function(){this.disposable&&this.disposable.dispose()}});exports["default"]=function(e,t,i,a){return n["default"].createElement(y,{key:t,content:e,onChange:i,projectRoot:a})}},{"../../atom-react/mixins/modal-mixin":55,"../../common/animation/animation-visualizer":90,"../modals/choose-animation-modal":77,fs:void 0,path:void 0,react:void 0}],58:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("../../atom-react/mixins/modal-mixin"),r=i(n),s=e("path"),l=i(s),d=e("fs"),u=i(d),c=e("../../common/modals/choose-audio-modal"),h=i(c),f=o["default"].createClass({displayName:"AudioView",mixins:[r["default"]],getInitialState:function(){return{key:0,content:this.props.content}},render:function(){var e={};try{u["default"].statSync(this.getUri())}catch(t){e={disabled:!0}}var i=e.disabled?o["default"].createElement("div",{className:"error-messages"},"No audio file by that name"):null;return o["default"].createElement("div",{style:{width:"100%"}},o["default"].createElement("div",{className:"block"},o["default"].createElement("div",{className:"fileBlock"},o["default"].createElement("button",{style:{"float":"right"},className:"btn",onClick:this.onChoose},"..."),o["default"].createElement("atom-text-editor",{ref:"editor",mini:!0},this.props.content)),i,o["default"].createElement("audio",{key:this.state.key++,controls:!0,style:{width:"100%",marginTop:5,marginBottom:5}},o["default"].createElement("source",{src:this.getUri(),type:"audio/mpeg"})),o["default"].createElement("br",null)))},getRoot:function(){return l["default"].resolve(this.props.projectRoot,"audio")},getUri:function(){var e=this.state.content.split("://");if(1===e.length){var t=l["default"].resolve(this.props.projectRoot,"audio",this.state.content);return t}if(2===e.length){var i=l["default"].resolve(this.props.projectRoot,"node_modules",e[0],"audio",e[1]);return i}},onChoose:function(){var e=this;this.createModal(o["default"].createElement(h["default"],{root:this.getRoot(),uri:this.getUri(),onChoose:function(t){var i=o["default"].findDOMNode(e.refs.editor);i.getModel().setText(t),e.state.content=t,e.setState(e.state)},onClose:function(){e.destroyModal()}}))},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor),i=t.getModel();this.disposable=i.onDidChange(function(){e.state.content=i.getText(),e.props.onChange(i.getText()),e.setState(e.state)})},componentWillUnmount:function(){this.disposable&&this.disposable.dispose()}});exports["default"]=function(e,t,i,a){return o["default"].createElement(f,{key:t,content:e,onChange:i,projectRoot:a})}},{"../../atom-react/mixins/modal-mixin":55,"../../common/modals/choose-audio-modal":102,fs:void 0,path:void 0,react:void 0}],59:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=o["default"].createClass({displayName:"BooleanView",getInitialState:function(){return{content:this.props.content}},render:function(){var e="btn selected",t="btn";return o["default"].createElement("div",{className:"block"},o["default"].createElement("div",{className:"btn-group"},o["default"].createElement("button",{className:this.state.content?e:t,onClick:this.toggle},"True"),o["default"].createElement("button",{className:this.state.content?t:e,onClick:this.toggle},"False")))},toggle:function(){this.state.content=!this.state.content,this.setState(this.state),this.props.onChange(this.state.content)}});exports["default"]=function(e,t,i){return o["default"].createElement(n,{key:t,content:e,onChange:i})}},{react:void 0}],60:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("../../atom-react/components/jibo-combo-box"),r=i(n);exports["default"]=function(e,t,i){for(var a=[],n={label:"None",display:"None",value:""},s=0;s<t.length;s++)if(t[s].value===e){n=t[s];break}for(var l=t.length,d=0;l>d;d++){var u=t[d];u.value===e.value&&(n.label=u.label,n.display=u.display,n.value=u.value),a.push({label:u.label,display:u.display,value:u.value})}return o["default"].createElement(r["default"],{data:a,init:n,onSelected:function(e){i(e.value)}})}},{"../../atom-react/components/jibo-combo-box":51,react:void 0}],61:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=o["default"].createClass({displayName:"FunctionView",getInitialState:function(){for(var e={isExpanded:!0},t=atom.grammars.getGrammars(),i=0;i<t.length;i++){var a=t[i];if("JavaScript"===a.name){e.javascriptGrammar=a;break}}return e},render:function(){return o["default"].createElement("atom-text-editor",{ref:"editor",style:{height:300,width:"100%"}},this.props.content)},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor),i=t.getModel();void 0!==this.state.javascriptGrammar&&i.setGrammar(this.state.javascriptGrammar),this.disposable=i.onDidChange(function(){e.props.onChange(i.getText())})},componentWillUnmount:function(){this.disposable&&this.disposable.dispose()}});exports["default"]=function(e,t,i){return o["default"].createElement(n,{key:t,content:e,onChange:i})}},{react:void 0}],62:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("./animation-view"),o=i(a),n=e("./audio-view"),r=i(n),s=e("./boolean-view"),l=i(s),d=e("./enum-view"),u=i(d),c=e("./function-view"),h=i(c),f=e("./int-view"),p=i(f),m=e("./number-view"),v=i(m),y=e("./rule-view"),g=i(y),b=e("./ssml-view"),k=i(b),M=e("./string-view"),E=i(M),w=e("./subtree-view"),S=i(w);exports["default"]={animation:o["default"],audio:r["default"],"boolean":l["default"],"enum":u["default"],"function":h["default"],"int":p["default"],number:v["default"],rule:g["default"],ssml:k["default"],string:E["default"],subtree:S["default"]}},{"./animation-view":57,"./audio-view":58,"./boolean-view":59,"./enum-view":60,"./function-view":61,"./int-view":63,"./number-view":64,"./rule-view":65,"./ssml-view":66,"./string-view":67,"./subtree-view":68}],63:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("../../atom-react/components/integer-input-view"),r=i(n);exports["default"]=function(e,t,i){return o["default"].createElement(r["default"],{style:{maxWidth:100},key:t,value:e,min:0,onChange:i})}},{"../../atom-react/components/integer-input-view":49,react:void 0}],64:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("../../atom-react/components/float-input-view"),r=i(n);exports["default"]=function(e,t,i){return o["default"].createElement(r["default"],{key:t,value:e,onChange:i})}},{"../../atom-react/components/float-input-view":48,react:void 0}],65:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("../../atom-react/mixins/modal-mixin"),r=i(n),s=e("path"),l=i(s),d=e("fs"),u=i(d),c=e("../modals/choose-rule-modal"),h=i(c),f=o["default"].createClass({displayName:"RuleView",mixins:[r["default"]],getInitialState:function(){return{key:0,content:this.props.content}},render:function(){var e={};try{u["default"].statSync(this.getUri())}catch(t){e={disabled:!0}}var i=e.disabled?o["default"].createElement("div",{className:"error-messages"},"No rule file by that name"):null;return o["default"].createElement("div",{style:{width:"100%"}},o["default"].createElement("div",{className:"block"},o["default"].createElement("div",{className:"fileBlock"},o["default"].createElement("button",{style:{"float":"right"},className:"btn",onClick:this.onChoose},"..."),o["default"].createElement("atom-text-editor",{ref:"editor",mini:!0},this.props.content)),i,o["default"].createElement("br",null)))},getRoot:function(){return l["default"].resolve(this.props.projectRoot,"rules")},getUri:function(){var e=this.state.content.split("://");if(1===e.length){var t=l["default"].resolve(this.props.projectRoot,"rules",this.state.content);return t}if(2===e.length){var i=l["default"].resolve(this.props.projectRoot,"node_modules",e[0],"rules",e[1]);return i}},onChoose:function(){var e=this;this.createModal(o["default"].createElement(h["default"],{root:this.getRoot(),uri:this.getUri(),onChoose:function(t){var i=o["default"].findDOMNode(e.refs.editor);i.getModel().setText(t),e.state.content=t,e.setState(e.state)},onClose:function(){e.destroyModal()}}))},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor),i=t.getModel();i.onDidChange(function(){e.state.content=i.getText(),e.props.onChange(i.getText()),e.setState(e.state)})}});exports["default"]=function(e,t,i,a){return o["default"].createElement(f,{key:t,content:e,onChange:i,projectRoot:a})}},{"../../atom-react/mixins/modal-mixin":55,"../modals/choose-rule-modal":78,fs:void 0,path:void 0,react:void 0}],66:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("../../toolbar/run-configuration"),r=i(n),s=atom.grammars.getGrammars(),l=void 0;s.forEach(function(e){"XML"===e.name&&(l=e)});var d=o["default"].createClass({displayName:"SSMLView",onMouseDown:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor),i=t.getModel();if(!this.speaking){var a={duration_stretch:1,locale:"en-us",mode:"text",outputMode:"stream",pitch:.42,pitchBandwidth:.25,prompt:i.getText(),voice:"griffin"},n="http://"+r["default"].host+":8089/";this.speaking=!0,this._send(n+"tts_stop","GET",{},function(){e._send(n+"tts_speak","POST",a,function(){e.speaking=!1})})}},_send:function(e,t,i,a){var o=new XMLHttpRequest;o.open(t,e,!0),o.onreadystatechange=function(){4!=o.readyState||204!==o.status&&200!==o.status?4==o.readyState&&0==o.status&&a():a()},o.send(JSON.stringify(i))},render:function(){return o["default"].createElement("div",null,o["default"].createElement("atom-text-editor",{ref:"editor",style:{height:200,width:"100%"}},this.props.content),o["default"].createElement("div",{className:"block"},o["default"].createElement("button",{onMouseDown:this.onMouseDown,className:"btn inline-block-tight"},o["default"].createElement("i",{"class":"fa fa-volume-up"}),"Test Speech")))},componentDidMount:function(){var e=this;this.speaking=!1;var t=o["default"].findDOMNode(this.refs.editor),i=t.getModel();i.setGrammar(l),this.disposable=i.onDidChange(function(){e.props.onChange(i.getText())})},componentWillUnmount:function(){this.disposable&&this.disposable.dispose()}});exports["default"]=function(e,t,i){return o["default"].createElement(d,{key:t,content:e,onChange:i})}},{"../../toolbar/run-configuration":115,react:void 0}],67:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=o["default"].createClass({displayName:"StringView",render:function(){return o["default"].createElement("div",{style:{width:"100%"}},o["default"].createElement("atom-text-editor",{ref:"editor",mini:!0},this.props.content))},onChange:function(e){console.log(e.nativeEvent)},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor),i=t.getModel();this.disposable=i.onDidChange(function(){e.props.onChange(i.getText())})},componentWillUnmount:function(){this.disposable&&this.disposable.dispose()}});exports["default"]=function(e,t,i){return o["default"].createElement(n,{key:t,content:e,onChange:i})}},{react:void 0}],68:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},o=e("react"),n=i(o),r=e("../../atom-react/mixins/modal-mixin"),s=i(r),l=e("path"),d=i(l),u=e("fs"),c=i(u),h=e("mkdirp"),f=i(h),p=e("../modals/choose-subtree-modal"),m=i(p),v=e("../behavior-editor"),y=i(v);n["default"].createClass({getInitialState:function(){return{uri:""}},render:function(){return n["default"].createElement("div",null,n["default"].createElement("atom-text-editor",{ref:"editor",mini:!0}))},componentDidMount:function(){var e=this,t=n["default"].findDOMNode(this.refs.editor),i=atom.commands.add(t,{"core:cancel":function(){e.props.onClose(),i.dispose()},"core:confirm":function(){e.props.onConfirm(e.state.uri),i.dispose()}}),a=t.getModel();this.disposable=a.onDidChange(function(){e.state.uri=a.getText()})},componentWillUnmount:function(){this.disposable&&this.disposable.dispose()}});var g=n["default"].createClass({displayName:"SubtreeView",mixins:[s["default"]],getInitialState:function(){return{key:0,content:this.props.content}},render:function(){var e={};try{c["default"].statSync(this.getUri())}catch(t){try{c["default"].statSync(this.getUri()+".bt")}catch(t){e={disabled:!0}}}var i=e.disabled?n["default"].createElement("div",{className:"error-messages"},"No tree by that name"):null;return e.disabled||(e=this.state.content.split("://").length>1?{disabled:!0}:{}),n["default"].createElement("div",{style:{width:"100%"}},n["default"].createElement("div",{className:"block"},n["default"].createElement("div",{className:"fileBlock"},n["default"].createElement("button",{style:{"float":"right"},className:"btn",onClick:this.onChoose},"..."),n["default"].createElement("atom-text-editor",{ref:"editor",mini:!0},this.props.content)),i,n["default"].createElement("div",{className:"btn-group",style:{marginTop:5}},n["default"].createElement("button",a({},e,{className:"btn",onClick:this.onOpen}),"Edit"),n["default"].createElement("button",{className:"btn",onClick:this.onNew},"New"))))},createNewTree:function(e,t){var i=this.props.model.createNewElement(this.props.model.schema[t]),a=d["default"].resolve(this.props.projectRoot,"behaviors",e),o={};o[i.id]=i,f["default"].sync(d["default"].dirname(a)),c["default"].writeFileSync(a,JSON.stringify(o,null,"    "),"utf8"),atom.workspace.open(a)},onNew:function(){var e=this;y["default"].createNewFile(function(t){var i=n["default"].findDOMNode(e.refs.editor);i.getModel().setText(t)})},getRoot:function(){var e=d["default"].resolve(this.props.projectRoot,"behaviors");return e},getUri:function(){var e=this.state.content.split("://"),t=void 0;return 1===e.length?t=d["default"].resolve(this.props.projectRoot,"behaviors",this.state.content):2===e.length&&(t=d["default"].resolve(this.props.projectRoot,"node_modules",e[0],"behaviors",e[1])),""===d["default"].parse(t).ext&&(t+=".bt"),t},onOpen:function(){atom.workspace.open(this.getUri())},onChoose:function(){var e=this;this.createModal(n["default"].createElement(m["default"],{root:this.getRoot(),uri:this.getUri(),onChoose:function(t){var i=n["default"].findDOMNode(e.refs.editor);i.getModel().setText(t),e.state.content=t,e.setState(e.state)},onClose:function(){e.destroyModal()}}))},componentDidMount:function(){var e=this,t=n["default"].findDOMNode(this.refs.editor),i=t.getModel();i.onDidChange(function(){e.state.content=i.getText(),e.props.onChange(i.getText()),e.setState(e.state)})}});exports["default"]=function(e,t,i,a,o){return n["default"].createElement(g,{key:t,content:e,onChange:i,projectRoot:a,model:o})}},{"../../atom-react/mixins/modal-mixin":55,"../behavior-editor":71,"../modals/choose-subtree-modal":79,fs:void 0,mkdirp:void 0,path:void 0,react:void 0}],69:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("./arguments"),r=i(n);exports["default"]=o["default"].createClass({displayName:"behavior-arguments-view",propTypes:{behavior:o["default"].PropTypes.object.isRequired,schema:o["default"].PropTypes.object.isRequired},getDefaultProps:function(){return{}},getInitialState:function(){return{key:0}},onChange:function(e,t){this.props.behavior.options[e]=t},render:function(){var e=this,t=[];void 0!==this.props.behavior&&this.props.behavior.options&&!function(){var i=e.props.model.getSchemaByElement(e.props.behavior),a=e.props.behavior;Object.keys(a.options).forEach(function(n,s){var l=a.options[n],d=i.options[s].type,u=void 0;if(Array.isArray(d)){var c=d[0];"enum"===c&&(u=r["default"]["enum"](l,d.slice(1),e.onChange.bind(e,n)))}else u=r["default"][d.toLowerCase()](l,e.state.key++,e.onChange.bind(e,n),e.props.projectRoot,e.props.model);t.push(o["default"].createElement("p",{key:e.state.key++},i.options[s].field+": "+i.options[s].description)),t.push(u),t.push(o["default"].createElement("hr",{key:e.state.key++}))})}();var i=this.props.isBehaviorArgs?"Behavior Arguments":"Decorator Arguments";return o["default"].createElement("div",{className:"right-pane",ref:"rightPane"},o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px"}},o["default"].createElement("h2",{
style:{textAlign:"center",marginTop:"6px",marginBottom:"6px"}},i)),o["default"].createElement("div",{className:"arguments-scroll-container"},t))},componentDidMount:function(){}})},{"./arguments":62,react:void 0}],70:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a,o=function x(e,t,i){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,t);if(void 0===a){var o=Object.getPrototypeOf(e);return null===o?void 0:x(o,t,i)}if("value"in a)return a.value;var n=a.get;if(void 0!==n)return n.call(i)},n=e("react"),r=i(n),s=e("./tree-view"),l=i(s),d=e("./decorator-model"),u=i(d),c=e("marked"),h=i(c),f=e("../common/layout/layout"),p=i(f),m=e("../common/layout/h-layout"),v=i(m),y=e("../common/layout/v-layout"),g=i(y),b=e("./behavior-arguments-view"),k=i(b),M=e("../atom-react/mixins/pane-resize-event-mixin"),E=i(M),w=e("../atom-react/mixins/modal-mixin"),S=i(w),D=e("atom"),C=e("../common/undo-redo"),N=i(C),_=e("./modals/behavior-selector-modal"),O=i(_);exports["default"]=r["default"].createClass(a={displayName:"BehaviorEditorView",mixins:[E["default"],S["default"]],getInitialState:function(){var e=this.props.editor.schema,t=this.props.editor.model;return t.on("ondatachanged",this.onModelChanged),this.undoredo=new N["default"](t),{schema:e,model:t,decoratorModel:new u["default"](t),behavior:t.getRoot(),hoveredBehavior:void 0,hoveredDecorator:void 0,lastHovered:void 0,decoratorTreeKey:0}},onBehaviorRowHover:function(e){this.state.hoveredBehavior=e,this.state.lastHovered=this.state.hoveredBehavior},onBehaviorRowHoverLeave:function(){this.state.lastHovered=this.state.hoveredBehavior,this.state.hoveredBehavior=void 0},onDecoratorRowHover:function(e){this.state.hoveredDecorator=e,this.state.lastHovered=this.state.hoveredDecorator},onDecoratorRowHoverLeave:function(){this.state.lastHovered=this.state.hoveredDecorator,this.state.hoveredDecorator=void 0},addDecorator:function(){var e=this;this.state.lastHovered&&!function(){var t=e.state.lastHovered.props.element;e.chooseDecorator(function(i,a){e.state.model.addDecoratorAbove(t,0,i,a)})}()},addSiblingAbove:function(){var e=this;this.state.lastHovered&&(this.state.lastHovered.props.isBehavior?!function(){var t=e.state.lastHovered.props.element,i=e.state.lastHovered.props.row;e.chooseBehavior(function(a,o){e.state.model.addSiblingAbove(t,i,a,o)})}():!function(){var t=e.state.decoratorModel.owner,i=e.state.lastHovered.props.row;e.chooseDecorator(function(a,o){e.state.model.addDecoratorAbove(t,i,a,o)})}())},addSiblingBelow:function(){var e=this;this.state.lastHovered&&(this.state.lastHovered.props.isBehavior?!function(){var t=e.state.lastHovered.props.element,i=e.state.lastHovered.props.row;e.chooseBehavior(function(a,o){e.state.model.addSiblingBelow(t,i,a,o)})}():!function(){var t=e.state.decoratorModel.owner,i=e.state.lastHovered.props.row;e.chooseDecorator(function(a,o){e.state.model.addDecoratorBelow(t,i,a,o)})}())},addChild:function(){var e=this;this.state.lastHovered&&!function(){var t=e.state.lastHovered.props.element;e.chooseBehavior(function(i,a){e.state.model.addChild(t,i,a)})}()},swap:function(){var e=this;this.state.lastHovered&&!function(){var t=e.state.lastHovered.props.element;e.chooseBehavior(function(i,a){e.state.model.swap(t,i,a)})}()},moveUp:function(){if(this.state.lastHovered){var e=this.state.lastHovered.props.row,t=this.state.lastHovered.props.element;this.state.lastHovered.props.isBehavior?this.state.model.moveUp(t,e):this.state.decoratorModel.moveUp(t,e)}},moveDown:function(){if(this.state.lastHovered){var e=this.state.lastHovered.props.row,t=this.state.lastHovered.props.element;this.state.lastHovered.props.isBehavior?this.state.model.moveDown(t,e):this.state.decoratorModel.moveDown(t,e)}},editDescription:function(){if(this.state.lastHovered){var e=this.state.lastHovered.props.element;this.state.lastHovered.props.isBehavior?this._editBehaviorDescription(e):this._editDecoratorDescription(e)}},onModelChanged:function(){this.props.editor.checkModified(),this.setState(this.state)},onBehaviorRowSelected:function(e){e!==this.state.model.behavior&&(this.state.model.setRenderDescription(void 0),this.state.decoratorModel.setRenderDescription(void 0)),this.state.model.setSelectedElement(e),this.setState(this.state)},onDecoratorRowSelected:function(e){e!==this.state.model.behavior&&(this.state.model.setRenderDescription(void 0),this.state.decoratorModel.setRenderDescription(void 0)),this.state.decoratorModel.setSelectedElement(e),this.setState(this.state)},onRowDoubleClicked:function(e){this._editBehaviorDescription(e.props.element)},_editBehaviorDescription:function(e){this.state.model.setRenderDescription(e),this.state.decoratorModel.setRenderDescription(void 0),this.setState(this.state)},onDecoratorRowDoubleClicked:function(e){this._editDecoratorDescription(e.props.element)},_editDecoratorDescription:function(e){this.state.model.setRenderDescription(void 0),this.state.decoratorModel.setRenderDescription(e),this.setState(this.state)},dispose:function(){this.saveUiState(this.layout)},serialize:function(){return this.saveUiState(this.layout),o(Object.getPrototypeOf(a),"serialize",this).call(this)},render:function(){if(this.state.model.installJibo){var e="Please make sure the jibo module is installed in this project using `npm install jibo --save`.\nOtherwise, the behavior editor cannot render the behaviors.";return r["default"].createElement("ul",{className:"background-message centered"},r["default"].createElement("div",{style:{padding:20},dangerouslySetInnerHTML:{__html:(0,h["default"])(e,{sanitize:!0})}}))}var t=this.state.model.getData();if(void 0===t){var i="Error parsing JSON data. This is likely caused by hand-editing behavior tree JSON or unresolved merge conflicts.";return r["default"].createElement("ul",{className:"background-message centered"},r["default"].createElement("li",null,i))}var a=this.props.editor,o=a.getNewSchema(a.uri),n={},s={};if(Object.keys(t).forEach(function(e){if("meta"!==e){var i=t[e],a=i["asset-pack"]?i["asset-pack"]:"core";o[a]?o[a].schema[i["class"]]||(s[i["class"]]=!0):n[a]=!0}}),n=Object.keys(n),s=Object.keys(s),n.length>0||s.length>0){var d=null;n.length&&!function(){var e=[];n.forEach(function(t){e.push(r["default"].createElement("li",{style:{paddingLeft:15},className:"list-item"},r["default"].createElement("span",{className:"icon icon-file-submodule"},t)))}),d=[r["default"].createElement("h1",null,"Missing Asset Packs"),r["default"].createElement("h2",null,"Make sure these following asset packs are in the package.json and have been installed"),{assetPacksList:e}]}();var u=null;return s.length&&!function(){var e=[];s.forEach(function(t){e.push(r["default"].createElement("li",{style:{paddingLeft:15},className:"list-item"},r["default"].createElement("span",{className:"icon icon-file-text"},t)))}),u=[r["default"].createElement("h1",null,"Missing Behaviors"),r["default"].createElement("h2",null,"Make sure the following behaviors are included in your schemas folder"),{behaviorList:e}]}(),r["default"].createElement("div",null,r["default"].createElement("ul",{className:"list-group",style:{paddingLeft:20}},d,u))}return r["default"].createElement("div",{tabIndex:"-1"},r["default"].createElement(p["default"],{ref:"topLevel",width:this.props.paneWidth,height:this.props.paneHeight-40,serialized:this.props.editor.layout},r["default"].createElement(v["default"],null,r["default"].createElement(g["default"],null,r["default"].createElement(l["default"],{showRoot:!0,model:this.state.model,onRowSelected:this.onBehaviorRowSelected,onRowDoubleClicked:this.onRowDoubleClicked,onRowHover:this.onBehaviorRowHover,onRowHoverLeave:this.onBehaviorRowHoverLeave,rowClassName:"behavior",isBehavior:!0}),r["default"].createElement(l["default"],{key:this.state.decoratorTreeKey,showRoot:!1,model:this.state.decoratorModel,onRowSelected:this.onDecoratorRowSelected,onRowDoubleClicked:this.onDecoratorRowDoubleClicked,onRowHover:this.onDecoratorRowHover,onRowHoverLeave:this.onDecoratorRowHoverLeave,rowClassName:"decorator",isBehavior:!1})),r["default"].createElement(g["default"],null,r["default"].createElement(k["default"],{schema:this.state.schema,model:this.state.model,behavior:this.state.model.getSelectedBehavior(),isBehaviorArgs:!0,projectRoot:this.props.editor.projectRoot}),r["default"].createElement(k["default"],{schema:this.state.schema,model:this.state.model,behavior:this.state.model.getSelectedDecorator(),isBehaviorArgs:!1,projectRoot:this.props.editor.projectRoot})))))},chooseBehavior:function(e){var t=this;this.createModal(r["default"].createElement(O["default"],{schema:this.state.schema,types:["leaf","composite"],onChoose:function(t,i){e(t,i)},onClose:function(){t.destroyModal()}}))},chooseDecorator:function(e){var t=this;this.createModal(r["default"].createElement(O["default"],{schema:this.state.schema,types:["decorator"],onChoose:function(t,i){e(t,i)},onClose:function(){t.destroyModal()}}))},undo:function(){this.undoredo.undo()},redo:function(){this.undoredo.redo()},componentDidMount:function(){this.setupPaneResizeEventMixin(),this.disposable=new D.CompositeDisposable,this.disposable.add(atom.commands.add(this.getDOMNode(),{"jibo-sdk:add-decorator":this.addDecorator,"jibo-sdk:add-sibling-above":this.addSiblingAbove,"jibo-sdk:add-sibling-below":this.addSiblingBelow,"jibo-sdk:add-child":this.addChild,"jibo-sdk:swap-behavior":this.swap,"jibo-sdk:move-up-behavior":this.moveUp,"jibo-sdk:move-down-behavior":this.moveDown,"jibo-sdk:edit-description":this.editDescription,"core:undo":this.undo,"core:redo":this.redo})),this.state.model.setSelectedElement(this.state.model.getRoot())},componentWillUnmount:function(){this.disposable.dispose(),this.cleanupPaneResizeEventMixin()}})},{"../atom-react/mixins/modal-mixin":55,"../atom-react/mixins/pane-resize-event-mixin":56,"../common/layout/h-layout":98,"../common/layout/layout":99,"../common/layout/v-layout":100,"../common/undo-redo":104,"./behavior-arguments-view":69,"./decorator-model":73,"./modals/behavior-selector-modal":76,"./tree-view":87,atom:void 0,marked:void 0,react:void 0}],71:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=function x(e,t,i){null===e&&(e=Function.prototype);var a=Object.getOwnPropertyDescriptor(e,t);if(void 0===a){var o=Object.getPrototypeOf(e);return null===o?void 0:x(o,t,i)}if("value"in a)return a.value;var n=a.get;if(void 0!==n)return n.call(i)},l=e("fs"),d=i(l),u=e("path"),c=i(u),h=e("../atom-react/core/react-editor"),f=i(h),p=e("./behavior-editor-view"),m=i(p),v=e("./tree-model"),y=i(v),g=e("../common/tree-view-helper"),b=i(g),k=e("lodash"),M=i(k),E=e("./schema-reader"),w=i(E),S=e("./behavior-reader"),D=i(S),C=e("crypto"),N="win32"===process.platform?process.env.HOMEPATH:process.env.HOME,_=c["default"].resolve(N,".jibo");d["default"].existsSync(_)||d["default"].mkdirSync(_);var O=c["default"].resolve(_,"temp");d["default"].existsSync(O)||d["default"].mkdirSync(O);var BehaviorEditor=function(t){function BehaviorEditor(e){a(this,BehaviorEditor);var t=o(this,Object.getPrototypeOf(BehaviorEditor).call(this,"BehaviorEditor",e,!1));t.projectRoot=f["default"].getProjectRoot(e),t.ignoreNextSave=!1,t.schema=(new w["default"]).getNewSchema(e),t.data=new D["default"](t.schema).read(e);var i=t.getUiState();return t.layout=i?i:[],t.model=new y["default"](t.data,t.schema,e),t.lastSaved=JSON.stringify(t.model.data),t.onReload=t.onReload.bind(t),t}return n(BehaviorEditor,t),r(BehaviorEditor,[{key:"backup",value:function(e){var t=M["default"].cloneDeep(this.model.data),i=C.createHash("md5");i.update(e);for(var a=i.digest("hex"),o=c["default"].basename(a),n=O+"/"+o+".backup",r=Object.keys(t),s=0;s<r.length;s++)for(var l=t[r[s]],u=0;u<l.args.length;u++)"string"==typeof l.args[u]&&(0===l.args[u].indexOf("function")||l.args[u].indexOf("=>")>=0)&&(l.args[u]=l.args[u].split("\n"));d["default"].writeFileSync(n,JSON.stringify(t,null,"    "),"utf8")}},{key:"saveFile",value:function(e){if(!BehaviorEditor.isValidDirectory(e))return alert('You must save behavior trees under the "behaviors" folder.'),!1;this.ignoreNextSave=!0,this.lastSaved=JSON.stringify(this.model.data);for(var t=M["default"].cloneDeep(this.model.data),i=Object.keys(t),a=0;a<i.length;a++)if("meta"!==i[a])for(var o=t[i[a]],n=Object.keys(o.options),r=0;r<n.length;r++){var s=n[r];"string"==typeof o.options[s]&&(0===o.options[s].indexOf("function")||o.options[s].indexOf("=>")>=0)&&(o.options[s]=o.options[s].split("\n"))}return d["default"].writeFileSync(e,JSON.stringify(t,null,"    "),"utf8"),!0}},{key:"checkModified",value:function(){var e=JSON.stringify(this.model.data);return e!==this.lastSaved?(this.setModifiedStatus(!0),!0):(this.setModifiedStatus(!1),!1)}},{key:"serialize",value:function(){return this.saveUiState(this.layout),s(Object.getPrototypeOf(BehaviorEditor.prototype),"serialize",this).call(this)}},{key:"dispose",value:function(){this.saveUiState(this.layout),s(Object.getPrototypeOf(BehaviorEditor.prototype),"dispose",this).call(this)}},{key:"getReactClass",value:function(){return m["default"]}},{key:"getNewSchema",value:function(e){return(new w["default"]).getNewSchema(e)}},{key:"onReload",value:function(){this.reload()}},{key:"reload",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.uri:arguments[0];return this.ignoreNextSave?void(this.ignoreNextSave=!1):(this.data=new D["default"](this.schema).read(e),this.model.reload(this.data,this.schema),void this.model.emit("ondatachanged"))}},{key:"getSaveDialogOptions",value:function(){return{title:"Behavior Save As",filters:BehaviorEditor.getDialogFilter()}}}],[{key:"createNewFile",value:function(t){var i=b["default"].getFolderPathWithDirectory(b["default"].getFolderPathOfSelection(),"behaviors");if(!i)return void alert("You must have a valid project loaded in order to create a new behavior tree file.");var a=atom.getCurrentWindow(),o=e("remote"),n=o.require("dialog");n.showSaveDialog(a,{title:"New Behavior Tree",defaultPath:i,filters:BehaviorEditor.getDialogFilter()},function(e){if(e){if(BehaviorEditor.isValidDirectory(e)){var i=(new w["default"]).getNewSchema(e);y["default"].createNewFile(e,i.core.schema.Sequence),atom.workspace.open(e)}else alert('You must save behavior trees under the "behaviors" folder.');if(t){var a=f["default"].getProjectRoot(e),o=c["default"].join(a,"behaviors");t(c["default"].relative(o,e.toLowerCase()))}}})}},{key:"isValidDirectory",value:function(e){var t=c["default"].normalize("/behaviors/");return!!e.includes(t)}},{key:"getDialogFilter",value:function(){return[{name:"Behavior Tree",extensions:["bt"]}]}}]),BehaviorEditor}(f["default"]);exports["default"]=BehaviorEditor,atom.deserializers.add({deserialize:f["default"].deserialize.bind(BehaviorEditor),name:"BehaviorEditor"})},{"../atom-react/core/react-editor":53,"../common/tree-view-helper":103,"./behavior-editor-view":70,"./behavior-reader":72,"./schema-reader":80,"./tree-model":81,crypto:void 0,fs:void 0,lodash:void 0,path:void 0,remote:void 0}],72:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=e("fs"),r=i(n),s=function(){function t(e){a(this,t),this.schema=e}return o(t,[{key:"_getSchemaByElement",value:function(e){if(!e["asset-pack"]){var t=this.schema.core.schema[e["class"]];return t||(t=this.schema.project.schema[e["class"]]),t}var i=e["asset-pack"];return this.schema[i].schema[e["class"]]}},{key:"_update01",value:function(t){var i=this;t.meta||!function(){var a=e("behaviorify/lib/core");t.meta={version:1},Object.keys(t).forEach(function(e){if("meta"!==e){var o=t[e],n=i._getSchemaByElement(o),r={};n.options.forEach(function(t,i){a[e]?r[a[e][i]]=o.args[i]:r[t.field]=o.args[i]}),delete o.args,o.options=r}})}()}},{key:"_update",value:function(e){this._update01(e)}},{key:"read",value:function(e){var t=void 0;try{t=JSON.parse(r["default"].readFileSync(e,"utf8"))}catch(i){return void console.error(i)}return this._update(t),Object.keys(t).forEach(function(e){if("meta"!==e){var i=t[e];Object.keys(i.options).forEach(function(e){Array.isArray(i.options[e])&&(i.options[e]=i.options[e].join("\n"))})}}),t}}]),t}();exports["default"]=s},{"behaviorify/lib/core":void 0,fs:void 0}],73:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=e("react"),l=i(s),d=e("./event-emitter"),u=i(d),c=e("./description-editor"),h=i(c),f=function(e){function t(e){a(this,t);var i=o(this,Object.getPrototypeOf(t).call(this));return i.model=e,i.root={id:"root"},i._clearDescription(),i}return n(t,e),r(t,[{key:"setSelectedElement",value:function(e){this.model.setSelectedDecorator(e)}},{key:"isSelected",value:function(e){return e&&this.model.selectedDecorator&&e.id===this.model.selectedDecorator.id}},{key:"getParent",value:function(e){return e!==this.root?this.root:void 0}},{key:"getHeaderLabel",value:function(e){switch(e){case 0:return"";case 1:return"";case 2:return"Decorator Type";case 3:return"Description"}}},{key:"moveRow",value:function(e,t,i){var a=this.owner,o=0;for(o=0;o<a.decorators.length&&a.decorators[o]!==e.id;o++);a.decorators.splice(o,1),a.decorators.splice(i,0,e.id),this.model.emit("ondatachanged")}},{key:"moveUp",value:function(e,t){this.canMoveUp(e,t)&&(this.moveRow(e,void 0,t-1),this.model.addRedoUndoEntry())}},{key:"canMoveUp",value:function(e,t){return 0!==t}},{key:"moveDown",value:function(e,t){this.canMoveDown(e,t)&&(this.moveRow(e,void 0,t+1),this.model.addRedoUndoEntry())}},{key:"canMoveDown",value:function(e,t){return t<this.owner.decorators.length-1}},{key:"getRowCount",value:function(){return this.model.selectedElement&&this.model.selectedElement.decorators?this.model.selectedElement.decorators.length:0}},{key:"getColumnCount",value:function(){return 4}},{key:"hasChildren",value:function(e){return e?"root"===e.id:!1}},{key:"isSkipped",value:function(e){return e.skipped}},{key:"shouldNotIndent",value:function(e){return 0===e}},{key:"getChildElement",value:function(e,t){return this.model.data[this.model.selectedElement.decorators[t]]}},{key:"canHaveChildren",value:function(e){return e?"root"===e.id:!1}},{key:"deleteDecorator",value:function(e,t){this.model.selectedElement&&this.model.deleteDecorator(this.model.selectedElement,t)}},{key:"deleteRow",value:function(e,t){this.deleteDecorator(e,t)}},{key:"setRenderDescription",value:function(e){this._setAndClearDescriptionElement(),this.description.element=e,this.description.newValue=void 0}},{key:"_setAndClearDescriptionElement",value:function(){void 0!==this.description.element&&this.description.newValue!==this.description.element.name&&(this.description.element.name=this.description.newValue,this.model.addRedoUndoEntry()),this._clearDescription()}},{key:"_clearDescription",value:function(){this.description={element:void 0,newValue:void 0}}},{key:"getLabel",value:function(e,t,i,a){var o=this;if(!e)return"";if(0===t)return String(a);if("root"===e.id)return"";switch(t){case 1:var n=e["class"],r="",s={};this.isSelected(e)&&(r="row-selected-text");var d={};return e.skipped?(d={className:"fa fa-eye-slash",style:{color:"#555555"}},s={"font-style":"italic",color:"#555555"}):d={className:"fa fa-bell",style:{color:"#cd0a0a"}},l["default"].createElement("p",{className:r,style:s},l["default"].createElement("i",d),"       ",n);case 2:return e===this.description.element?l["default"].createElement(h["default"],{content:e.name,onChange:function(e){o.description.newValue=e},width:i,onConfirm:function(){o._setAndClearDescriptionElement(),o.model.emit("ondatachanged")}}):e.name}}},{key:"up",value:function(){this.model.upDecorator()}},{key:"down",value:function(){this.model.downDecorator()}},{key:"copy",value:function(){this.model.copyDecorator()}},{key:"cut",value:function(){this.model.cutDecorator()}},{key:"paste",value:function(){this.model.pasteDecorator()}},{key:"skip",value:function(){this.model.skipDecorator(),this.model.addRedoUndoEntry()}},{key:"getRoot",value:function(){return this.root}},{key:"owner",get:function(){return this.model.selectedElement}}]),t}(u["default"]);exports["default"]=f},{"./description-editor":74,"./event-emitter":75,react:void 0}],74:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a);exports["default"]=o["default"].createClass({displayName:"description-editor",render:function(){return o["default"].createElement("atom-text-editor",{style:{width:this.props.width},ref:"editor",mini:!0,height:25},this.props.content)},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor);t.focus();var i=atom.commands.add(t,"core:confirm",function(){e.props.onConfirm(),i.dispose()}),a=t.getModel();a.onDidChange(function(){e.props.onChange(a.getText())})}})},{react:void 0}],75:[function(e,t,exports){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),o=function(){function e(){i(this,e),this._events={}}return a(e,[{key:"on",value:function(e,t){if("function"!=typeof t)throw new TypeError;var i=this._events[e]||(this._events[e]=[]);return-1!=i.indexOf(t)?this:(i.push(t),this)}},{key:"once",value:function(e,t){function i(){a.off(e,i),t.apply(null,arguments)}var a=this;return this.on(e,i)}},{key:"off",value:function(e){arguments.length-1==0&&(this._events[e]=null);var t=arguments.length<=1?void 0:arguments[1];if("function"!=typeof t)throw new TypeError;var i=this._events[e];if(!i||!i.length)return this;var a=i.indexOf(t);return-1==a?this:(i.splice(a,1),this)}},{key:"emit",value:function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),a=1;t>a;a++)i[a-1]=arguments[a];var o=this._events[e];return o&&o.length?(o.forEach(function(e){return e.apply(null,i)}),!0):!1}}]),e}();exports["default"]=o},{}],76:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("atom"),r=e("marked"),s=i(r);exports["default"]=o["default"].createClass({displayName:"behavior-selector-modal",onChoose:function(){this.props.onChoose(this.state.currentAssetPackId,this.state.currentBehavior),this.props.onClose()},onCancel:function(){this.props.onClose()},getLength:function(){return Object.keys(this.behaviorToIndexMap).length},_moveUp:function(){var e=this._getIndexFromBehaviorName(this.state.currentBehavior["class"]);0===e?e=this.getLength()-1:e--;var t=this._getBehaviorNameFromIndex(e),i=this.props.schema[this.state.currentAssetPackId].schema[t];(void 0!==t||t!==this.state.currentBehavior["class"])&&this.setState({currentBehavior:i})},_moveDown:function(){var e=this._getIndexFromBehaviorName(this.state.currentBehavior["class"]);e===this.getLength()-1?e=0:e++;var t=this._getBehaviorNameFromIndex(e),i=this.props.schema[this.state.currentAssetPackId].schema[t];(void 0!==t||t!==this.state.currentBehavior["class"])&&this.setState({currentBehavior:i})},_getIndexFromBehaviorName:function(e){return this.behaviorToIndexMap[e]},_getBehaviorNameFromIndex:function(e){for(var t in this.behaviorToIndexMap)if(this.behaviorToIndexMap[t]===e)return t},getInitialState:function(){return{currentAssetPackId:"core",currentBehavior:"",filter:""}},onAssetPackSelected:function(e){this.state.currentBehavior=void 0,this.setState({currentAssetPackId:e})},onBehaviorSelected:function(e){this.setState({currentBehavior:e})},getPanelHeading:function(e){return o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px",width:"100%",height:30}},o["default"].createElement("p",{style:{textAlign:"center",marginTop:"4px",marginBottom:"4px"}},e))},render:function(){var e=this;this.behaviorToIndexMap={};for(var t=[],i=Object.keys(this.props.schema),a=[],n=0;n<i.length;n++){var r=i[n],l=this.props.schema[r],d="list-item";if(this.state.currentAssetPackId===r){d+=" selected";var u=Object.keys(l.schema);u=u.sort();for(var c=[],h=!1,f=0,p=0;p<u.length;p++){var m=u[p];m.toLowerCase().includes(this.state.filter.toLowerCase())?-1!==this.props.types.indexOf(l.schema[m].type)&&(this.behaviorToIndexMap[m]=f++,c.push(m)):this.state.currentBehavior&&this.state.currentBehavior["class"]===m&&(h=!0)}u=c;for(var v=function(t){var i=u[t],n=l.schema[i],r="list-item";e.state.currentBehavior&&!h||0!==t?e.state.currentBehavior["class"]===i&&(r+=" selected"):(e.state.currentBehavior=n,r+=" selected"),a.push(o["default"].createElement("li",{className:r,onClick:e.onBehaviorSelected.bind(e,n),onDoubleClick:function(){e.onBehaviorSelected(n),e.onChoose()}},o["default"].createElement("span",null,i)))},y=0;y<u.length;y++)v(y)}t.push(o["default"].createElement("li",{className:d,onClick:this.onAssetPackSelected.bind(this,r)},o["default"].createElement("span",null,l.displayName)))}var g=this.state.currentBehavior&&this.state.currentBehavior.description?(0,s["default"])(this.state.currentBehavior.description,{sanitize:!0}):"",b="Behavior";this.props.types.indexOf("decorator")>-1&&(b="Decorator");var k="Choose a "+b;return o["default"].createElement("div",{className:"behavior-selector-modal",ref:"modal"},o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px"}},o["default"].createElement("h2",{style:{textAlign:"center",marginTop:"6px",marginBottom:"6px"}},k)),o["default"].createElement("label",{style:{marginLeft:10}},"Search"),o["default"].createElement("atom-text-editor",{ref:"editor",style:{marginLeft:10,marginRight:10,marginBottom:10},mini:!0}),o["default"].createElement("div",{className:"contents"},o["default"].createElement("div",{className:"list-contents"},this.getPanelHeading("Asset Pack"),o["default"].createElement("div",{className:"list-group asset-pack",ref:"assetPackList"},t)),o["default"].createElement("div",{className:"list-contents"},this.getPanelHeading(b),o["default"].createElement("ul",{className:"list-group schema-list",ref:"schemaList"},a)),o["default"].createElement("div",{className:"description-contents"},this.getPanelHeading("Description"),o["default"].createElement("div",{className:"behavior-description"},o["default"].createElement("div",{dangerouslySetInnerHTML:{__html:g}})))),o["default"].createElement("div",{className:"btn-group"},o["default"].createElement("button",{className:"btn",onClick:this.onChoose},"Choose"),o["default"].createElement("button",{className:"btn",onClick:this.onCancel},"Cancel")))},onLeft:function(){var e=o["default"].findDOMNode(this.refs.assetPackList);e.focus()},onRight:function(){var e=o["default"].findDOMNode(this.refs.schemaList);e.focus()},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor),i=o["default"].findDOMNode(this.refs.schemaList),a=o["default"].findDOMNode(this.refs.assetPackList);setTimeout(function(){t.focus(),i.setAttribute("tabIndex",0),a.setAttribute("tabIndex",1),e.disposable=new n.CompositeDisposable,e.disposable.add(atom.commands.add(i,{"jibo-sdk:up":e._moveUp,"jibo-sdk:down":e._moveDown,"jibo-sdk:confirm":e.onChoose,"jibo-sdk:left":e.onLeft})),e.disposable.add(atom.commands.add(a,{"jibo-sdk:right":e.onRight})),e.disposable.add(atom.commands.add(e.getDOMNode(),{"jibo-sdk:escape":e.onCancel})),e.disposable=atom.commands.add(t,"jibo-sdk:confirm",function(){e.onChoose()})},100);var r=t.getModel();r.onDidChange(function(){e.setState({filter:r.getText()})})},componentWillUnmount:function(){this.disposable.dispose()}})},{atom:void 0,marked:void 0,react:void 0}],77:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("atom"),r=e("../../common/directory-tree-view"),s=i(r),l=e("path"),d=i(l),u=e("normalize-path"),c=i(u),h=e("../../common/get-asset-packs"),f=i(h),p=e("../../common/animation/animation-visualizer"),m=i(p);exports["default"]=o["default"].createClass({displayName:"choose-animation-modal",onChoose:function(){var e=this.state.currentAssetPack,t=d["default"].join(e.root,"animations"),i=d["default"].relative(t,this.state.currentAnimation);i=(0,c["default"])(i),"project"!==this.state.currentAssetPack.id&&(i=e.id+"://"+i),this.props.onChoose(i),this.props.onClose()},onCancel:function(){this.props.onClose()},getLength:function(){return Object.keys(this.behaviorToIndexMap).length},getInitialState:function(){return{currentAssetPack:{id:"project"},currentAnimation:"",filter:""}},onAssetPackSelected:function(e){this.setState({currentAssetPack:e})},onSelected:function(e){this.setState({currentAnimation:e})},getPanelHeading:function(e){return o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px",width:"100%",height:30}},o["default"].createElement("p",{style:{textAlign:"center",marginTop:"4px",marginBottom:"4px"}},e))},render:function(){for(var e=this,t=(0,f["default"])(this.props.root),i=void 0,a=[],n=0;n<t.length;n++){var r=t[n],l="list-item";this.state.currentAssetPack.id===r.id&&(this.state.currentAssetPack=r,i=r,l+=" selected"),a.push(o["default"].createElement("li",{className:l,onClick:this.onAssetPackSelected.bind(this,r)},o["default"].createElement("span",null,r.name)))}return o["default"].createElement("div",{className:"asset-selector-modal",ref:"modal"},o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px"}},o["default"].createElement("h2",{style:{textAlign:"center",marginTop:"6px",marginBottom:"6px"}},"Choose an Animation")),o["default"].createElement("label",{style:{marginLeft:10}},"Search"),o["default"].createElement("atom-text-editor",{
ref:"editor",style:{marginLeft:10,marginRight:10,marginBottom:10},mini:!0}),o["default"].createElement("div",{className:"contents"},o["default"].createElement("div",{className:"list-contents"},this.getPanelHeading("Asset Pack"),o["default"].createElement("div",{className:"list-group asset-pack",ref:"assetPackList"},a)),o["default"].createElement("div",{className:"list-contents"},this.getPanelHeading("Behavior"),o["default"].createElement("div",{className:"asset-list"},o["default"].createElement(s["default"],{uri:d["default"].resolve(i.root,"animations"),onChosen:function(t){e.onSelected(t),e.onChoose()},onSelected:this.onSelected,extension:[".keys",".anim"],filter:this.state.filter}))),o["default"].createElement("div",{className:"preview-contents"},this.getPanelHeading("Preview"),o["default"].createElement("div",{className:"asset-preview"},o["default"].createElement(m["default"],{uri:this.state.currentAnimation,style:{width:"100%",height:"100%"}})))),o["default"].createElement("div",{className:"btn-group"},o["default"].createElement("button",{className:"btn",onClick:this.onChoose},"Choose"),o["default"].createElement("button",{className:"btn",onClick:this.onCancel},"Cancel")))},onLeft:function(){var e=o["default"].findDOMNode(this.refs.assetPackList);e.focus()},onRight:function(){var e=o["default"].findDOMNode(this.refs.schemaList);e.focus()},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor);setTimeout(function(){t.focus(),e.disposable=new n.CompositeDisposable,e.disposable.add(atom.commands.add(e.getDOMNode(),{"jibo-sdk:escape":e.onCancel})),e.disposable=atom.commands.add(t,"jibo-sdk:confirm",function(){e.onChoose()})},100);var i=t.getModel();i.onDidChange(function(){e.setState({filter:i.getText()})})},componentWillUnmount:function(){this.disposable.dispose()}})},{"../../common/animation/animation-visualizer":90,"../../common/directory-tree-view":93,"../../common/get-asset-packs":95,atom:void 0,"normalize-path":void 0,path:void 0,react:void 0}],78:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("atom"),r=e("../../common/directory-tree-view"),s=i(r),l=e("path"),d=i(l),u=e("normalize-path"),c=i(u),h=e("../../common/get-asset-packs"),f=i(h);exports["default"]=o["default"].createClass({displayName:"choose-rule-modal",onChoose:function(){var e=this.state.currentAssetPack,t=d["default"].join(e.root,"rules"),i=d["default"].relative(t,this.state.currentRule);i=(0,c["default"])(i),"project"!==this.state.currentAssetPack.id&&(i=e.id+"://"+i),this.props.onChoose(i),this.props.onClose()},onCancel:function(){this.props.onClose()},getLength:function(){return Object.keys(this.behaviorToIndexMap).length},getInitialState:function(){return{currentAssetPack:{id:"project"},currentRule:"",filter:""}},onAssetPackSelected:function(e){this.setState({currentAssetPack:e})},onSelected:function(e){this.setState({currentRule:e})},getPanelHeading:function(e){return o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px",width:"100%",height:30}},o["default"].createElement("p",{style:{textAlign:"center",marginTop:"4px",marginBottom:"4px"}},e))},render:function(){for(var e=this,t=(0,f["default"])(this.props.root),i=void 0,a=[],n=0;n<t.length;n++){var r=t[n],l="list-item";this.state.currentAssetPack.id===r.id&&(this.state.currentAssetPack=r,i=r,l+=" selected"),a.push(o["default"].createElement("li",{className:l,onClick:this.onAssetPackSelected.bind(this,r)},o["default"].createElement("span",null,r.name)))}return o["default"].createElement("div",{className:"asset-selector-modal",ref:"modal"},o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px"}},o["default"].createElement("h2",{style:{textAlign:"center",marginTop:"6px",marginBottom:"6px"}},"Choose an Animation")),o["default"].createElement("label",{style:{marginLeft:10}},"Search"),o["default"].createElement("atom-text-editor",{ref:"editor",style:{marginLeft:10,marginRight:10,marginBottom:10},mini:!0}),o["default"].createElement("div",{className:"contents"},o["default"].createElement("div",{className:"list-contents"},this.getPanelHeading("Asset Pack"),o["default"].createElement("div",{className:"list-group asset-pack",ref:"assetPackList"},a)),o["default"].createElement("div",{className:"list-contents"},this.getPanelHeading("Rule"),o["default"].createElement("div",{className:"asset-list"},o["default"].createElement(s["default"],{uri:d["default"].resolve(i.root,"rules"),onChosen:function(t){e.onSelected(t),e.onChoose()},onSelected:this.onSelected,extension:[".grm",".rule",".nli"],filter:this.state.filter}))),o["default"].createElement("div",{className:"preview-contents"},this.getPanelHeading("Preview"),o["default"].createElement("div",{className:"asset-preview"},"Look for your grammar preview here!"))),o["default"].createElement("div",{className:"btn-group"},o["default"].createElement("button",{className:"btn",onClick:this.onChoose},"Choose"),o["default"].createElement("button",{className:"btn",onClick:this.onCancel},"Cancel")))},onLeft:function(){var e=o["default"].findDOMNode(this.refs.assetPackList);e.focus()},onRight:function(){var e=o["default"].findDOMNode(this.refs.schemaList);e.focus()},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor);setTimeout(function(){t.focus(),e.disposable=new n.CompositeDisposable,e.disposable.add(atom.commands.add(e.getDOMNode(),{"jibo-sdk:escape":e.onCancel})),e.disposable=atom.commands.add(t,"jibo-sdk:confirm",function(){e.onChoose()})},100);var i=t.getModel();i.onDidChange(function(){e.setState({filter:i.getText()})})},componentWillUnmount:function(){this.disposable.dispose()}})},{"../../common/directory-tree-view":93,"../../common/get-asset-packs":95,atom:void 0,"normalize-path":void 0,path:void 0,react:void 0}],79:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("atom"),r=e("../../common/directory-tree-view"),s=i(r),l=e("path"),d=i(l),u=e("normalize-path"),c=i(u),h=e("../../common/get-asset-packs"),f=i(h);exports["default"]=o["default"].createClass({displayName:"choose-subtree-modal",onChoose:function(){var e=this.state.currentAssetPack,t=d["default"].join(e.root,"behaviors"),i=d["default"].relative(t,this.state.currentTree);i=(0,c["default"])(i),"project"!==this.state.currentAssetPack.id&&(i=e.id+"://"+i),this.props.onChoose(i),this.props.onClose()},onCancel:function(){this.props.onClose()},getInitialState:function(){return{currentAssetPack:{id:"project"},currentTree:"",filter:"",key:0}},onAssetPackSelected:function(e){this.setState({currentAssetPack:e})},onSelected:function(e){console.log(e),this.setState({currentTree:e})},getPanelHeading:function(e){return o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px",width:"100%",height:30}},o["default"].createElement("p",{style:{textAlign:"center",marginTop:"4px",marginBottom:"4px"}},e))},render:function(){for(var e=this,t=(0,f["default"])(this.props.root),i=void 0,a=[],n=0;n<t.length;n++){var r=t[n],l="list-item";this.state.currentAssetPack.id===r.id&&(this.state.currentAssetPack=r,i=r,l+=" selected"),a.push(o["default"].createElement("li",{className:l,onClick:this.onAssetPackSelected.bind(this,r)},o["default"].createElement("span",null,r.name)))}return o["default"].createElement("div",{className:"asset-selector-modal",style:{width:480,marginLeft:"auto",marginRight:"auto"},ref:"modal"},o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px"}},o["default"].createElement("h2",{style:{textAlign:"center",marginTop:"6px",marginBottom:"6px"}},"Choose a Behavior Tree")),o["default"].createElement("label",{style:{marginLeft:10}},"Search"),o["default"].createElement("atom-text-editor",{ref:"editor",style:{marginLeft:10,marginRight:10,marginBottom:10},mini:!0}),o["default"].createElement("div",{className:"contents"},o["default"].createElement("div",{className:"list-contents"},this.getPanelHeading("Asset Pack"),o["default"].createElement("div",{className:"list-group asset-pack",ref:"assetPackList"},a)),o["default"].createElement("div",{className:"list-contents"},this.getPanelHeading("Behavior Tree"),o["default"].createElement("div",{className:"asset-list"},o["default"].createElement(s["default"],{uri:d["default"].resolve(i.root,"behaviors"),onChosen:function(t){e.onSelected(t),e.onChoose()},onSelected:this.onSelected,extension:[".bt"],filter:this.state.filter})))),o["default"].createElement("div",{className:"btn-group"},o["default"].createElement("button",{className:"btn",onClick:this.onChoose},"Choose"),o["default"].createElement("button",{className:"btn",onClick:this.onCancel},"Cancel")))},onLeft:function(){var e=o["default"].findDOMNode(this.refs.assetPackList);e.focus()},onRight:function(){var e=o["default"].findDOMNode(this.refs.schemaList);e.focus()},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor);setTimeout(function(){t.focus(),e.disposable=new n.CompositeDisposable,e.disposable.add(atom.commands.add(e.getDOMNode(),{"jibo-sdk:escape":e.onCancel})),e.disposable=atom.commands.add(t,"jibo-sdk:confirm",function(){e.onChoose()})},100);var i=t.getModel();i.onDidChange(function(){e.setState({filter:i.getText()})})},componentWillUnmount:function(){this.disposable.dispose()}})},{"../../common/directory-tree-view":93,"../../common/get-asset-packs":95,atom:void 0,"normalize-path":void 0,path:void 0,react:void 0}],80:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(t){t.meta||!function(){var i=e("behaviorify/lib/core"),a=Object.keys(t);a.forEach(function(e){var a=t[e],o=a.meta&&a.meta.length>0?a.meta:[];o.forEach(function(e,t){e.type=a.args[t]}),a.options=o,delete a.meta,delete a.args,i[e]&&a.options.forEach(function(t,o){a.options[o].field=i[e][o]})})}()}function n(e){o(e)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=e("../atom-react/core/react-editor"),l=i(s),d=e("fs"),u=i(d),c=e("path"),h=i(c),f=function(){function t(){a(this,t)}return r(t,[{key:"_requireWithDescriptions",value:function(e){var t=void 0;try{t=JSON.parse(u["default"].readFileSync(e,"utf8")),n(t),delete t.meta,Object.keys(t).forEach(function(i){var a=t[i];if(a.description&&a.description.url){var o=h["default"].resolve(h["default"].dirname(e),t[i].description.url);try{t[i].description=u["default"].readFileSync(o,"utf8")}catch(n){t[i].description=""}}})}catch(i){console.warn("Could not read "+e),console.warn(i)}return t}},{key:"_generateSchemaObject",value:function(e){var t={};return e.forEach(function(e){t=Object.assign(t,e)}),Object.keys(t).forEach(function(e){t[e]["class"]=e}),t}},{key:"_addProjectSchema",value:function(e,t,i){var a=h["default"].resolve(i,"schemas"),o=[];try{u["default"].lstatSync(a);for(var n=u["default"].readdirSync(a),r=0;r<n.length;r++)if(".json"===h["default"].extname(n[r])){var s=h["default"].resolve(a,n[r]);o.push(this._requireWithDescriptions(s))}}catch(l){console.warn("no schema folder detected "+l.message)}this.schemaProjects[t]={displayName:e,schema:this._generateSchemaObject(o)}}},{key:"getNewSchema",value:function(t){var i=this,a=l["default"].getProjectRoot(t);a||(a=l["default"].getProjectRoot(""));var o=[],n=["node_modules/jibo/schema/schema.json","node_modules/jibo/schema/schema-base.json"];n.forEach(function(e){var t=i._requireWithDescriptions(h["default"].join(a,e));t&&o.push(t)}),this.schemaProjects={core:{displayName:"Core",schema:this._generateSchemaObject(o)}},this._addProjectSchema("Project Behaviors","project",a);var r=h["default"].resolve(a,"node_modules"),s=[];try{s=u["default"].readdirSync(r)}catch(d){console.warn("no node_modules folder detected "+d.message)}for(var c=0;c<s.length;c++)try{var f=e(h["default"].resolve(r,s[c],"package.json"));if(f.jibo&&"asset-pack"===f.jibo.type){var p=h["default"].resolve(r,s[c]);this._addProjectSchema(f.jibo["display-name"],f.name,p)}}catch(d){}return this.schemaProjects}}]),t}();exports["default"]=f},{"../atom-react/core/react-editor":53,"behaviorify/lib/core":void 0,fs:void 0,path:void 0}],81:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),l=e("./event-emitter"),d=i(l),u=e("react"),c=i(u),h=e("../atom-react/core/react-editor"),f=i(h),p=e("./description-editor"),m=i(p),v=e("fs"),y=i(v),g=e("../common/clipboard"),b=i(g),k=e("path"),M=i(k),E=e("node-uuid"),w=i(E),S=function(e){function t(e,i,n){a(this,t);var r=o(this,Object.getPrototypeOf(t).call(this));return r.schema=i,r.uri=n,r.selectionState={},r.selectedElement=void 0,r.selectedDecorator=void 0,r._clearDescription(),r.reload(e,i),r}return n(t,e),s(t,[{key:"getSchemaByElement",value:function(e){if(!e["asset-pack"]){var t=this.schema.core.schema[e["class"]];return t||(t=this.schema.project.schema[e["class"]]),t}var i=e["asset-pack"];return this.schema[i].schema[e["class"]]}},{key:"addRedoUndoEntry",value:function(){}},{key:"getMutationFunctionNames",value:function(){return["moveUp","moveDown","addRedoUndoEntry"]}},{key:"reload",value:function(e){var t=this;this.data=e,this.projectRoot=f["default"].getProjectRoot(this.uri);var i=M["default"].join(this.projectRoot,"node_modules","jibo");if(!y["default"].existsSync(i))return void(this.installJibo=!0);this.installJibo=!1,this.nextId=0;var a=void 0===e?[]:Object.keys(e);a.forEach(function(i){if("meta"!==i){var a=e[i];t.nextId=Math.max(t.nextId,a.id)}});for(var o=0;o<a.length;o++)if("meta"!==a[o]){var n=e[a[o]],r=this.getSchemaByElement(n).type;if("leaf"===r||"composite"===r){for(this.root=n;this.root.parent;)this.root=e[this.root.parent];break}}this._clearDescription(),this._validateSelections()}},{key:"_validateSelections",value:function(){var e=this,t=Object.keys(this.selectionState);if(t.forEach(function(t){var i=e.data[t],a=e.data[e.selectionState[t]];(void 0===i||void 0===a)&&(e.selectionState[i]=void 0)}),void 0!==this.selectedElement){var i=this.data[this.selectedElement.id];if(void 0===i)this.setSelectedElement(this.getRoot());else if(this.setSelectedElement(i),void 0!==this.selectedDecorator&&void 0===this.data[this.selectedDecorator.id]){var a=this._getFirstDecorator(this.selectedElement);this.setSelectedDecorator(a)}}}},{key:"getData",value:function(){return this.data}},{key:"setSelectedElement",value:function(e){this.selectedElement=e;var t=void 0;void 0!==e&&(t=void 0!==this.selectionState[e.id]?this.selectionState[e.id]:this._getFirstDecorator(e)),this.setSelectedDecorator(t)}},{key:"getSelectedBehavior",value:function(){return this.selectedElement}},{key:"setSelectedDecorator",value:function(e){this.selectedDecorator=e,this._setSelectionState(this.selectedElement,e)&&this.emit("ondatachanged")}},{key:"getSelectedDecorator",value:function(){return this.selectedDecorator}},{key:"_getFirstDecorator",value:function(e){if(void 0!==e){var t=void 0;if(this.data[e.id].decorators&&this.data[e.id].decorators.length>0){var i=this.data[e.id].decorators[0];t=this.data[i]}return t}}},{key:"_setSelectionState",value:function(e,t){return void 0!==e&&this.selectionState[e.id]!==t?(this.selectionState[e.id]=t,!0):!1}},{key:"setRenderDescription",value:function(e){this._setAndClearDescriptionElement(),this.description.element=e,this.description.newValue=void 0}},{key:"_setAndClearDescriptionElement",value:function(){this.description.element&&"string"==typeof this.description.newValue&&(this.description.element.name=this.description.newValue,this.addRedoUndoEntry()),this._clearDescription()}},{key:"_clearDescription",value:function(){this.description={element:void 0,newValue:void 0}}},{key:"isSelected",value:function(e){return this.selectedElement&&e.id===this.selectedElement.id}},{key:"createNewElement",value:function(e,i,a){var o={id:w["default"].v4(),"class":i["class"],name:"",options:{}};return o["asset-pack"]=e,a&&(o.parent=a.id),i.options&&i.options.forEach(function(e){var i=e.defaultValue,a=e.field,n=e.type;if(Array.isArray(n)){var r=n;n=n[0],"enum"===n&&void 0===i&&(i=r[1].value)}o.options[a]=t.getDefaultValueForType(n.toLowerCase(),i)}),o}},{key:"deleteRow",value:function(e,t){var i=this;if("undefined"==typeof e&&(e=this.selectedElement),"undefined"==typeof t){var a=this.data[e.parent];t=a.children.indexOf(e.id)}var o=e.parent,n=this.data[o],r=this.isSelected(e);this.selectionState[e.id]=void 0;for(var s=[n.children.splice(t,1)[0]];s.length>0;){var l=s.pop();r||(r=this.isSelected(this.data[l])),this.data[l].decorators&&this.data[l].decorators.forEach(function(e){delete i.data[e]}),this.data[l].children&&(s=s.concat(this.data[l].children)),delete this.data[l]}r&&this.setSelectedElement(n),this.addRedoUndoEntry(),this.emit("ondatachanged")}},{key:"addDecoratorAbove",value:function(e,t,i,a){e.decorators=e.decorators?e.decorators:[];var o=this.createNewElement(i,a);e.decorators.splice(t,0,o.id),this.data[o.id]=o,this.selectedElement===e&&this.setSelectedDecorator(o),this.addRedoUndoEntry(),this.emit("ondatachanged")}},{key:"addDecoratorBelow",value:function(e,t,i,a){this.addDecoratorAbove(e,t+1,i,a)}},{key:"deleteDecorator",value:function(e,t){if("undefined"==typeof e&&(e=this.selectedElement),"undefined"==typeof t){var i=this.data[e.parent];t=i.children.indexOf(e.id)}var a=e.decorators.splice(t,1)[0];this.selectedDecorator&&a===this.selectedDecorator.id&&(this.selectedDecorator=void 0),delete this.data[a];var o=this._getFirstDecorator(e);this.setSelectedDecorator(o),this.addRedoUndoEntry(),this.emit("ondatachanged")}},{key:"addSiblingAbove",value:function(e,t,i,a){var o=this.getParent(e),n=this.createNewElement(i,a,o);this.data[n.id]=n,o.children.splice(t,0,n.id),this.addRedoUndoEntry(),this.setSelectedElement(n)}},{key:"addSiblingBelow",value:function(e,t,i,a){this.addSiblingAbove(e,t+1,i,a)}},{key:"addChild",value:function(e,t,i){var a=this.createNewElement(t,i,e);e.children=e.children?e.children:[],e.children.unshift(a.id),this.data[a.id]=a,this.setSelectedElement(a),this.addRedoUndoEntry(),this.emit("ondatachanged")}},{key:"skip",value:function(e){e.skipped=!e.skipped,this.addRedoUndoEntry(),this.getParent(e)?this.emit("ondatachanged"):e.skipped=!1,this.addRedoUndoEntry()}},{key:"swap",value:function(e,t,i){var a=this.getParent(e),o=this.getRoot()==e,n=this.createNewElement(t,i,a);n.parent=void 0===a?void 0:a.id,n.id=e.id,n.children=e.children,n.decorators=e.decorators,this.data[n.id]=n,o&&(this.root=n),this.setSelectedElement(n),this.addRedoUndoEntry(),this.emit("ondatachanged")}},{key:"moveUp",value:function(e,t){var i=t-1,a=this.data[e.parent];a.children.splice(t,1),a.children.splice(i,0,e.id),this.addRedoUndoEntry(),this.emit("ondatachagned")}},{key:"canMoveUp",value:function(e,t){return 0!==t}},{key:"isSkipped",value:function(e){return e.skipped}},{key:"moveDown",value:function(e,t){if(this.canMoveDown(e,t)){var i=t+1,a=this.data[e.parent];a.children.splice(t,1),a.children.splice(i,0,e.id),this.emit("ondatachagned")}}},{key:"canMoveDown",value:function(e,t){var i=this.data[e.parent];return t<i.children.length-1}},{key:"moveRow",value:function(e,t,i){var a=e.parent,o=this.data[a],n=o.children.indexOf(e.id);o.id===t.id&&i>n&&i--,o.children.splice(n,1),t.children=t.children?t.children:[],t.children.splice(i,0,e.id),e.parent=t.id,this.addRedoUndoEntry(),this.emit("ondatachanged")}},{key:"canPaste",value:function(){return void 0!==b["default"].behaviorData}},{key:"_getTreeRoot",value:function(e){var t=void 0,i=Object.keys(e);if(1===i.length)return e[i[0]];for(var a=0;a<i.length;a++){var o=i[a],n=e[o],r=this.getSchemaByElement(n).type;if("decorator"!==r){t=n;break}}for(;e[t.parent];)t=e[t.parent];return t}},{key:"paste",value:function(){if(b["default"].behaviorData){var e=JSON.parse(b["default"].behaviorData),t=Object.keys(e),i=this.getSchemaByElement(this._getTreeRoot(e)).type;"decorator"!==i?this._pasteBehavior(e):this._pasteDecorator(e,t),this.addRedoUndoEntry()}}},{key:"_pasteBehavior",value:function(e){var t=this.getSchemaByElement(this.selectedElement).type,i=void 0,a=0;"leaf"===t?(i=this.getParent(this.selectedElement),a=i.children.indexOf(this.selectedElement.id)+1):"composite"===t&&(i=this.selectedElement);var o={},n=[];Object.keys(e).forEach(function(t){var i=e[t],a=i.id,r=w["default"].v4();o[a]=r,i.id=r,n.push(i)}),e={},n.forEach(function(t){t.parent=o[t.parent],t.children&&t.children.forEach(function(e,i){t.children[i]=o[e]}),t.decorators&&t.decorators.forEach(function(e,i){t.decorators[i]=o[e]}),e[t.id]=t});for(var r=void 0,s=0;s<n.length;s++){var l=n[s],d=this.getSchemaByElement(l).type;if("decorator"!==d){r=l;break}}for(;e[r.parent];)r=e[r.parent];r.parent=i.id,i.children=i.children?i.children:[],i.children.splice(a,0,r.id),Object.assign(this.data,e),this.setSelectedElement(r)}},{key:"pasteDecorator",value:function(){if(b["default"].behaviorData){var e=JSON.parse(b["default"].behaviorData),t=Object.keys(e);1===t.length&&"decorator"===this.getSchemaByElement(e[t[0]]).type&&this._pasteDecorator(e,t)}}},{key:"_pasteDecorator",value:function(e,t){var i=this.selectedElement;if(void 0!==i){var a=t[0],o=e[a],n=0;i.decorators&&this.selectedDecorator&&(n=i.decorators.indexOf(this.selectedDecorator.id)+1),o.id=w["default"].v4(),i.decorators=i.decorators?i.decorators:[],i.decorators.splice(n,0,o.id),this.data[o.id]=o,this.setSelectedDecorator(o)}}},{key:"copy",value:function(){var e=this;if(void 0!==this.selectedElement){for(var t={},i=[this.selectedElement.id],a=function(){var a=i.pop(),o=e.data[a];o.decorators&&o.decorators.forEach(function(i,a){var n=o.decorators[a],r=e.data[n];t[r.id]=r}),t[a]=o,o.children&&(i=i.concat(o.children))};i.length>0;)a();b["default"].behaviorData=JSON.stringify(t)}}},{key:"copyDecorator",value:function(){if(void 0!==this.selectedDecorator){var e=this.selectedDecorator.id,t=this.data[e],i={};i[e]=t,b["default"].behaviorData=JSON.stringify(i)}}},{key:"cut",value:function(){if(void 0!==this.selectedElement){this.copy();var e=this.selectedElement,t=this.data[e.parent],i=t.children.indexOf(e.id),a=t;if(this.deleteRow(e,i),t.children.length>0){i=Math.max(0,i-1);var o=t.children[i];a=this.data[o]}this.addRedoUndoEntry(),this.setSelectedElement(a)}}},{key:"cutDecorator",value:function(){if(void 0!==this.selectedDecorator&&void 0!==this.selectedElement){this.copyDecorator();var e=this.selectedDecorator,t=this.selectedElement.decorators.indexOf(e.id);this.addRedoUndoEntry(),this.deleteDecorator(this.selectedElement,t)}}},{key:"skipDecorator",value:function(){if(void 0!==this.selectedDecorator&&void 0!==this.selectedElement){var e=this.selectedDecorator;e.skipped=!e.skipped,this.emit("ondatachanged"),this.addRedoUndoEntry()}}},{key:"up",value:function(){if(void 0!==this.selectedElement){var e=this.selectedElement,t=this.data[e.parent];if(t){var i=t.children.indexOf(e.id);if(0===i)this.setSelectedElement(t);else{for(i--,e=this.data[t.children[i]];e.children&&0!==e.children.length;)e=this.data[e.children[e.children.length-1]];this.setSelectedElement(e)}this.emit("ondatachanged")}}}},{key:"upDecorator",value:function(){if(this.selectedDecorator){var e=this.selectedElement.decorators.indexOf(this.selectedDecorator.id);e>0&&(e--,this.setSelectedDecorator(this.data[this.selectedElement.decorators[e]]),this.emit("ondatachanged"))}}},{key:"down",value:function(){if(void 0!==this.selectedElement){var e=!1,t=this.selectedElement,i=this.data[t.parent],a=void 0;if(i&&(a=i.children.indexOf(t.id)),t.children&&t.children.length>0)this.setSelectedElement(this.data[t.children[0]]),e=!0;else if(i&&a<i.children.length-1)a++,this.setSelectedElement(this.data[i.children[a]]),e=!0;else for(;i&&this.getParent(i);)if(t=i,i=this.getParent(t),a=i.children.indexOf(t.id),a<i.children.length-1){a++,this.setSelectedElement(this.data[i.children[a]]),e=!0;break}e&&this.emit("ondatachanged")}}},{key:"downDecorator",value:function(){if(this.selectedDecorator){var e=this.selectedElement.decorators.indexOf(this.selectedDecorator.id);e<this.selectedElement.decorators.length-1&&(e++,this.setSelectedDecorator(this.data[this.selectedElement.decorators[e]]))}}},{key:"getParent",value:function(e){var t=e.parent,i=this.data[t];return i}},{key:"shouldSkip",value:function(e){return void 0===e?!1:e.skipped?!0:this.shouldSkip(this.getParent(e))}},{key:"getHeaderLabel",value:function(e){switch(e){case 0:return"";case 1:return"";case 2:return"Behavior Type";case 3:return"Description"}}},{key:"getRowCount",value:function(e){return e.children.length}},{key:"getColumnCount",value:function(){return 4}},{key:"canHaveChildren",value:function(e){return"composite"===this.getSchemaByElement(e).type}},{key:"hasChildren",value:function(e){return e.children&&e.children.length>0}},{key:"getChildElement",value:function(e,t){return this.data[e.children[t]]}},{key:"shouldNotIndent",value:function(e){return 0===e}},{key:"getLabel",value:function(e,t,i,a){var o=this;switch(t){case 0:return String(a);case 1:return"";case 2:var n=function(){var t=[];t.push(e["class"]),e.decorators&&e.decorators.length>0&&(t.push(" *("),e.decorators.forEach(function(i,a){var n={};o.data[i].skipped&&(n={"font-style":"italic",color:"#555555"}),t.push(c["default"].createElement("span",{style:n},o.data[i]["class"])),a!=e.decorators.length-1&&t.push(", ")}),t.push(")"));var i="";o.isSelected(e)&&(i="row-selected-text");var a={},n="";"leaf"===o.getSchemaByElement(e).type?(a.className="icon-stack-base fa fa-leaf",n="green"):"composite"===o.getSchemaByElement(e).type&&(a.className="fa fa-sitemap",n="lightblue"),e.skipped&&(a.className="fa fa-eye-slash"),o.shouldSkip(e)&&(n="#555555"),a.style={color:n};var r=o.shouldSkip(e)?{"font-style":"italic",color:"#555555"}:{};return{v:c["default"].createElement("p",{className:i,style:r},c["default"].createElement("i",a),"       ",t)}}();if("object"===("undefined"==typeof n?"undefined":r(n)))return n.v;case 3:return e===this.description.element?c["default"].createElement(m["default"],{content:e.name,onChange:function(e){o.description.newValue=e},width:i,onConfirm:function(){o._setAndClearDescriptionElement(),o.emit("ondatachanged")}}):e.name}}},{key:"getRoot",value:function(){return this.root}},{key:"behavior",get:function(){return this.selectedDecorator?this.selectedDecorator:this.selectedElement}}],[{key:"getDefaultValueForType",value:function(e,t){var i={"int":0,number:0,animation:"null",audio:"null","function":"() => {\n}",string:"null","boolean":!1,"enum":"null"};return t?t:i[e]}},{key:"createNewFile",value:function(e,i){var a={id:1,"class":i["class"],name:""};a.args=[],i.args&&i.args.forEach(function(e,o){var n=i.meta[o].defaultValue;if(Array.isArray(e)){var r=e;e=e[0],"enum"===e&&void 0===n&&(n=r[1].value)}a.args.push(t.getDefaultValueForType(e.toLowerCase(),n))});var o={};o[a.id]=a,y["default"].writeFileSync(e,JSON.stringify(o,null,"    "),"utf8")}}]),t}(d["default"]);exports["default"]=S},{"../atom-react/core/react-editor":53,"../common/clipboard":92,"./description-editor":74,"./event-emitter":75,fs:void 0,"node-uuid":void 0,path:void 0,react:void 0}],82:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a);exports["default"]=o["default"].createClass({displayName:"TreeViewHeader",onMouseDown:function(e,t){t.preventDefault(),this.props.parentReact.onSeparatorDown(e,t)},render:function(){for(var e=[],t=0;t<this.props.columnWidths.length;t++){var i=this.props.model.getHeaderLabel(t),a=void 0,n={};t<this.props.columnWidths.length-1?(n.width=this.props.columnWidths[t],t>1?a=o["default"].createElement("div",{onMouseDown:this.onMouseDown.bind(this,t),className:"separator"}):n.width=20):(n.width="100%",a=o["default"].createElement("div",null)),e.push(o["default"].createElement("div",{key:t,style:n,className:"cell"},o["default"].createElement("h1",{style:{display:"inline-block"}},i),a))}return o["default"].createElement("div",{className:"row-wrapper-header"},e)},componentDidMount:function(){},componentWillUnmount:function(){}})},{react:void 0}],83:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("./tree-view-row"),r=i(n),s=e("./tree-view-parent"),l=i(s),d=o["default"].createClass({displayName:"TreeViewLevel",getInitialState:function(){return{isExpanded:!0}},onToggleExapnded:function(){this.state.isExpanded=!this.state.isExpanded,this.setState(this.state)},render:function(){var e=[];if(this.props.showRoot&&e.push(o["default"].createElement(l["default"],{row:this.props.row,isRoot:this.props.isRoot,key:0,columnWidths:this.props.columnWidths,element:this.props.element,model:this.props.model,depth:this.props.depth,treeView:this.props.treeView,onToggleExapnded:this.onToggleExapnded,isExpanded:this.state.isExpanded,rowClassName:this.props.rowClassName,isBehavior:this.props.isBehavior})),this.props.model.hasChildren(this.props.element))for(var t=0;t<this.props.model.getRowCount(this.props.element);t++){var i=this.props.model.getChildElement(this.props.element,t);this.props.model.hasChildren(i)?e.push(o["default"].createElement(d,{row:t,key:t+1,showRoot:!0,isHidden:!this.state.isExpanded,columnWidths:this.props.columnWidths,model:this.props.model,element:i,depth:this.props.depth+1,treeView:this.props.treeView,rowClassName:this.props.rowClassName,isBehavior:this.props.isBehavior})):e.push(o["default"].createElement(r["default"],{row:t,key:t+1,isHidden:!this.state.isExpanded,columnWidths:this.props.columnWidths,element:i,model:this.props.model,depth:this.props.depth+1,treeView:this.props.treeView,rowClassName:this.props.rowClassName,isBehavior:this.props.isBehavior}))}var a=this.props.isHidden?{display:"none"}:{};return o["default"].createElement("div",{className:"tree-view-level",style:a},e)},componentDidMount:function(){},getDefaultProps:function(){return{value:"default value"}}});exports["default"]=d},{"./tree-view-parent":84,"./tree-view-row":86,react:void 0}],84:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("./tree-view-row-mixin"),o=i(a),n=e("react"),r=i(n);exports["default"]=r["default"].createClass({displayName:"tree-view-parent",mixins:[o["default"]],get isParent(){return!0},get doRenderArrow(){return!0},onArrowUp:function(e){e.preventDefault(),this.props.onToggleExapnded()},onArrowOver:function(){this.isSelectable=!1},
onArrowOut:function(){this.isSelectable=!0}})},{"./tree-view-row-mixin":85,react:void 0}],85:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("jquery"),r=i(n),s=e("../common/find-node"),l=i(s),d=e("atom"),u=30;exports["default"]={getInitialState:function(){return{}},getLine:function(e){var t=this.props.model.data[e.parent];if(!t)return 1;var i=this.getOlderSibling(e);return i?1+this.getLine(i)+this.getTotalChildren(i):1+this.getLine(t)},getOlderSibling:function(e){var t=this.props.model.data[e.parent];if(t)for(var i=0;i<t.children.length;i++)if(t.children[i]===e.id&&i>0)return this.props.model.data[t.children[i-1]]},getTotalChildren:function(e){var t=this;if(e.children!==[]&&e.children){var i=0;return e.children.forEach(function(e){e=t.props.model.data[e],i+=1+t.getTotalChildren(e)}),i}return 0},getDecoratorLine:function(e){for(var t=this.props.model.owner.decorators,i=0;i<t.length;i++)if(t[i]===e.id)return i+1},render:function(){for(var e=[],t=0;t<this.props.columnWidths.length;t++){var i=u*this.props.depth;this.props.model.shouldNotIndent(t)&&(i=0);var a={width:this.props.columnWidths[t],left:i},n=this.props.model.owner?this.getDecoratorLine(this.props.element):this.getLine(this.props.element),r=this.props.model.getLabel(this.props.element,t,this.props.columnWidths[t]-i-20,n),s={display:"inline-block","font-style":"italic",color:"#555555"},l=this.props.element.skipped?s:{display:"inline-block"},d="";this.props.model.isSelected(this.props.element)&&(d="row-selected-text");var c=null;if(this.doRenderArrow&&1===t){var h="arrow";h+=this.props.isExpanded?" fa fa-caret-down":" fa fa-caret-right",c=o["default"].createElement("i",{className:h,onMouseUp:this.onArrowUp,onMouseOver:this.onArrowOver,onMouseOut:this.onArrowOut})}"string"==typeof r&&(r=o["default"].createElement("p",{className:d,style:l},r)),e.push(o["default"].createElement("div",{key:t,style:a,className:"cell"},c,r))}var f="row-wrapper";f+=" "+this.props.rowClassName,this.props.isRoot||(f+=" row-wrapper-not-root"),this.props.model.isSelected(this.props.element)&&(f+=" row-wrapper-selected"),this.props.model.canHaveChildren(this.props.element)&&(f+=" row-wrapper-parent");var p=this.props.isHidden?{display:"none"}:{},m=this.props.model.canHaveChildren(this.props.element)?null:o["default"].createElement("div",{onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,className:"drop-bar",ref:"dragBar"});return o["default"].createElement("div",{ref:"rowWrapper",draggable:"true",style:p,onClick:this.onClick,onDoubleClick:this.onDoubleClick,onDragStart:this.onDragStart,className:f,onMouseOut:this.onMouseOut,onMouseOver:this.onMouseOver},e,m)},componentDidMount:function(){var e=o["default"].findDOMNode(this.refs.dragBar);e&&(this.onDropSiblingCB=this.onDropBelowSibling.bind(this),e.addEventListener("drop",this.onDropSiblingCB));var t=o["default"].findDOMNode(this.refs.rowWrapper);this.onDropParentCB=this.onDropParent.bind(this),t.addEventListener("drop",this.onDropParentCB),this.disposable=new d.CompositeDisposable,this.disposable.add(atom.commands.add(this.getDOMNode(),{"jibo-sdk:delete-behavior":this.deleteRow,"jibo-sdk:skip-behavior":this.skip})),this.getDOMNode().treeRowView=this},componentWillUnmount:function(){var e=o["default"].findDOMNode(this.refs.dragBar);e&&e.removeEventListener("drop",this.onDropSiblingCB);var t=o["default"].findDOMNode(this.refs.rowWrapper);t.removeEventListener("drop",this.onDropParentDB),this.disposable.dispose()},canMoveUp:function(){return this.props.model.canMoveUp(this.props.element,this.props.row)},canMoveDown:function(){return this.props.model.canMoveDown(this.props.element,this.props.row)},isSkipped:function(){return this.props.model.isSkipped(this.props.element)},skip:function(){return this.props.model.skip(this.props.element)},onDragEnter:function(){var e=(0,r["default"])(o["default"].findDOMNode(this.refs.dragBar));e.css("background-color","#93c3cd")},onDragLeave:function(){var e=(0,r["default"])(o["default"].findDOMNode(this.refs.dragBar));e.css("background-color","")},onDragStart:function(){this.props.treeView.onDragStart(this.props.element)},onDropParent:function(e){e.preventDefault(),e.stopPropagation(),this.props.model.canHaveChildren(this.props.element)&&this.props.treeView.onDropParent(this.props.element)},onDropBelowSibling:function(e){e.preventDefault(),e.stopPropagation();var t=(0,r["default"])(o["default"].findDOMNode(this.refs.dragBar));t.css("background-color",""),this.props.treeView.onDropBelowSibling(this.props.element,this.props.row)},onDoubleClick:function(){this.props.treeView.onRowDoubleClicked(this)},onClick:function(){this.props.treeView.rowSelected(this)},onMouseOver:function(){this.props.treeView.rowHover(this)},onMouseOut:function(){this.props.treeView.rowHoverLeave(this)},deleteRow:function(){this.props.isBehavior?this.props.model.deleteRow(this.props.element,this.props.row):this.props.model.deleteDecorator(this.props.element,this.props.row)}},atom.contextMenu.add({".row-wrapper.behavior":[{label:"Add Decorator",command:"jibo-sdk:add-decorator"},{label:"Swap",command:"jibo-sdk:swap-behavior"}],".row-wrapper-parent":[{label:"Add Child",command:"jibo-sdk:add-child"}],".row-wrapper-not-root":[{label:"Add Sibling Above",command:"jibo-sdk:add-sibling-above"},{label:"Add Sibling Below",command:"jibo-sdk:add-sibling-below"},{label:"Delete",command:"jibo-sdk:delete-behavior"},{label:"Edit Description",command:"jibo-sdk:edit-description"},{type:"separator"},{created:function(e){var t=l["default"].getAncestor(e.target,".row-wrapper");t&&t.treeRowView.isSkipped()?this.label="Unskip":this.label="Skip"},command:"jibo-sdk:skip-behavior"},{type:"separator"},{label:"Move Up",command:"jibo-sdk:move-up-behavior",shouldDisplay:function(e){var t=l["default"].getAncestor(e.target,".row-wrapper");return t&&t.treeRowView.canMoveUp()}},{label:"Move Down",command:"jibo-sdk:move-down-behavior",shouldDisplay:function(e){var t=l["default"].getAncestor(e.target,".row-wrapper");return t&&t.treeRowView.canMoveDown()}},{type:"separator"},{label:"Cut",command:"core:cut"},{label:"Copy",command:"core:copy"}],".row-wrapper-parent:not(.row-wrapper-not-root)":[{label:"Edit Description",command:"jibo-sdk:edit-description"},{type:"separator"},{label:"Copy",command:"core:copy"}],".arguments-scroll-container":[{label:"Paste",command:"core:paste",shouldDisplay:function(){return!0}}]})},{"../common/find-node":94,atom:void 0,jquery:void 0,react:void 0}],86:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("./tree-view-row-mixin"),o=i(a),n=e("react"),r=i(n);exports["default"]=r["default"].createClass({displayName:"tree-view-row",mixins:[o["default"]],get isParent(){return!1},get doRenderArrow(){return!1}})},{"./tree-view-row-mixin":85,react:void 0}],87:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("./tree-view-level"),r=i(n),s=e("./tree-view-header"),l=i(s),d=e("../common/listen"),u=i(d),c=e("atom");exports["default"]=o["default"].createClass({displayName:"TreeView",getInitialState:function(){for(var e=this.props.model.getColumnCount(),t=[20,20],i=0;e-1>i;i++)t.push(300);return{columnWidths:t}},onSeparatorDown:function(e,t){var i=this,a=t.nativeEvent.clientX,o=this.state.columnWidths[e],n=[(0,u["default"])(document.body,"mouseup",function(){n.forEach(function(e){e.dispose()})}),(0,u["default"])(document.body,"mousemove",function(t){var n=t.clientX-a;i.state.columnWidths[e]=o+n,i.setState(i.state)})]},onDragStart:function(e){this.state.dragElement=e},isValidDrop:function(e,t){for(var i=this.props.model;t;){if(e===t)return!1;t=i.getParent(t)}return!0},onDropParent:function(e){this.isValidDrop(this.state.dragElement,e)&&this.props.model.moveRow(this.state.dragElement,e,0)},onDropBelowSibling:function(e,t){var i=this.props.model.getParent(e);this.isValidDrop(this.state.dragElement,e)&&this.props.model.moveRow(this.state.dragElement,i,t+1)},onRowDoubleClicked:function(e){this.props.onRowDoubleClicked(e)},rowSelected:function(e){this.selectedRow&&this.selectedRow.setState(this.selectedRow.state),this.selectedRow=e,this.selectedRow.setState(this.selectedRow.state),this.props.onRowSelected(e.props.element)},rowHover:function(e){this.props.onRowHover(e)},rowHoverLeave:function(e){this.props.onRowHoverLeave(e)},up:function(){this.props.model.up()},down:function(){this.props.model.down()},cut:function(){this.props.model.cut()},copy:function(){this.props.model.copy()},paste:function(){this.props.model.paste()},skip:function(){this.props.model.model?this.props.model.skip(this.props.model.model.selectedDecorator):this.props.model.skip(this.props.model.selectedElement)},"delete":function(){var e=this.selectedRow.props.row;if(this.props.model.model){var t=this.props.model.model.selectedDecorator;this.props.model.deleteRow(t,e)}else{var i=this.props.model.selectedElement;this.props.model.deleteRow(i,e)}},render:function(){for(var e=this.props.width,t=0;t<this.state.columnWidths.length-1;t++)e-=this.state.columnWidths[t];return this.state.columnWidths[this.state.columnWidths.length-1]=e,this.state.element=this.props.model.getRoot(),o["default"].createElement("div",{className:"tree-grid-view",tabIndex:0},o["default"].createElement(l["default"],{parentReact:this,model:this.props.model,columnWidths:this.state.columnWidths}),o["default"].createElement("div",{className:"arguments-scroll-container"},o["default"].createElement(r["default"],{row:0,showRoot:this.props.showRoot,columnWidths:this.state.columnWidths,model:this.props.model,element:this.state.element,depth:0,treeView:this,isRoot:!0,rowClassName:this.props.rowClassName,isBehavior:this.props.isBehavior})))},componentDidMount:function(){this.disposable=new c.CompositeDisposable,this.disposable.add(atom.commands.add(this.getDOMNode(),{"jibo-sdk:up":this.up,"jibo-sdk:down":this.down,"core:cut":this.cut,"core:copy":this.copy,"core:paste":this.paste,"jibo-sdk:skip-selected":this.skip,"jibo-sdk:delete-bt-elem":this["delete"]}))},componentWillUnmount:function(){this.disposable.dispose()}})},{"../common/listen":101,"./tree-view-header":82,"./tree-view-level":83,atom:void 0,react:void 0}],88:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=e("../atom-react/core/react-pane"),l=i(s),d=e("./cheat-sheet-view"),u=i(d),CheatSheetTab=function(e){function CheatSheetTab(e,t){a(this,CheatSheetTab);var i=o(this,Object.getPrototypeOf(CheatSheetTab).call(this,"CheatSheetTab",e,t,"Jibo Cheat Sheet")),n=i.getUiState();return i.layout=n?n:[],i}return n(CheatSheetTab,e),r(CheatSheetTab,[{key:"getReactClass",value:function(){return u["default"]}}]),CheatSheetTab}(l["default"]);exports["default"]=CheatSheetTab},{"../atom-react/core/react-pane":54,"./cheat-sheet-view":89}],89:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("fs"),r=i(n),s=e("marked"),l=i(s),d=e("../get-base-path"),u=i(d);exports["default"]=o["default"].createClass({displayName:"cheat-sheet-view",render:function(){var e=r["default"].readFileSync((0,u["default"])("docs","cheat-sheet.md"),"utf8"),t=(0,l["default"])(e,{sanitize:!0}),i={margin:20};return o["default"].createElement("div",{style:i,dangerouslySetInnerHTML:{__html:t}})}})},{"../get-base-path":107,fs:void 0,marked:void 0,react:void 0}],90:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a])}return e},o=e("react"),n=i(o),r=e("./animation"),s=i(r);exports["default"]=n["default"].createClass({displayName:"animation-visualizer",getInitialState:function(){return{}},render:function(){return n["default"].createElement("div",a({ref:"container"},{style:this.props.style}))},componentWillReceiveProps:function(e){this.nextProps=e,this.animation.initialized?this.playAnimation(e.uri):this.animation.on("init",this.onNextPropsInit)},playAnimation:function(e){var t=n["default"].findDOMNode(this.refs.container);this.animation.attach(t),this.animation.createAnimation(e,function(e){e&&e.play()})},onNextPropsInit:function(){this.playAnimation(this.nextProps.uri)},onInit:function(){console.log("initted"),this.playAnimation(this.props.uri)},componentDidMount:function(){this.animation=new s["default"],this.animation.on("init",this.onInit),this.animation.init()},componentWillUnmount:function(){this.animation.detach()}})},{"./animation":91,react:void 0}],91:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(exports,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),s=e("path"),l=i(s),d=e("animation-utilities"),u=e("events"),c=e("jibo-keyframes"),h=i(c),f=e("../../atom-react/core/react-editor"),p=i(f),m=function(e){function t(){a(this,t);var e=o(this,Object.getPrototypeOf(t).call(this));return e.config=new d.JiboConfig,e.initialized=!1,e}return n(t,e),r(t,[{key:"createNewRenderer",value:function(e){var t=this;d.visualize.createRobotRenderer(this.robotInfo,null,d.visualize.DisplayType.BODY,function(i){i&&(i.setBackgroundColor(63/255,169/255,245/255),d.TimelineBuilder.connectRenderer(t.timeline,i),e(i))})}},{key:"attach",value:function(e){this.renderer.attachToContainer(e)}},{key:"init",value:function(){var e=this;d.RobotInfo.createInfo(this.config,function(t){d.TimelineBuilder.createTimeline(t,function(i){e.timeline=i,e.robotInfo=t,e.factory=d.animate.createAnimationUtilities(i,t),e.factory.setDefaultTransition(null),e.createNewRenderer(function(t){e.renderer=t,d.TimelineBuilder.connectRenderer(i,t),e.initialized=!0,e.emit("init")})})})}},{key:"createAnimation",value:function(e,t){var i=this,a=l["default"].extname(e);".anim"===a?this.factory.createAnimationBuilder(e,function(e){t(e)},!0):".keys"===a&&!function(){var a=p["default"].getProjectRoot(e);h["default"].keysToAnimObjectAsync(e,function(e){var o=i.factory.createAnimationBuilderFromData(e,a);t(o)})}()}},{key:"detach",value:function(){this.renderer&&this.renderer.detachFromContainer()}}]),t}(u.EventEmitter);exports["default"]=m},{"../../atom-react/core/react-editor":53,"animation-utilities":void 0,events:void 0,"jibo-keyframes":void 0,path:void 0}],92:[function(e,t,exports){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),o=function(){function e(){i(this,e)}return a(e,[{key:"clear",value:function(){this._behaviorData=void 0,this._animationData=void 0}},{key:"behaviorData",set:function(e){this.clear(),this._behaviorData=e},get:function(){return this._behaviorData}},{key:"animationData",set:function(e){this.clear(),this._animationData=e},get:function(){return this._animationData}}]),e}();exports["default"]=new o},{}],93:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("path"),o=i(a),n=e("fs"),r=i(n),s=e("react"),l=i(s);exports["default"]=l["default"].createClass({displayName:"directory-tree-view",propTypes:{uri:l["default"].PropTypes.string.isRequired,extension:l["default"].PropTypes.string.isRequired},getInitialState:function(){return{selectedAnim:void 0,collapsedDirectoried:{}}},createFile:function(e){var t=o["default"].parse(e).base;if(this.props.filter&&!t.toLowerCase().includes(this.props.filter.toLowerCase()))return null;var i=this.state.selectedAnim===e?"list-item selected-item":"list-item";return l["default"].createElement("ul",{className:"list-tree"},l["default"].createElement("li",{onClick:this.onSelected.bind(this,e),onDoubleClick:this.onChosen.bind(this,e),className:i},l["default"].createElement("span",{className:"icon icon-file-text"},t)))},onSelected:function(e){this.props.onSelected(e),this.state.selectedAnim=e,this.setState(this.state)},onChosen:function(e){this.state.selectedAnim=e,this.setState(this.state),this.props.onChosen(e)},onCollapsed:function(e){this.state.collapsedDirectoried[e]?delete this.state.collapsedDirectoried[e]:this.state.collapsedDirectoried[e]=!0,this.setState(this.state)},createDirectory:function(e){var t=this,i=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],a=o["default"].parse(e).base;if(".git"===a||"node_modules"==a)return null;var n=r["default"].readdirSync(e),s=[];n.forEach(function(i){var a=o["default"].resolve(e,i),n=r["default"].lstatSync(a);if(n.isDirectory())s.push(t.createDirectory(a));else if(t.props.extension instanceof Array)for(var l=0;l<t.props.extension.length;l++){var d=t.props.extension[l];o["default"].extname(i)===d.toLowerCase()&&s.push(t.createFile(a))}else t.props.extension&&o["default"].extname(i)===t.props.extension.toLowerCase()&&s.push(t.createFile(a))});var d=this.state.collapsedDirectoried[e]?"list-nested-item collapsed":"list-nested-item";return i?l["default"].createElement("ul",{className:"list-group"},s):l["default"].createElement("ul",{className:"list-tree has-collapsable-children"},l["default"].createElement("li",{className:d},l["default"].createElement("div",{onClick:this.onCollapsed.bind(this,e),className:"list-item"},l["default"].createElement("span",{className:"icon icon-file-directory"},a)),s))},render:function(){return l["default"].createElement("div",{className:"jibo-list-tree"},this.createDirectory(this.props.uri,!0))}})},{fs:void 0,path:void 0,react:void 0}],94:[function(e,t,exports){"use strict";function i(e,t){if(!e||!e.nodeType||"string"!=typeof t)return null;t=t.split("."),1===t.length?t.push(null):t[0]||(t[0]=null);do{if(!t[0]&&!t[1])break;var i=t[0]?t[0].toLowerCase()===e.nodeName.toLowerCase():!0,a=t[1]?-1!==e.className.toLowerCase().search(t[1].toLowerCase()):!0;if(i&&a)break;e=e.parentNode}while(e);return e}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]={getAncestor:i}},{}],95:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("../atom-react/core/react-editor"),o=i(a),n=e("fs"),r=i(n),s=e("path"),l=i(s);exports["default"]=function(t){var i=[],a=o["default"].getProjectRoot(t);a||(a=o["default"].getProjectRoot("")),i.push({root:a,id:"project",name:"Project"});var n=l["default"].resolve(a,"node_modules");try{for(var s=r["default"].readdirSync(n),d=0;d<s.length;d++){var u=e(l["default"].resolve(n,s[d],"package.json"));if(u.jibo&&"asset-pack"===u.jibo.type){var c=l["default"].resolve(n,s[d]);i.push({root:c,id:u.name,name:u.jibo["display-name"]})}}}catch(h){return i}return i}},{"../atom-react/core/react-editor":53,fs:void 0,path:void 0}],96:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(){var e=r["default"].getFilePathOfSelection();return e?(s=!1,void atom.workspace.open(e)):void alert("Can't Open Folders as JSON")}function o(){var e=s;return s=!0,e}Object.defineProperty(exports,"__esModule",{value:!0});var n=e("./tree-view-helper"),r=i(n),s=!0;exports["default"]={open:a,useDefaultEditor:o}},{"./tree-view-helper":103}],97:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=function(){return{handleSize:8,propTypes:{onLayoutResize:o["default"].PropTypes.func},getDefaultProps:function(){return{supportedChildren:{HLayout:!0,VLayout:!0,TreeView:!0,"layout-child":!0}}},handleResize:function(){this.forceUpdate()},getInitialState:function(){var e=this.props.serialized,t=[];if(e.length>0)for(var i=0;i<e.length;i++)t[i]=e[i].size;else if(Array.isArray(this.props.children))for(var a=this.props.children.length,o=this.handleSize*(a-1),n=this.getSize()-o,r=0;a>r;r++){var s=n/a;this.props.serialized[r]={size:s,children:[]},t.push(s)}else{var l=this.getSize();this.props.serialized[0]={size:l,children:[]},t.push(l)}return{sizes:t,serialized:this.props.serialized}},componentDidMount:function(){},onMouseMove:function(e,t){t.preventDefault(),t.stopPropagation();var i=this.getEventPosition(t)-this.start,a=this.startSizes[0]+this.startSizes[1];this.state.sizes[e]=(0,u["default"])(this.startSizes[0]+i,0,a),this.state.sizes[e+1]=(0,u["default"])(this.startSizes[1]-i,0,a),this.state.serialized[e].size=this.state.sizes[e],this.state.serialized[e+1].size=this.state.sizes[e+1],this.props.onLayoutResize&&this.props.onLayoutResize(this.state.sizes),this.setState(this.state)},onMouseUp:function(){this.state.disposables.forEach(function(e){e.dispose()});for(var e=document.getElementsByClassName("animation-preview"),t=0;t<e.length;t++)e[t].style.pointerEvents=""},onHandleDown:function(e,t){var i=this;if(1===t.nativeEvent.which){t.nativeEvent.preventDefault(),this.start=this.getEventPosition(t.nativeEvent),this.startSizes=[this.state.sizes[e],this.state.sizes[e+1]],this.state.disposables=[(0,r["default"])(document.body,"mouseup",this.onMouseUp),(0,r["default"])(document.body,"mousemove",function(t){i.onMouseMove(e,t)})];for(var a=document.getElementsByClassName("animation-preview"),o=0;o<a.length;o++)a[o].style.pointerEvents="none"}},render:function(){for(var e=this,t=this.props.children.slice(),i=this.state.sizes.reduce(function(e,t){return e+t},0),a=this.handleSize*(t.length-1),n=(this.getSize()-a)/i,r=0;r<this.state.sizes.length;r++)this.state.sizes[r]*=n;for(var s=0,d=0;d<t.length;d++){var u=t[d],c=this.state.sizes[d];if(u&&u.type&&this.props.supportedChildren[u.type.displayName]){var h=this.getProps(c,this.props.width,this.props.height);("HLayout"===u.type.displayName||"VLayout"===u.type.displayName)&&(h.serialized=this.state.serialized[d].children),u=(0,l["default"])(u,h)}t[d]=o["default"].createElement("div",{key:s++,className:this.getContainerClass(),style:this.getProps(c,this.props.width,c,this.props.height)},u)}var f=[];return t.forEach(function(i,a){f.push(i),a<t.length-1&&f.push(o["default"].createElement("div",{key:s++,className:"layout-handle",onMouseDown:function(t){e.onHandleDown(a,t)},style:e.getHandleStyle()}))}),o["default"].createElement("div",{className:this.getLayoutClass()},f)}}};var a=e("react"),o=i(a),n=e("../listen"),r=i(n),s=e("react/lib/cloneWithProps"),l=i(s),d=e("clamp"),u=i(d)},{"../listen":101,clamp:void 0,react:void 0,"react/lib/cloneWithProps":void 0}],98:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var a=e("react"),o=i(a),n=e("./abstract-layout"),r=i(n),s=function(){return{getContainerClass:function(){return"h-child-container"},getLayoutClass:function(){return"h-layout"},getSize:function(){return this.props.width},getProps:function(e){return{width:e,height:this.props.height}},getEventPosition:function(e){return e.clientX},getHandleStyle:function(){return{"float":"left",width:this.handleSize,height:this.props.height,cursor:"ew-resize"}},displayName:"HLayout"}};t.exports=o["default"].createClass(Object.assign((0,r["default"])(),s()))},{"./abstract-layout":97,react:void 0}],99:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var a=e("react"),o=i(a),n=e("react/lib/cloneWithProps"),r=i(n);t.exports=o["default"].createClass({displayName:"VLayout",getInitialState:function(){return{serialized:this.props.serialized}},propTypes:{width:o["default"].PropTypes.number.isRequired,height:o["default"].PropTypes.number.isRequired},render:function(){var e=this.props.children;return("VLayout"===e.type.displayName||"HLayout"===e.type.displayName)&&(e=(0,r["default"])(e,{height:this.props.height,width:this.props.width,serialized:this.state.serialized})),o["default"].createElement("div",{className:"layout"},e)}})},{react:void 0,"react/lib/cloneWithProps":void 0}],100:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var a=e("react"),o=i(a),n=e("./abstract-layout"),r=i(n),s=function(){return{getContainerClass:function(){return"v-child-container"},getLayoutClass:function(){return"layout"},getSize:function(){return this.props.height},getProps:function(e){return{width:this.props.width,height:e}},getEventPosition:function(e){return e.clientY},getHandleStyle:function(){return{width:"100%",height:this.handleSize,cursor:"ns-resize"}},displayName:"VLayout"}};t.exports=o["default"].createClass(Object.assign((0,r["default"])(),s()))},{"./abstract-layout":97,react:void 0}],101:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=function(e,t,i){var a=o["default"].isFunction(e.on)?e.on:e.addEventListener;return a.apply(e,[t,i]),{dispose:function(){var a=o["default"].isFunction(e.off)?e.off:e.removeEventListener;a.apply(e,[t,i])}}};var a=e("jquery"),o=i(a)},{jquery:void 0}],102:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("atom"),r=e("../../common/directory-tree-view"),s=i(r),l=e("path"),d=i(l),u=e("normalize-path"),c=i(u),h=e("../../common/get-asset-packs"),f=i(h);exports["default"]=o["default"].createClass({displayName:"choose-audio-modal",onChoose:function(){var e=this.state.currentAssetPack,t=d["default"].join(e.root,"audio"),i=d["default"].relative(t,this.state.currentAudio);i=(0,c["default"])(i),"project"!==this.state.currentAssetPack.id&&(i=e.id+"://"+i),this.props.onChoose(i),this.props.onClose()},onCancel:function(){this.props.onClose()},getInitialState:function(){return{currentAssetPack:{id:"project"},currentAudio:"",filter:"",key:0}},onAssetPackSelected:function(e){this.setState({currentAssetPack:e})},onSelected:function(e){this.setState({currentAudio:e})},getPanelHeading:function(e){return o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px",width:"100%",height:30}},o["default"].createElement("p",{style:{textAlign:"center",marginTop:"4px",marginBottom:"4px"}},e))},render:function(){for(var e=this,t=(0,f["default"])(this.props.root),i=void 0,a=[],n=0;n<t.length;n++){var r=t[n],l="list-item";this.state.currentAssetPack.id===r.id&&(this.state.currentAssetPack=r,i=r,l+=" selected"),a.push(o["default"].createElement("li",{className:l,onClick:this.onAssetPackSelected.bind(this,r)},o["default"].createElement("span",null,r.name)))}return o["default"].createElement("div",{className:"asset-selector-modal",ref:"modal"},o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px"}},o["default"].createElement("h2",{style:{textAlign:"center",marginTop:"6px",marginBottom:"6px"}},"Choose an Audio File")),o["default"].createElement("label",{style:{marginLeft:10}},"Search"),o["default"].createElement("atom-text-editor",{ref:"editor",style:{marginLeft:10,marginRight:10,marginBottom:10},mini:!0}),o["default"].createElement("div",{className:"contents"},o["default"].createElement("div",{className:"list-contents"},this.getPanelHeading("Asset Pack"),o["default"].createElement("div",{className:"list-group asset-pack",ref:"assetPackList"},a)),o["default"].createElement("div",{className:"list-contents"},this.getPanelHeading("Audio File"),o["default"].createElement("div",{className:"asset-list"},o["default"].createElement(s["default"],{uri:d["default"].resolve(i.root,"audio"),onChosen:function(t){e.onSelected(t),e.onChoose()},onSelected:this.onSelected,extension:[".mp3"],filter:this.state.filter}))),o["default"].createElement("div",{className:"preview-contents"},this.getPanelHeading("Preview"),o["default"].createElement("div",{className:"asset-preview"},o["default"].createElement("audio",{key:this.state.key++,controls:!0,style:{width:"100%",marginTop:"auto",marginBottom:"auto"}},o["default"].createElement("source",{src:this.state.currentAudio,type:"audio/mpeg"}))))),o["default"].createElement("div",{className:"btn-group"},o["default"].createElement("button",{className:"btn",onClick:this.onChoose},"Choose"),o["default"].createElement("button",{className:"btn",onClick:this.onCancel},"Cancel")))},onLeft:function(){var e=o["default"].findDOMNode(this.refs.assetPackList);e.focus()},onRight:function(){var e=o["default"].findDOMNode(this.refs.schemaList);e.focus()},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor);setTimeout(function(){t.focus(),e.disposable=new n.CompositeDisposable,e.disposable.add(atom.commands.add(e.getDOMNode(),{"jibo-sdk:escape":e.onCancel})),e.disposable=atom.commands.add(t,"jibo-sdk:confirm",function(){e.onChoose()})},100);var i=t.getModel();i.onDidChange(function(){e.setState({filter:i.getText()})})},componentWillUnmount:function(){this.disposable.dispose()}})},{"../../common/directory-tree-view":93,"../../common/get-asset-packs":95,atom:void 0,"normalize-path":void 0,path:void 0,react:void 0}],103:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var a=e("jquery"),o=i(a),n=e("path"),r=i(n),s=e("../atom-react/core/react-editor"),l=i(s);t.exports={getFilePathOfSelection:function(){var e=(0,o["default"])(".tree-view-scroller .file.entry.list-item.selected > span");if(1!==e.length)return null;var t=e[0].getAttribute("data-path");return t?t:null},getFolderPathOfSelection:function(){var e=this.getFilePathOfSelection();if(e)return r["default"].dirname(e);var t=(0,o["default"])(".tree-view-scroller .directory.selected > .list-item > span.icon");if(1!==t.length)return null;var i=t[0].getAttribute("data-path");return i?i:null},getFolderPathWithDirectory:function(e,t){e&&(e=r["default"].normalize(e));var i=r["default"].normalize("/"+t+"/");if(e)e.includes(i)||(e=r["default"].resolve(l["default"].getProjectRoot(e),t));else{var a=l["default"].getProjectRoot("");
if(!a)return null;e=r["default"].resolve(a,t)}return e}}},{"../atom-react/core/react-editor":53,jquery:void 0,path:void 0}],104:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=e("crypto"),r=i(n),s=function(){function e(t,i){a(this,e),this.debugMode=i,this.model=t;var o=[],n=[];this.undoStack=o,this.redoStack=n;var r=t.getMutationFunctionNames(),s=this.copy;this.latestHash="";var l=this;r.forEach(function(e){var a=t[e];t[e]=function(){a.apply(t,arguments);var e=s(t.getData());l.hashData(e),o[o.length-1]!==e&&(i&&(console.log("added entry"),console.log(JSON.stringify(t.getData(),null,"	"))),o.push(e),this.emit("ondatachanged")),n.length=0}});var d=s(t.getData());o.push(d),this.hashData(d)}return o(e,[{key:"restore",value:function(){this.undoStack.length>0&&this.model.reload(JSON.parse(this.undoStack[this.undoStack.length-1]))}},{key:"undo",value:function(){if(this.undoStack.length>1){var e=this.undoStack.pop();this.redoStack.push(e);var t=JSON.parse(this.undoStack[this.undoStack.length-1]);this.hashData(this.undoStack[this.undoStack.length-1]),this.model.reload(t),this.debugMode&&(console.log("undone"),console.log(JSON.stringify(t,null,"	"))),this.model.emit("ondatachanged")}}},{key:"redo",value:function(){if(this.redoStack.length>0){var e=this.redoStack.pop();this.undoStack.push(e),this.hashData(e);var t=JSON.parse(e);this.model.reload(t),this.debugMode&&(console.log("redone"),console.log(JSON.stringify(t,null,"	"))),this.model.emit("ondatachanged")}}},{key:"hashData",value:function(e){if(void 0!==e){var t=r["default"].createHash("sha1");t.update(e),this.latestHash=t.digest("hex")}}},{key:"isSame",value:function(e,t){return JSON.stringify(e)===JSON.stringify(t)}},{key:"copy",value:function(e){return JSON.stringify(e)}}]),e}();exports["default"]=s},{crypto:void 0}],105:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("fluent-ffmpeg"),o=i(a),n=e("path"),r=i(n),s=e("../get-base-path"),l=i(s),d=(0,l["default"])("ffmpeg"),u="win32"===process.platform?"ffmpeg.exe":"ffmpeg",c="win32"===process.platform?"ffprobe.exe":"ffprobe";o["default"].setFfmpegPath(r["default"].resolve(d,process.platform,process.arch,u)),o["default"].setFfprobePath(r["default"].resolve(d,process.platform,process.arch,c)),exports["default"]=o["default"]},{"../get-base-path":107,"fluent-ffmpeg":void 0,path:void 0}],106:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var a=e("child_process"),o=e("fs"),n=i(o),r=e("../get-base-path"),s=i(r),l=e("jibo-tools"),d=e("crypto"),u=i(d),c=(0,l.getElectronPath)(),h="cmajghqmadhnadjcjhamajdhda";t.exports={isUserLoggedIn:function(){var e=!0;try{n["default"].lstatSync((0,s["default"])("djenfhviakq.private")),e=!1}catch(t){e=!0}return e?"true"===localStorage.getItem(h):!0},showDialog:function(e){var t=this;u["default"].randomBytes(48,function(i,o){var n=o.toString("hex"),r=(0,a.spawn)(c,[(0,s["default"])("gating","m.js")],{cwd:(0,s["default"])("gating"),env:{token:n}});r.stdout.on("data",function(e){var t=e.toString();t===n&&localStorage.setItem(h,!0)}),r.on("close",function(){e(null,t.isUserLoggedIn())})})}}},{"../get-base-path":107,child_process:void 0,crypto:void 0,fs:void 0,"jibo-tools":void 0}],107:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=function(e,t){var i=o["default"].sep+"jibo-sdk",a=__dirname.substr(0,__dirname.indexOf(i)+i.length);return o["default"].join(a,e||"",t||"")};var a=e("path"),o=i(a)},{path:void 0}],108:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function n(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function r(e){var t=m["default"].parse(e);return null!==t.port?t.host.slice(0,-(t.port.length+1)):t.host}Object.defineProperty(exports,"__esModule",{value:!0});var s=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),l=e("path"),d=i(l),u=e("jibo-tools"),c=e("../toolbar/run-configuration"),h=i(c),f=e("events"),p=e("url-parse-as-address"),m=i(p),v=function(e){function t(){a(this,t);var e=o(this,Object.getPrototypeOf(t).call(this));e.isPlaying=!1;var i=e;return u.launcher.on("exit",function(){i.isPlaying=!1,i.emit("exit")}),e}return n(t,e),s(t,[{key:"play",value:function(){this.emit("start"),this.isPlaying=!0;var e=h["default"].runDir;e=e.replace("${project}",atom.project.getPaths()[0]);var t=d["default"].resolve(e,"index.html");if("remote"===h["default"].type){var i="http://"+r(h["default"].host)+":8181/registry";u.launcher.play(t,i)}else u.launcher.play(t)}},{key:"stop",value:function(){u.launcher.stop()}},{key:"isPlaying",value:function(){return this.isPlaying}},{key:"togglePlayer",value:function(){this.isPlaying?this.stop():this.play()}}]),t}(f.EventEmitter);exports["default"]=v,exports["default"]=new v},{"../toolbar/run-configuration":115,events:void 0,"jibo-tools":void 0,path:void 0,"url-parse-as-address":void 0}],109:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},o=e("react"),n=i(o),r=e("jibo-tools"),s=e("jquery"),l=i(s),d=e("path"),u=i(d),c=e("fs"),h=i(c),f=e("atom"),p=e("../atom-react/components/jibo-combo-box"),m=i(p),v=n["default"].createClass({displayName:"PackageGeneratorModal",getInitialState:function(){return this.data=[{label:"Create Skill",display:"Skill",value:{template:"behavior-template",fields:[{label:"Package.json name",ref:"packageName"}]}},{label:"Create Asset Pack",display:"Asset Pack",value:{template:"asset-pack-template",fields:[{label:"Package.json name",ref:"packageName"},{label:"Asset Pack Title",ref:"titleName"}]}}],{step:0,type:this.data[0].value}},onChangeConfiguration:function(e){this.setState({type:e.value})},getFieldValue:function(e){var t=n["default"].findDOMNode(this.refs[e]);if(!t)return"";var i=t.getModel();return i.getText()},createInputField:function(e,t,i){return n["default"].createElement("div",{className:"block"},n["default"].createElement("label",null,e),n["default"].createElement("atom-text-editor",{ref:t,tabIndex:i,mini:!0}))},render:function(){var e=this;switch(this.state.step){case 0:var t=function(){var t=[];return e.state.type.fields.forEach(function(i,a){t.push(e.createInputField(i.label,i.ref,a))}),{v:n["default"].createElement("div",{className:"block package-generator"},n["default"].createElement("div",{className:"panel-heading"},n["default"].createElement("h1",{style:{textAlign:"center"}},"New Jibo Skill")),n["default"].createElement("div",{className:"block"},n["default"].createElement("label",null,"Type"),n["default"].createElement(m["default"],{data:e.data,init:e.data[0],onSelected:e.onChangeConfiguration})),t,n["default"].createElement("hr",null),n["default"].createElement("div",{className:"btn-group"},n["default"].createElement("button",{className:"btn",ref:"generateButton",onClick:e.onChoose},"Generate"),n["default"].createElement("button",{className:"btn",onClick:e.props.onClose},"Cancel")))}}();if("object"===("undefined"==typeof t?"undefined":a(t)))return t.v;case 1:return n["default"].createElement("div",{className:"inline-block",style:{display:"flex"}},n["default"].createElement("i",{className:"fa fa-cog fa-spin fa-5x"}),n["default"].createElement("label",{style:{margin:"auto",fontSize:23}},"Installing node dependencies"))}},areFieldsFilledIn:function(){for(var e=Object.keys(this.fields),t=!0,i=0;i<e.length;i++){var a=e[i];t=t&&this.fields[a]}return t},onUpdate:function(){var e=this;0===this.state.step&&!function(){var t=e.state.type.fields[0].ref,i=n["default"].findDOMNode(e.refs[t]);i.focused(),e.fields={};var a=n["default"].findDOMNode(e.refs.generateButton);e.state.type.fields.forEach(function(t){e.fields[t.ref]=!1;var i=n["default"].findDOMNode(e.refs[t.ref]),o=i.getModel();o.onDidChange(function(){e.fields[t.ref]=o.getText().length>0,a.disabled=!e.areFieldsFilledIn()})}),a.disabled=!0}()},componentDidUpdate:function(){this.onUpdate()},componentDidMount:function(){var e=this;this.onUpdate(),this.disposable=new f.CompositeDisposable,this.disposable.add(atom.commands.add(this.getDOMNode(),{"jibo-sdk:escape":this.props.onClose})),this.disposable.add(atom.commands.add(this.getDOMNode(),{"core:confirm":function(){e.areFieldsFilledIn()&&e.onChoose()}}))},componentWillUnmount:function(){this.disposable.dispose()},onChoose:function(){var e=this;this.state.step++;var t=this.getPackagesDirectory(),i=this.getFieldValue("packageName");i=u["default"].normalize(i);var a=this.getFieldValue("titleName"),o=u["default"].resolve(t,i),n=i.split(u["default"].sep),s=n.length>0?n[n.length-1]:i;this.setState(this.state),(0,r.packageGenerator)(this.state.type.template,o,s,a,function(){e.props.onClose(),atom.open({pathsToOpen:[o]})})},getPackagesDirectory:function(){return atom.config.get("core.projectHome")||process.env.ATOM_REPOS_HOME||u["default"].join(h["default"].getHomeDirectory(),"github")}});exports["default"]=function(){var e=(0,l["default"])("<div/>"),t=atom.workspace.addModalPanel({item:e});n["default"].render(n["default"].createElement(v,{onClose:function(){t.destroy()}}),e[0])}},{"../atom-react/components/jibo-combo-box":51,atom:void 0,fs:void 0,"jibo-tools":void 0,jquery:void 0,path:void 0,react:void 0}],110:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a);exports["default"]=o["default"].createClass({displayName:"error-popup",getInitialState:function(){return{hover:!1}},render:function(){var e={marginTop:-20,width:10,height:20},t=null;return this.state.hover&&(t=o["default"].createElement("span",{className:"badge badge-info",style:{fontSize:15}},this.props.message)),o["default"].createElement("div",null,o["default"].createElement("div",{onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,style:e}),t)},onMouseOver:function(){this.setState({hover:!0})},onMouseOut:function(){this.setState({hover:!1})}})},{react:void 0}],111:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a);exports["default"]=o["default"].createClass({displayName:"gutter-popup",getInitialState:function(){return{hover:!1}},render:function(){var e={marginLeft:-50,marginTop:-25,width:30,height:25},t=null;return this.state.hover&&(t=o["default"].createElement("span",{className:"badge badge-info",style:{fontSize:15}},this.props.message)),o["default"].createElement("div",null,o["default"].createElement("div",{onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut,style:e}),t)},onMouseOver:function(){this.setState({hover:!0})},onMouseOut:function(){this.setState({hover:!1})}})},{react:void 0}],112:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("fs"),o=i(a),n=e("path"),r=i(n),s=e("resolve"),l=i(s),d=r["default"].join(l["default"].sync("jibo-tools"),"..","..",".."),u=r["default"].join(d,"parser/build/Release/jsjibonlu.jibo"),c=r["default"].join(d,"parser/build/Release/jsjibonlu.node");o["default"].existsSync(u)&&o["default"].renameSync(u,c);var h=e(c),f=r["default"].join(d,"parser","deps","data");h.set_data_dir(f);var p=r["default"].join(d,"crew/dummy-crew.rule"),m=o["default"].readFileSync(p,"utf8");h.compile_fst_from_text(m,"handle:crew"),exports["default"]=h},{fs:void 0,path:void 0,resolve:void 0}],113:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=e("path"),r=i(n),s=e("react"),l=i(s),d=e("./error-popup"),u=i(d),c=e("./gutter-popup"),h=i(c),f=e("./jibo-parser"),p=i(f),m=function(){function e(){a(this,e),this.start()}return o(e,[{key:"onChange",value:function(){this.marker&&(this.marker.destroy(),this.lineNumber&&this.lineNumber.parentNode&&this.lineNumber.parentNode.removeChild(this.lineNumber));var e=this.editor.getText();try{p["default"]&&p["default"].syntax_check(e)}catch(t){var i=JSON.parse(t.message);if(i.info.line){var a=[[i.info.line-1,i.info.column-1],[i.info.line-1,i.info.column]];this.marker=this.editor.markBufferRange(a,{invalidate:"never"}),this.editor.decorateMarker(this.marker,{type:"highlight","class":"jibo-highlight-red"}),this.editor.decorateMarker(this.marker,{type:"line-number","class":"jibo-line-number-red"});var o=document.createElement("div");l["default"].render(l["default"].createElement(u["default"],{message:i.info.msg,marker:this.marker}),o),this.editor.decorateMarker(this.marker,{type:"overlay",item:o})}else{var n=[[0,0],[0,1]];this.marker=this.editor.markBufferRange(n,{invalidate:"never"}),this.editor.decorateMarker(this.marker,{type:"line-number","class":"jibo-line-number-red"});var r=document.createElement("div");l["default"].render(l["default"].createElement(h["default"],{message:i.info.msg,marker:this.marker}),r),this.editor.decorateMarker(this.marker,{type:"overlay",item:r})}console.log(i)}}},{key:"start",value:function(){var e=this;atom.workspace.observeActivePaneItem(function(t){if(t&&t.constructor&&"TextEditor"===t.constructor.name){var i=r["default"].extname(t.getPath());e.dispoable&&e.dispoable.dispose(),(".nli"===i||".rule"===i||".grm"===i)&&(e.editor=t,e.dispoable=t.onDidStopChanging(e.onChange.bind(e)))}})}}]),e}();exports["default"]=new m},{"./error-popup":110,"./gutter-popup":111,"./jibo-parser":112,path:void 0,react:void 0}],114:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("./jibo-parser"),r=i(n),s={};exports["default"]=o["default"].createClass({displayName:"rule-tester-panel",addDisposable:function(e){this.disposables.push(e)},getInitialState:function(){return this.disposables=[],{result:"",compileTime:0,parseTime:0}},compile:function(){if(r["default"]){var e=o["default"].findDOMNode(this.refs.json);this.parser=null,r["default"].remove_from_memory("handle:1");try{var t=performance.now(),i=r["default"].compile_fst_from_text(this.props.editor.getText(),"handle:1"),a=performance.now();this.parser=r["default"].build_sentence_parser(i),this.setState({compileTime:a-t})}catch(n){e.getModel().setText("[]"),this.setState({compileTime:0,parseTime:0})}}},parse:function(){var e=o["default"].findDOMNode(this.refs.json),t=o["default"].findDOMNode(this.refs.editor);if(this.parser){var i=performance.now();try{var a=this.parser.parse_sentence(t.getModel().getText()),n=performance.now();this.setState({parseTime:n-i}),a=JSON.parse(a),a=JSON.stringify(a,null,4),e.getModel().setText(a)}catch(r){e.getModel().setText("[]"),this.setState({compileTime:0,parseTime:0})}}else e.getModel().setText("[]"),this.setState({compileTime:0,parseTime:0})},render:function(){var e={width:"100%",height:"100%",display:"flex",flexDirection:"column"};return o["default"].createElement("div",{style:e,ref:"container"},o["default"].createElement("div",{className:"panel-heading",style:{padding:"0px"}},o["default"].createElement("h2",{style:{textAlign:"center",marginTop:"6px",marginBottom:"6px"}},"Test ",this.props.editor.getTitle())),o["default"].createElement("atom-text-editor",{ref:"editor",style:{marginLeft:10,marginRight:10,marginBottom:10,marginTop:20},mini:!0,"placeholder-text":"Enter test sentence here"}),o["default"].createElement("div",{className:"text-info",style:{margin:10}},o["default"].createElement("span",{className:"icon icon-graph"})," ","compile time: "+this.state.compileTime.toFixed(2)+"ms, parse time: "+this.state.parseTime.toFixed(2)+"ms"),o["default"].createElement("div",{className:"json-container"},o["default"].createElement("atom-text-editor",{"gutter-hidden":!0,ref:"json",style:{height:"100%"}})),o["default"].createElement("div",{style:{height:26}}))},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor),i=o["default"].findDOMNode(this.refs.json),a=o["default"].findDOMNode(this.refs.container);a.addResizeListener=function(){console.log(a.clientWidth,a.clientHeight)};for(var n=!1,r=atom.grammars.getGrammars(),l=0;l<r.length;l++){var d=r[l];if("JSON"===d.name){i.getModel().setGrammar(d),n=!0;break}}n||!function(){var e=atom.grammars.onDidAddGrammar(function(t){"JSON"===t.name&&(i.getModel().setGrammar(t),e.dispose())})}();var u=s[this.props.editor.getPath()];u?(t.getModel().setText(u),this.compile(),this.parse()):i.getModel().setText("[]"),this.addDisposable(this.props.editor.onDidStopChanging(function(){e.compile(),e.parse()})),this.addDisposable(t.getModel().onDidStopChanging(function(){s[e.props.editor.getPath()]=t.getModel().getText(),e.parse()}))},componentWillUnmount:function(){this.disposables.forEach(function(e){e.dispose()})}})},{"./jibo-parser":112,react:void 0}],115:[function(e,t,exports){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var a=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),o="RunConfiguration",RunConfiguration=function(){function RunConfiguration(){i(this,RunConfiguration)}return a(RunConfiguration,[{key:"runDir",get:function(){return atom.config.get("jibo-sdk."+o+".run-dir")},set:function(e){atom.config.set("jibo-sdk."+o+".run-dir",e)}},{key:"type",get:function(){return atom.config.get("jibo-sdk."+o+".type")},set:function(e){atom.config.set("jibo-sdk."+o+".type",e)}},{key:"host",get:function(){return atom.config.get("jibo-sdk."+o+".host")},set:function(e){atom.config.set("jibo-sdk."+o+".host",e)}}]),RunConfiguration}();exports["default"]=new RunConfiguration},{}],116:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(exports,"__esModule",{value:!0});var a=e("react"),o=i(a),n=e("../atom-react/components/jibo-combo-box-unidirectional"),r=i(n),s=e("./run-configuration.js"),l=i(s),d=e("../launcher/launcher"),u=i(d),c=e("atom"),h=e("lodash"),f=i(h),p=o["default"].createClass({displayName:"Editor",render:function(){return o["default"].createElement("atom-text-editor",{className:"inline-block",ref:"editor",style:{width:300},mini:!0},this.props.initValue)},componentDidMount:function(){var e=this,t=o["default"].findDOMNode(this.refs.editor);if(t){var i=t.getModel();this.props.onSetValue(i.getText()),i.onDidChange(function(){e.props.onSetValue(i.getText())})}}});exports["default"]=o["default"].createClass({displayName:"toolbar",componentDidMount:function(){var e=this,t=this;this.disposable=new c.CompositeDisposable;var i=["RunConfiguration.type","RunConfiguration.host","RunConfiguration.run-dir"];i.forEach(function(i){var a="jibo-sdk."+i;e.disposable.add(atom.config.observe(a,function(){"jibo-sdk.RunConfiguration.run-dir"===a&&t.refs.rundir?o["default"].findDOMNode(t.refs.rundir).getModel().setText(atom.config.get(a)):"jibo-sdk.RunConfiguration.host"===a&&t.refs.host?o["default"].findDOMNode(t.refs.host).getModel().setText(atom.config.get(a)):t.forceUpdate()}))})},componentWillUnmount:function(){this.disposable.dispose()},getInitialState:function(){return u["default"].on("exit",this.onExit.bind(this)),u["default"].on("start",this.onStart.bind(this)),{isPlaying:u["default"].isPlaying}},onExit:function(){this.state.isPlaying=!1,this.setState(this.state)},onStart:function(){this.state.isPlaying=!0,this.setState(this.state)},render:function(){var e=[{label:"Run Locally",display:"local",value:"local"},{label:"Run Remotely",display:"remote",value:"remote"}],t=null,i=f["default"].find(e,function(e){return l["default"].type===e.value});"remote"===l["default"].type&&(t=[o["default"].createElement("p",{style:{margin:5,whiteSpace:"nowrap"}},"Robot Host URL\xa0"),o["default"].createElement(p,{tabIndex:1,ref:"host",initValue:l["default"].host,onSetValue:function(e){l["default"].host=e}})]);var a={toolbar:{display:"flex",minWidth:664},logo:{width:90,height:27,margin:"1px 0px auto 10px"},beta:{color:"#e2c08d",margin:"0px 10px 0px 0px"},close:{padding:7,cursor:"pointer",fontSize:"1.1em"}},n=this.state.isPlaying?"fa fa-stop":"fa fa-play";return o["default"].createElement("div",{className:"inline-block jibo-tool-bar",style:a.toolbar},o["default"].createElement("img",{style:a.logo,src:"atom://jibo-sdk/images/jibo.png"}),o["default"].createElement("p",{style:a.beta},"(Beta)\xa0"),o["default"].createElement("div",{className:"btn inline-block",onClick:this.state.isPlaying?this.onStop:this.onPlay},o["default"].createElement("i",{className:n,style:{color:this.state.isPlaying?"red":"green",fontSize:15}})),o["default"].createElement(r["default"],{data:e,current:i,onSelected:this.onChangeConfiguration}),t,o["default"].createElement("p",{style:{margin:5,whiteSpace:"nowrap"}},"Run Directory\xa0"),o["default"].createElement(p,{tabIndex:2,ref:"rundir",initValue:l["default"].runDir,onSetValue:function(e){l["default"].runDir=e}}),o["default"].createElement("span",{className:"btn inline-block",onClick:this.onOpenPackageSettings},o["default"].createElement("span",null,"Settings\xa0"),o["default"].createElement("i",{className:"fa fa-edit"})))},onOpenPackageSettings:function(){atom.workspace.open("atom://config/packages/jibo-sdk").then(function(){var e=document.querySelector(".package-detail.panels-item");e&&(e.scrollTop=380)})},onPlay:function(){u["default"].play()},onStop:function(){u["default"].stop()},onChangeConfiguration:function(e){l["default"].type=e.value}})},{"../atom-react/components/jibo-combo-box-unidirectional":50,"../launcher/launcher":108,"./run-configuration.js":115,atom:void 0,lodash:void 0,react:void 0}],117:[function(e,t,exports){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),n=e("lodash"),r=i(n),s=e("path"),l=i(s),d=e("./animation-preview/jibo-sim"),u=i(d),c=e("./animation-editor/animation-editor"),h=i(c),f=e("./behavior-editor/behavior-editor"),p=i(f),m=e("./common/json-opener"),v=i(m),y=e("./package-generator/package-generator-modal"),g=i(y),b=e("./launcher/launcher"),k=i(b),M=e("jquery"),E=i(M),w=e("react"),S=i(w),D=e("./toolbar/toolbar"),C=i(D),N=e("./atom-react/atom-integration"),_=i(N),O=e("./cheat-sheet/cheat-sheat-tab"),x=i(O),P=e("atom"),j=e("./rules/rule-tester-panel"),T=i(j),L=e("./gating/login"),R=i(L),I=console.log;console.log=function(){},console.log=I;var B=function(){function t(){a(this,t),this.config={AnimationEditorBackgroundColor:{type:"color","default":"#4C4C4C",description:"The background color in the Animation Editor"},AnimationEditorGridColor:{type:"color","default":"#E5E5E5",description:"The grid color in the Animation Editor"},"RunConfiguration.type":{type:"string","enum":["local","remote"],"default":"local",description:"Which mode to use when running/debugging your skill."},"RunConfiguration.host":{type:"string","default":"",description:"The host or ip of the robot you want to target."},"RunConfiguration.run-dir":{type:"string","default":"${project}",description:"The directory to run your skill from if it's not the root of your opened project."},DisableRunSkillShortcut:{type:"boolean","default":"false",description:"Disable the shortcut for running skills, if you prefer it binding to built in the [Symbol-Viewer](https://github.com/atom/symbols-view#symbols-view-package-) toggle."}}}return o(t,[{key:"toggleRulePane",value:function(e,t){var i=this;if(this.rulePaneDisposable&&this.rulePaneDisposable.destroy(),e){var a=document.createElement("div");a.setAttribute("class","rule-panel"),S["default"].render(S["default"].createElement(T["default"],{editor:t,onClose:function(){i.destroyModal()}}),a),this.rulePaneDisposable=atom.workspace.addRightPanel({item:a,priority:1})}}},{key:"activate",value:function(){var t=this;this.disposable=new P.CompositeDisposable;var i=!1,a=!1,o=function(){_["default"].activate(),t.disposable.add(atom.workspace.addOpener(function(e){return t.openURI(e)})),t.disposable.add(atom.commands.add("atom-workspace",{"jibo-sdk:new-project":function(){(0,g["default"])()},"jibo-sdk:open-as-json":function(){v["default"].open()},"jibo-sdk:new-animation-file":function(){h["default"].createNewFile()},"jibo-sdk:new-behavior-tree-file":function(){p["default"].createNewFile()},"jibo-sdk:play":function(){k["default"].play()},"jibo-sdk:stop":function(){k["default"].stop()},"jibo-sdk:cheat-sheet":function(){atom.workspace.open("atom://jibo-cheat-sheet")},"jibo-sdk:run-skill":function(e){return atom.config.get("jibo-sdk.DisableRunSkillShortcut")?void e.abortKeyBinding():void k["default"].togglePlayer()}}));var a=(0,E["default"])("<div/>");a.addClass("toolbar"),S["default"].render(S["default"].createElement(C["default"],null),a[0]),t.toolbarPanel=atom.workspace.addTopPanel({item:a});var o=function(e){var i=null;if(e&&(i=e.__displayName||(e.constructor?e.constructor.name:null)),"TextEditor"===i){var a=l["default"].extname(e.getPath());if(".nli"===a||".rule"===a||".grm"===a)return t.editor=e,void t.toggleRulePane(!0,e)}t.toggleRulePane(!1)};atom.workspace.observeActivePaneItem(function(e){o(e)}),o(atom.workspace.getActiveTextEditor()),e("./rules/rule-grammar"),i=!0},n=function(){return R["default"].isUserLoggedIn()?void o():(a=!0,void R["default"].showDialog(function(e,t){return a=!1,e?void console.log(e):void(t&&o())}))};n(),this.disposable.add(atom.commands.add("atom-workspace",{"jibo-sdk:login":function(){return i?void alert("You are already logged in"):void(a||n())}}))}},{key:"deactivate",value:function(){this.toolbarPanel&&this.toolbarPanel.destroy(),this.disposable.dispose(),_["default"].deactivate()}},{key:"openURI",value:function(e){if(v["default"].useDefaultEditor()!==!1){if("atom://jibo-cheat-sheet"===e)return new x["default"](e,!0);var t={".anim":u["default"],".keys":h["default"],".bt":p["default"]},i=l["default"].extname(e).toLowerCase();return r["default"].has(t,i)?new t[i](e):void 0}}}]),t}();exports["default"]=new B},{"./animation-editor/animation-editor":1,"./animation-preview/jibo-sim":46,"./atom-react/atom-integration":47,"./behavior-editor/behavior-editor":71,"./cheat-sheet/cheat-sheat-tab":88,"./common/json-opener":96,"./gating/login":106,"./launcher/launcher":108,"./package-generator/package-generator-modal":109,"./rules/rule-grammar":113,"./rules/rule-tester-panel":114,"./toolbar/toolbar":116,atom:void 0,jquery:void 0,lodash:void 0,path:void 0,react:void 0}]},{},[117])(117)});